<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="musubd.files/filelist.xml">
<link rel=Edit-Time-Data href="musubd.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Методические указания к лабораторным работам по дисциплине СУБД</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="date"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="time"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-alt:\BC14\D0D5;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1342176593 1775729915 48 0 524447 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\B3CB\C6C0;
	mso-font-charset:129;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\9ED1\4F53;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;
	mso-font-alt:\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;
	mso-font-alt:\660E\671D;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\AD74\B9BC;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:32771 0 0 0 1 0;}
@font-face
	{font-family:Latha;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1048579 0 0 0 1 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:67110535 0 0 0 159 0;}
@font-face
	{font-family:Vrinda;
	panose-1:1 1 6 0 1 1 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:65539 0 0 0 1 0;}
@font-face
	{font-family:Raavi;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:131075 0 0 0 1 0;}
@font-face
	{font-family:Shruti;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:262147 0 0 0 1 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:2097155 0 0 0 1 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:4194307 0 0 0 1 0;}
@font-face
	{font-family:"Estrangella Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-2147476737 14699 0 0 63 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870009 1073741843 0 0 415 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:-2147459005 0 128 0 1 0;}
@font-face
	{font-family:"MV Boli";
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 256 0 1 0;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421663 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 5 6 2 2 2 3 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129279 0;}
@font-face
	{font-family:"\@Batang";
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1342176593 1775729915 48 0 524447 0;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;
	mso-font-charset:204;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Haettenschweiler;
	panose-1:2 11 7 6 4 9 2 6 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"MS Outlook";
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:204;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;
	mso-font-charset:2;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Console KOI8";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:204;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147483001 0 0 0 31 0;}
@font-face
	{font-family:Kartika;
	panose-1:2 2 5 3 3 4 4 6 2 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:8388611 0 0 0 1 0;}
@font-face
	{font-family:"Matura MT Script Capitals";
	panose-1:3 2 8 2 6 6 2 7 2 2;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:LMUkrLine;
	panose-1:2 11 114 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:515 0 0 0 5 0;}
@font-face
	{font-family:"Guitar Pro";
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 4 5 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:6791 0 0 0 191 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:10.0pt;
	font-family:"Times New Roman";
	text-transform:uppercase;
	font-weight:bold;}
h2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h3
	{margin-top:3.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:21.25pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:normal;}
h4
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-weight:normal;}
h5
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-weight:normal;}
h6
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	text-transform:uppercase;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:20.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:30.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:40.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:50.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:70.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:80.0pt;
	margin-bottom:.0001pt;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	text-indent:36.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	text-transform:uppercase;
	font-weight:bold;}
span.MsoEndnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBlockText, li.MsoBlockText, div.MsoBlockText
	{margin-top:0cm;
	margin-right:2.0cm;
	margin-bottom:0cm;
	margin-left:163.05pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
tt
	{font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
p.bodytext2, li.bodytext2, div.bodytext2
	{mso-style-name:bodytext2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:blue;}
p.bodytextindent2, li.bodytextindent2, div.bodytextindent2
	{mso-style-name:bodytextindent2;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:36.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.bodytextindent3, li.bodytextindent3, div.bodytextindent3
	{mso-style-name:bodytextindent3;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:36.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:blue;}
p.10, li.10, div.10
	{mso-style-name:10;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.normal, li.normal, div.normal
	{mso-style-name:normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.275025, li.275025, div.275025
	{mso-style-name:275025;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:3.0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:-7.05pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.075, li.075, div.075
	{mso-style-name:075;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:21.3pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.0, li.0, div.0
	{mso-style-name:0;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.3075, li.3075, div.3075
	{mso-style-name:3075;
	margin-top:3.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:21.3pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;}
p.3, li.3, div.3
	{mso-style-name:3;
	margin-top:3.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:21.25pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.a0, li.a0, div.a0
	{mso-style-name:a0;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:21.25pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.style4
	{mso-style-name:style4;}
p.title2b, li.title2b, div.title2b
	{mso-style-name:title_2_b;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.text, li.text, div.text
	{mso-style-name:text;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.title2, li.title2, div.title2
	{mso-style-name:title_2;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.listing
	{mso-style-name:listing;}
p.note, li.note, div.note
	{mso-style-name:note;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
ins
	{mso-style-type:export-only;
	text-decoration:none;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:421.0pt 21.0cm;
	margin:2.0cm 2.0cm 2.0cm 49.6pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:196352914;
	mso-list-template-ids:-739466354;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Обычная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
</head>

<body lang=RU link=blue vlink=purple style='tab-interval:35.4pt'>

<div class=Section1>

<div id=masthead>

<p class=MsoNormal align=center style='text-align:center;text-indent:0cm'><span
style='font-size:12.0pt'><img width=900 height=115 id="_x0000_i1025"
src=title.gif><o:p></o:p></span></p>

<h1 id=siteName>&nbsp;</h1>

<h1><span class=style4><a href="index.htm">О себе </a>| <a href="os_site.htm">Операционные
системы </a>| <a href="pevm.htm">Персональные ЭВМ </a>| <a href="spo.htm">Системное
программное обеспечение</a>| <a href="pp.htm">Параллельное программирование</a>|
<a href="subd.htm">СУБД</a></span> <!-- end masthead --><o:p></o:p></h1>

</div>

<p class=MsoNormal><span style='left:0px;position:absolute;z-index:-2'><img
border=0 width=48 height=641 id="_x0000_i1026" src="musubd.files/image001.gif"></p>

</span>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><b>Министерство образования и науки Украины</b></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><b>Севастопольский национальный технический университет</b></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;<o:p></o:p></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><span style='left:-10px;position:relative;top:2px;z-index:
2'><img border=0 width=65 height=129 id="_x0000_i1027"
src="musubd.files/image002.gif"></span>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><span style='text-transform:uppercase'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><span style='text-transform:uppercase'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:0cm'><span
style='font-size:12.0pt'><br clear=all style='mso-special-character:line-break'>
<o:p></o:p></span></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>Методические указания</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>к лабораторным работам по дисциплине</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>«Системы баз данных»</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>для студентов дневной и заочной &nbsp;форм обучения </p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>направления 0.915 – «Компьютерная инженерия» </p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'><b>&nbsp;</b></p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>Севастополь </p>

<p class=MsoNormal align=center style='margin-left:3.0cm;text-align:center;
text-indent:0cm'>2007</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal align=left style='text-align:left;text-indent:0cm'>УДК 519.6</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:0cm'><b>&nbsp;</b></p>

<p class=MsoNormal>Методические указания к лабораторным работам по дисциплине
«Системы баз данных» для студентов дневной и заочной &nbsp;форм обучения
направления 0.915 – «Компьютерная инженерия» / Сост. Т.В. Волкова, Г.Г.Сергеев.
– Севастополь: Изд-во СевНТУ, 2007. – ___с.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Целью методических указаний является обеспечение
лабораторных работ по дисциплине «Системы баз данных».</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Методические указания рассмотрены и утверждены на заседании
кафедры КиВТ&nbsp; (протокол № ___ &nbsp;от &nbsp;«___» &nbsp;________ 2007
г.).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Допущено учебно-методическим центром СевНТУ в качестве
методических указаний.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Рецензент: Головизнина &nbsp;Н.Р. – старший преподаватель
кафедры информационных систем СевНТУ.</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal align=center style='text-align:center'><a
name="_Toc126429174"></a><a name="_Toc126429372"></a><span style='mso-bookmark:
_Toc126429174'><b>СОДЕРЖАНИЕ</b></span></p>

<p class=MsoNormal align=center style='text-align:center'><b>&nbsp;</b></p>

<p class=MsoNormal align=center style='text-align:center'><b>&nbsp;</b></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231765">1.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №1.&nbsp; АДМИНИСТРИРОВАНИЕ СЕРВЕРА С ПОМОЩЬЮ УТИЛИТЫ <span lang=EN-US
style='mso-ansi-language:EN-US'>IBEXPERT</span>. УСТАНОВКА СОЕДИНЕНИЯ С
СЕРВЕРОМ<span style='color:windowtext;display:none;mso-hide:all;text-decoration:
none;text-underline:none'>... 4</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231766">2.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №2. Средства манипулирования данными языка SQL. РАЗРАБОТКА КЛИНТСКОГО
ПРИЛОЖЕНИЯ ДЛЯ ВВОДА И КОРРЕКЦИИ ДАННЫХ<span style='color:windowtext;
display:none;mso-hide:all;text-decoration:none;text-underline:none'>.. 18</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231767">3.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №3. ЭЛЕМЕНТАРНЫЕ ВЫБОРКИ ПОСРЕДСТВОМ ОПЕРАТОРА <span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT</span>. АГРЕГАТНЫЕ ФУНУКЦИИ <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>.<span style='color:windowtext;
display:none;mso-hide:all;text-decoration:none;text-underline:none'> 30</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231768">4.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №4. «ССЫЛОЧНАЯ ЦЕЛОСТНОСТЬ ДАННЫХ. СОЗДАНИЕ СХЕМЫ БАЗЫ ДАННЫХ»<span
style='color:windowtext;display:none;mso-hide:all;text-decoration:none;
text-underline:none'>&nbsp; 44</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231769">5.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №5. «СЛОЖНЫЕ ЗАПРОСЫ К БАЗЕ ДАННЫХ. ЗАПРОСЫ НА ОСНОВЕ НЕСКОЛЬКИХ ТАБЛИЦ.
КОРРЕЛИРОВАННЫЕ ВЛОЖЕННЫЕ ПОДЗАПРОСЫ»<span style='color:windowtext;display:
none;mso-hide:all;text-decoration:none;text-underline:none'>. 57</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231770">6.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №6. «ТРИГГЕРЫ И ХРАНИМЫЕ ПРОЦЕДУРЫ»<span style='color:windowtext;
display:none;mso-hide:all;text-decoration:none;text-underline:none'>&nbsp; 68</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231771">7.<span
style='font-size:12.0pt;color:windowtext;font-weight:normal;text-decoration:
none;text-underline:none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>БиблиографиЧЕСКИЙ
СПИСОК<span style='color:windowtext;display:none;mso-hide:all;text-decoration:
none;text-underline:none'>.. 69</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc163231772">ПРИЛОЖЕНИЕ
Варианты заданий<span style='color:windowtext;display:none;mso-hide:all;
text-decoration:none;text-underline:none'>. 70</span></a></span></p>

<p class=MsoNormal style='margin-left:42.55pt;text-indent:0cm'><b>&nbsp;</b></p>

<p class=MsoNormal><span style='letter-spacing:-.2pt'>.<br clear=all
style='mso-special-character:line-break;page-break-before:always'>
</span></p>

<h1><a name="_Toc126429175"></a><a name="_Toc98581977"></a><a
name="_Toc96184855"></a><a name="_Toc96190864"></a><a name="_Toc96190805"></a><a
name="_Toc65225675"></a><a name="_Toc163231765"></a><a name="_Toc126429373"></a><span
style='mso-bookmark:_Toc126429175'>1.</span><span style='mso-bookmark:_Toc126429175'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №1. </span>&nbsp;АДМИНИСТРИРОВАНИЕ СЕРВЕРА С ПОМОЩЬЮ УТИЛИТЫ <span
lang=EN-US style='mso-ansi-language:EN-US'>IBEXPERT</span>. УСТАНОВКА
СОЕДИНЕНИЯ С СЕРВЕРОМ</h1>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc126429176">1.1.</a><span style='mso-bookmark:_Toc126429176'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель работы:</span></h2>

<p class=MsoNormal>Оознакомиться с процессом инсталляции СУБД InterBase и
оболочки IB Expert. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Научится устанавливать
соединение с сервером из программных систем,.&nbsp;&nbsp;&nbsp; создавать базу
данных и произвести элементарные действия с ней c удаленного и локального
компьютера..</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc126429177">1.2.</a><span style='mso-bookmark:_Toc126429177'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Введение</span></h2>

<p class=MsoNormal>Сервер Interbase фирмы Borland является полнофункциональным
сервером реляционных баз данных. Начиная с версии 6.0, Borland сделала
доступным исходный текст сервера для бесплатного использования. На основе
исходного текста IB 6.0 появилось несколько клонов IB под разными именами.
Сторонние разработчики исправляли ошибки, выявленные в исходном коде, и
расширяли функциональность сервера. Одним из самых известных клонов стал
FireBird разработкой и сопровождением которого занимается сообщество
разработчиков, включая бывших сотрудников подразделения Borland Interbase, а
также компанию IBPhoenix (бывшая Interbase Software Corp.). </p>

<p class=MsoNormal>Сервер выпускается под несколько платформ (Win32, linux,
solaris, freebsd, darwin) в двух архитектурах – SuperServer и Classic. Основное
различие между ними состоит в том, что Classic создает параллельный процесс для
каждого присоединяемого пользователя, а SuperServer состоит из одного процесса,
который обрабатывает запросы клиентов в разных нитях (threads) этого же
процесса. Архитектура Classic считается более надежной, а SuperServer более
производительной. Для платформы Win32 сервер выпускается только в архитектуре
SuperServer.</p>

<p class=MsoNormal>Сервер на Win32 запускается в качестве сервиса ОС.
Клиентские приложения могут присоединяться к нему несколькими способами: по
протоколам NetBEUI, TCP/IP; локальное подключение (в случае, если вы работаете
на машине, на которой запущен сервер). В дальнейшем рассматривается подключение
к серверу по протоколу ТСР/IP.</p>

<h2><a name="_Toc126429178">1.3.</a><span style='mso-bookmark:_Toc126429178'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика выполнения
работы</span></h2>

<p class=MsoNormal style='margin-left:53.5pt;text-indent:-32.25pt'>1)<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Убедиться, что на персональном компьютере установлена СУБД <span
lang=EN-US style='mso-ansi-language:EN-US'>Interbase</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>FireBird</span>). В случае ее отсутствия
выполнить инсталляцию СУБД и программного обеспечения для ее администрирования
&nbsp;(<span lang=EN-US style='mso-ansi-language:EN-US'>IBConsole</span><span
lang=EN-US> </span>и <span lang=EN-US style='mso-ansi-language:EN-US'>IBExpert</span>).</p>

<p class=MsoNormal style='margin-left:53.5pt;text-indent:-32.25pt'>2)<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Создать новую базу данных с помощью утилиты <span lang=EN-US
style='mso-ansi-language:EN-US'>IBExpert</span>. Выполнить регистрацию базы
данных. Создать таблицу в соответствии с вариантом задания и заполнить ее
данными, используя интерфейсные средства <span lang=EN-US style='mso-ansi-language:
EN-US'>IBExpert</span>.</p>

<p class=MsoNormal style='margin-left:53.5pt;text-indent:-32.25pt'>3)<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Зарегистрировать новую базу данных, расположенную на соседнем
компьютере. Проверить адекватность содержимого таблиц.</p>

<p class=MsoNormal style='margin-left:53.5pt;text-indent:-32.25pt'>4)<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Разработать приложение средствами среды <span lang=EN-US
style='mso-ansi-language:EN-US'>Delphi</span> (<span lang=EN-US
style='mso-ansi-language:EN-US'>C</span>++ <span lang=EN-US style='mso-ansi-language:
EN-US'>Builder</span>) для установки соединения&nbsp; с указанным набором
данных. </p>

<p class=MsoNormal style='margin-left:53.5pt;text-indent:-32.25pt'>5)<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Исследовать работу механизма транзакций с помощью разработанного
приложения и оболочки <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span>.</p>

<h2><a name="_Toc126429179">1.4.</a><span style='mso-bookmark:_Toc126429179'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Варианты заданий</span></h2>

<p class=MsoNormal>Вариант задания (таблица 1.1) выбирается по формуле (<span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>mod</span> 24)+1, где <span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span>–
последние две цифры&nbsp; зачетной книжки студента.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таблица 1.1 – Варианты заданий к лабораторной работе №1</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=423
 style='width:317.25pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center;text-indent:0cm'>№
  вар.</p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Среда </p>
  <p class=MsoNormal style='text-indent:0cm'>Программирования</p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>Поля таблицы</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ зачетки, Ф.И.О., дата рождения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>2</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ паспорта, Ф.И.О., адрес</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>3</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О., группа, оценка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>4</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ аудитории, назначение, число
  мест</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>5</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ компьютера, дата, Ф.И.О.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>6</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ компьютера, кабинет, <span
  lang=EN-US style='mso-ansi-language:EN-US'>IP-</span>адрес</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>7</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель, курс, предмет</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;page-break-inside:avoid;height:12.0pt'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>8</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель, должность, зарплата</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>9</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Предмет, количество часов, оценка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>10</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:place><span lang=EN-US
   style='mso-ansi-language:EN-US'>Delphi</span></st1:place></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О., Факультет, Дата рождения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>11</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ зачетки, Ф.И.О., дата рождения</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>12</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ паспорта, Ф.И.О., адрес</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>13</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О., группа, оценка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>14</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ аудитории, назначение, число
  мест</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>15</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ компьютера, дата, Ф.И.О.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>16</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ компьютера, кабинет, <span
  lang=EN-US style='mso-ansi-language:EN-US'>IP-</span>адрес</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>17</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель, &nbsp;курс, предмет</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>18</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель, должность, зарплата</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>19</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Предмет, количество часов, оценка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20;mso-yfti-lastrow:yes'>
  <td width=45 valign=top style='width:33.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>20</span></p>
  </td>
  <td width=142 valign=top style='width:106.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>C++ Builder</span></p>
  </td>
  <td width=236 valign=top style='width:177.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О., Факультет, Дата рождения</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc126429180">1.5.</a><span style='mso-bookmark:_Toc126429180'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание отчета</span></h2>

<p class=MsoNormal>Отчет должен содержать цель полное описание действий
студента по созданию базы данных и обращению к ней с удаленного и локального
компьютера. Обязательно должны быть указаны фактические значения (по варианту
задания), вводимые в диалоговые окна. Описание программы должно включать список
форм, компонентов, перечень предопределяемых свойств компонентов. Отчет состоит
из титульного листа, цели работы, описания процесса выполнения работы и вывода.</p>

<p class=MsoBodyText>&nbsp;</p>

<h2><a name="_Toc126429181">1.6.</a><span style='mso-bookmark:_Toc126429181'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные вопросы</span></h2>

<h2><a name="_Toc126429182"><span lang=EN-US style='mso-ansi-language:EN-US;
font-weight:normal'>&nbsp;</span></a></h2>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>1) Дайте
определение СУБД.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>2) Дайте
определение сервера и клиента ресурса компьютерной сети.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>3) Назовите
основные архитектуры сетевых информационных систем, достоинства и недостатки.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>4) Назовите
существующие модели данных.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>5) Назовите
основные характеристики реляционной модели данных.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>6) Опишите
процесс инсталляции СУБД InterBase (FireBird).</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>7) Объясните
отличие архитектуры superserver и classic.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>8) Что такое
диалект SQL?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>9) Какая
информация указывается при регистрации базы данных?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>10) Объясните
порядок регистрации сервера.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>11) &nbsp;Какие
команды языка SQL используются для создания базы данных, таблиц, ввода данных?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>11)&nbsp;&nbsp;&nbsp;
Что такое «транзакция»?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>13)&nbsp;&nbsp;&nbsp;
Какие компоненты необходимо включить в проект программной системы для установки
соединения с базой данных?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2>1.7.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&nbsp;Рекомендации
по выполнению работы</h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Сервер <span lang=EN-US style='mso-ansi-language:EN-US'>Interbase</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>FireBird</span>) на датформе <span
lang=EN-US style='mso-ansi-language:EN-US'>Win</span>32 запускается в качестве
сервиса ОС. Клиентские приложения могут присоединяться к нему несколькими
способами: по протоколам NetBEUI, TCP/IP; локальное подключение (в случае, если
вы работаете на машине, на которой запущен сервер). В дальнейшем
рассматривается подключение к серверу по протоколу ТСР/IP.</p>

<p class=MsoNormal>Для администрирования сервера используются утилиты&nbsp; IB<span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>IBConsole</span><span lang=EN-US> </span>и др.
Для того, чтобы получить возможность работы с БД, необходимо проделать
следующие операции:</p>

<p class=MsoNormal>-&nbsp; зарегистрировать сервер;</p>

<p class=MsoNormal>-&nbsp; присоединиться к серверу;</p>

<p class=MsoNormal>-&nbsp; зарегистрировать (или создать заново) базу данных;</p>

<p class=MsoNormal>-&nbsp; присоединиться к базе данных;</p>

<p class=MsoNormal>На каждой машине регистрировать сервер и БД нужно только
один раз. Рассмотрим данные задачи более подробно.</p>

<p class=MsoNormal>&nbsp;</p>

<h3>1.7.1.<span style='font-size:7.0pt'> </span>Регистрация сервера и создание
базы данных утилитой <span lang=EN-US style='mso-ansi-language:EN-US'>IBExpert</span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal>Утилита <span lang=EN-US style='mso-ansi-language:EN-US'>IBExpert</span><span
lang=EN-US> </span>предназначена для администрации баз данных в СУБД <span
lang=EN-US style='mso-ansi-language:EN-US'>Interbase</span><span lang=EN-US> </span>и
<span lang=EN-US style='mso-ansi-language:EN-US'>FireBird</span>. Создание
нового набора данных осуществляется с помощью пункта меню База данных/Создать
базу.</p>

<p class=MsoNormal>В диалоговом окне, представленном на рисунке 1.1,&nbsp;
вводится информация необходимая для создания базы данных.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=276
id="_x0000_i1028" src="musubd.files/image003.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 1.1 – Создание базы данных</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Раздел «Сервер» (удаленный/локальный) предназначен для
выбора места создания файла базы данных. Выберите тип «локальный» для создания
базы данных на локальной машине.</p>

<p class=MsoNormal>На языке <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>&nbsp;
создание новой базы данных осуществляется с помощью команды</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CREATE
DATABASE 'd:\database\test.gdb'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>USER
'SYSDBA' PASSWORD 'masterkey'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>PAGE_SIZE
16384<o:p></o:p></span></p>

<p class=MsoNormal>DEFAULT CHARACTER SET WIN1251;</p>

<p class=MsoNormal>&nbsp;&nbsp; В разделах «Имя сервера» и «протокол» вводится
имя машины (например, <span lang=EN-US style='mso-ansi-language:EN-US'>A</span>005),
на которой расположен сервер баз данных <span lang=EN-US style='mso-ansi-language:
EN-US'>Interbase</span> или <span lang=EN-US style='mso-ansi-language:EN-US'>FireBird</span>.
Для локальной базы данных эти поля не нужны. </p>

<p class=MsoNormal>Поле вода «Файл БД» предназначен для указания пути к
создаваемому файлу базы данных. </p>

<p class=MsoNormal>«Имя пользователя» - строка ввода имени администратора баз
данных. По умолчанию администратором является пользователь с именем «<span
lang=EN-US style='mso-ansi-language:EN-US'>SYSDBA</span>», пароль – «<span
lang=EN-US style='mso-ansi-language:EN-US'>masterkey</span>». </p>

<p class=MsoNormal>В IB 6 появилось несколько расширений, как SQL так и типов
данных, которые поддерживаются при помощи диалектов [1].</p>

<p class=MsoNormal>Диалект 1 - базы данных 4.x или 5.x,
&quot;импортированные&quot; в 6.0 посредством backup в 4.x/5.x и restore в 6.0.
Не содержат никаких отличий от 5.x. </p>

<p class=MsoNormal>Диалект 2 - предназначен для проверки возможности перевода
баз данных диалекта 1 в диалект 3. </p>

<p class=MsoNormal>Диалект 3 - &quot;родной&quot; формат IB 6, поддерживающий
INT6, DATE, TIME, TIMESTAMP и прочие расширения. </p>

<p class=MsoNormal>Диалект<span lang=EN-US style='mso-ansi-language:EN-US'> 1 </span>в<span
style='mso-ansi-language:EN-US'> </span>версии<span lang=EN-US
style='mso-ansi-language:EN-US'> 6 </span>отличается<span style='mso-ansi-language:
EN-US'> </span>от<span style='mso-ansi-language:EN-US'> </span>версии<span
lang=EN-US style='mso-ansi-language:EN-US'> 5.x </span>поддержкой<span
style='mso-ansi-language:EN-US'> </span>следующих<span style='mso-ansi-language:
EN-US'> </span>ключевых<span style='mso-ansi-language:EN-US'> </span>слов<span
lang=EN-US style='mso-ansi-language:EN-US'>: TIMESTAMP, TIME, EXTRACT, YEAR,
MONTH, DAY, WEEKDAY, HOUR, MINUTE, SECONDS, ?TYPE?, CURRENT_DATE, CURRENT_TIME,
CURRENT_TIMESTAMP. </span>Т.е. использование этих ключевых слов в качестве
идентификаторов полей, таблиц и других объектов будет приводить к ошибке.</p>

<p class=MsoNormal>Кроме этого в диалекте 3 не поддерживается автоматическая
конвертация типов в выражениях. Например, если раньше в SQL можно было написать
1+'3' и получить ответ 4, то в диалекте 3 будет выдано сообщение об ошибке.</p>

<p class=MsoNormal>Поле ввода «Кодировка» предназначена для выбора набора
символов национального алфавита для текстовых полей базы данных. Русские
символы <span lang=EN-US style='mso-ansi-language:EN-US'>Windows</span><span
lang=EN-US> </span>содержатся в кодировке <span lang=EN-US style='mso-ansi-language:
EN-US'>Win</span>1251.</p>

<p class=MsoNormal>Если файл базы данных перенесен на компьютер, где работает
сервер БД, с другого компьютера (т.е. база данных существует, но сервер не
имеет о ней информации), либо база данных создавалась на сервере, но при
создании не была зарегистрирована (был выключен флажок «Регистрация базы данных
(Register database)» при создании БД) , то такую базу данных нужно
регистрировать в утилите <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span>.
Это можно сделать с помощью экранной формы, показанной на рисунке 1.2.</p>

<p class=MsoNormal>Многие разделы формы совпадают с окном создания базы данных.
Как минимум, необходимо заполнить поля «Описание базы данных» и «Версия
сервера». Строка &nbsp;описания базы данных будет зафиксирована для
идентификации вашего набора данных в окне «<span lang=EN-US style='mso-ansi-language:
EN-US'>DataBase</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Explorer</span>» &nbsp;оболочки <span
lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span>.</p>

<p class=MsoNormal>В разделе «Версия сервера» необходимо выбрать тип сервера, установленного
на вашем компьютере (например, <span lang=EN-US style='mso-ansi-language:EN-US'>FireBird</span>
1.5). </p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=317
id="_x0000_i1029" src="musubd.files/image004.jpg"></p>

<p class=MsoNormal style='text-indent:14.2pt'>Рисунок 1.2 – Регистрация базы
данных в <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span></p>

<p class=MsoNormal>&nbsp;</p>

<h3>1.7.2.<span style='font-size:7.0pt'> &nbsp;</span>Создание таблиц базы
данных средствами <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span></h3>

<p class=MsoNormal>После создания базы данных необходимо определить структуру
информации и ввести данные в таблицы. Эти операции делаются посредством
интерфейсных форм оболочки <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span><span
lang=EN-US> </span>или командами языка <span lang=EN-US style='mso-ansi-language:
EN-US'>SQL</span>.</p>

<p class=MsoNormal>Рассмотрим в качестве примера простейший телефонный
справочник – таблицу с полями Ф.И.О., дата рождения, телефон.</p>

<p class=MsoNormal>Доступ к основным компонентам базы данных осуществляется
посредством диалогового окна «<span lang=EN-US style='mso-ansi-language:EN-US'>Database</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Explorer</span>»
оболочки <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span>
(рисунок 1.3).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img border=0 width=260 height=231 id="_x0000_i1030"
src="musubd.files/image005.jpg"></p>

<p class=MsoNormal>Рисунок 1.3 – <span lang=EN-US style='mso-ansi-language:
EN-US'>Database</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Explorer</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Для создания новой таблицы вызовите контекстное меню правой
кнопкой мыши в разделе «Таблицы» и выберете пункт «Новая таблица». Описание
полей таблицы осуществляется в диалоговом окне, показанном на рисунке 1.4.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=218
id="_x0000_i1031" src="musubd.files/image006.jpg"></p>

<p class=MsoNormal>Рисунок 1.4 – Описание полей базы данных</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>В верхней строке окна необходимо ввести имя таблицы
(например, <span lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>).
&nbsp;Для каждого поля необходимо указать его имя и тип. Большинство баз данных
поддерживают следующие типы полей:</p>

<p class=MsoNormal>- CHAR. Синтаксис: CHAR(n). Размер: n символов.
Диапазон/Точность: от 1 до 32767 байтов. Размер символа кодировки определяет
максимальное число символов, которые разместятся в 32K. Описание: Фиксированной
длины CHAR или строка текста. Альтернативное ключевое слово: CHARACTER</p>

<p class=MsoNormal>- DATE. Синтаксис: DAT<span lang=EN-US style='mso-ansi-language:
EN-US'>E</span>. Размер: 64 бита. Диапазон/Точность: от 1 янв 100 до 11 янв
5941. Описание: Так же включает информацию о времени.</p>

<p class=MsoNormal>- <span lang=EN-US style='mso-ansi-language:EN-US'>DECIMAL</span>.
Синтаксис: <span lang=EN-US style='mso-ansi-language:EN-US'>DECIMAL</span> (<span
lang=EN-US style='mso-ansi-language:EN-US'>precision</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>scale</span>). Размер: Переменный.
Диапазон/Точность: precision = от 1 до 15. Определяет, что сохраняется, по
крайней мере precision цифр числа. scale = от 1 до 15. Определяет число знаков
после запятой. Должно быть меньше или равно precision. Описание: Для примера,
DECIMAL(10,3) сохраняет числа точно в следующем формате: ppppppp.sss</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>- DOUBLE
PRECISION. </span>Синтаксис<span lang=EN-US style='mso-ansi-language:EN-US'>:
DOUBLE PRECISION. </span>Размер: 64 бита. Диапазон/Точность: от 1.7E-308 до
1.7E308. Описание: Для научных вычислений: 15 цифр точности. Текущий размер
типа DOUBLE зависит от платформы. Большинство платформ поддерживает размер в 64
бита.</p>

<p class=MsoNormal>- FLOAT. Синтаксис: FLOAT. Размер: 32 бита.
Диапазон/Точность: от 3.4E-38 до 3.4E38. Описание: Одиночная точность: 7 цифр
точности.</p>

<p class=MsoNormal>- INTEGER. Синтаксис: INTEGER. Размер: 32 бита.
Диапазон/Точность: от -2 147 483 648 до 2 147 483&nbsp;648. Описание: Длинное
целое со знаком (long, longword).</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>- NUMERIC. </span>Синтаксис<span
lang=EN-US style='mso-ansi-language:EN-US'>: NUMERIC (precision, scale). </span>Диапазон/Точность:
<span lang=EN-US style='mso-ansi-language:EN-US'>precision</span> = от 1 до 15.
Определяет, что сохраняется, по крайней мере precision цифр числа. scale = от 1
до 15. Определяет число знаков после запятой. Должно быть меньше или равно
precision. Описание: Для примера, NUMERIC(10,3) сохраняет числа точно в
следующем формате: ppppppp.sss</p>

<p class=MsoNormal>- SMALLINT. Синтаксис: SMALLINT. Размер: 16 бит.
Диапазон/Точность: от -32768 до 32767. Описание: Короткое целое со знаком.
(shot, word).</p>

<p class=MsoNormal>- VARCHAR Синтаксис: VARCHAR (n). Размер: n символов.
Диапазон/Точность: от 1 до 32767 байтов. Размер символа кодировки определяет
максимальное число символов, которые разместятся в 32K. Описание: переменной
длины CHAR или строка текста. Альтернативные ключевые слова: <span lang=EN-US
style='mso-ansi-language:EN-US'>VARYING</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>CHAR</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>VARYING</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>CHARACTER</span>.</p>

<p class=MsoNormal>- BLOB. Синтаксис: BLOB. Размер: Переменный.
Диапазон/Точность: Нет. Описание: Большой двоичный объект. Сохраняет данные
большого объема, такие как графика, текст и цифровой звук. Основная структура
модуля: сегмент. Cубтип данных BLOB описывается в их контексте.</p>

<p class=MsoNormal>После завершения ввода полей необходимо нажать кнопку
«Компиляция» (<span lang=EN-US style='mso-ansi-language:EN-US'>Ctrl</span>+<span
lang=EN-US style='mso-ansi-language:EN-US'>F</span>9) с изображением молнии на
панели инструментов окна/</p>

<p class=MsoNormal>На языке <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span
lang=EN-US> </span>создание таблицы <span lang=EN-US style='mso-ansi-language:
EN-US'>PHONE</span><span lang=EN-US> </span>описывается предложением: </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CREATE
TABLE PHONE <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>(&nbsp; FIO
VARCHAR(40) CHARACTER SET WIN1251,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
BDATE</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>DATE</span>,<span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US> </span></p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>PHONE</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>INTEGER</span>).</p>

<p class=MsoNormal>Ввод данных выполняется на вкладке «Данные» окна «Таблица» (рисунок
1.5) или с помощью предложения <span lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span><span
lang=EN-US> </span>языка <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT INTO
PHONE (FIO, BDATE, PHONE) VALUES ('Антонов Алексей Николаевич', '1987-02-12 </span><st1:time
Minute="0" Hour="0"><span lang=EN-US style='mso-ansi-language:EN-US'>00:00:00</span></st1:time><span
lang=EN-US style='mso-ansi-language:EN-US'>', 461522);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT INTO
PHONE (FIO, BDATE, PHONE) VALUES ('Левков Павел Андреевич', '1986-05-14 </span><st1:time
Minute="0" Hour="0"><span lang=EN-US style='mso-ansi-language:EN-US'>00:00:00</span></st1:time><span
lang=EN-US style='mso-ansi-language:EN-US'>', 248945);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'><img border=0 width=419 height=224 id="_x0000_i1032"
src="musubd.files/image007.jpg"></span></p>

<p class=MsoNormal style='text-indent:14.2pt'>Рисунок 1.5 –Ввод данных в
таблицу. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Вывод содержимого таблицы на языке <span lang=EN-US
style='mso-ansi-language:EN-US'>SQL</span><span lang=EN-US> </span>выполняется
посредством команды <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span>
* <span lang=EN-US style='mso-ansi-language:EN-US'>FROM</span><span lang=EN-US>
</span><span lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>.</p>

<h3>1.7.3.<span style='font-size:7.0pt'> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Разработка простейшего приложения для работы с базой данных</h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Клиентская часть систем баз данных часто оформляется в виде
прикладных программ (приложений).&nbsp; Для создания приложений баз данных в
среде <span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span> (<span
lang=EN-US style='mso-ansi-language:EN-US'>C</span>++ <span lang=EN-US
style='mso-ansi-language:EN-US'>Builder</span>) имеется набор компонентов на
вкладках <span lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Access</span>,
<span lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Controls</span><span lang=EN-US> </span>и
<span lang=EN-US style='mso-ansi-language:EN-US'>Interbase</span>.</p>

<p class=MsoNormal>Разработку приложения начнем с добавления в проект
специальной невизуальной формы <span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>File</span>/<span lang=EN-US
style='mso-ansi-language:EN-US'>New</span>/<span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>), в которой будем размещать компоненты для доступа к
данным. Поместим в нее компоненты <span lang=EN-US style='mso-ansi-language:
EN-US'>IBTable</span>, <span lang=EN-US style='mso-ansi-language:EN-US'>IBTransaction</span>,
<span lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span><span
lang=EN-US> </span>со вкладки <span lang=EN-US style='mso-ansi-language:EN-US'>Interbase</span><span
lang=EN-US> </span>и компонент&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>IBSource</span><span lang=EN-US> </span>со вкладки <span lang=EN-US
style='mso-ansi-language:EN-US'>Data</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Access</span> (рисунок 1.6).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img border=0 width=226 height=180 id="_x0000_i1033"
src="musubd.files/image008.jpg"></p>

<p class=MsoNormal>Рисунок 1.6 – форма <span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal>Компонент <span lang=EN-US style='mso-ansi-language:EN-US'>IBDataBase</span><span
lang=EN-US> </span>предназначен для связи с базой данных. На странице свойств
диспетчера объектов необходимо определить имя набора данных (<span lang=EN-US
style='mso-ansi-language:EN-US'>DataBaseName</span>), параметры доступа (<span
lang=EN-US style='mso-ansi-language:EN-US'>Params</span>) и компонент для
работы с транзакциями по умолчанию (<span lang=EN-US style='mso-ansi-language:
EN-US'>DefaultTransaction</span>).</p>

<p class=MsoNormal>Введем в качестве имени набора данных путь к созданной базе
данных (<span lang=EN-US style='mso-ansi-language:EN-US'>D</span>:\<span
lang=EN-US style='mso-ansi-language:EN-US'>Database</span>\<span lang=EN-US
style='mso-ansi-language:EN-US'>test</span>.<span lang=EN-US style='mso-ansi-language:
EN-US'>gdb</span>). В разделе «<span lang=EN-US style='mso-ansi-language:EN-US'>Params</span>»
необходимо ввести имя пользователя, пароль и тип кодировки символов:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>user_name=sysdba<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>password=masterkey<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>lc_ctype=WIN1251<o:p></o:p></span></p>

<p class=MsoNormal>Свойство <span lang=EN-US style='mso-ansi-language:EN-US'>LoginPrompt</span><span
lang=EN-US> </span>следует установить в <span lang=EN-US style='mso-ansi-language:
EN-US'>false</span>, в том случае если нет необходимости запрашивать имя
пользователя и пароль при каждом подключении к базе данных. В противном случае
следует установить это свойство в значение <span lang=EN-US style='mso-ansi-language:
EN-US'>true</span>.</p>

<p class=MsoNormal>Страница свойств компонента <span lang=EN-US
style='mso-ansi-language:EN-US'>IBDatabase</span><span lang=EN-US> </span>представлена
на рисунке 1.7.</p>

<p class=MsoNormal><img border=0 width=247 height=303 id="_x0000_i1034"
src="musubd.files/image009.jpg"></p>

<p class=MsoNormal>Рисунок 1.7 – Свойства компонента <span lang=EN-US
style='mso-ansi-language:EN-US'>IBDataBase</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Компонент &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
lang=EN-US style='mso-ansi-language:EN-US'>IBTransaction</span><span
lang=EN-US> </span>предназначен для управления транзакциями приложения с базой данных.
Транзакция - набор логически связанных операций, работающих с данными базы
данных, и либо переводящий базу данных в из одного целостного состояния в
другое, либо нет (т.е. оставляющий БД в целостном состоянии, существовавшем до
начала транзакции).</p>

<p class=MsoNormal>&nbsp;&nbsp; Транзакции обладают следующими свойствами:
упорядочиваемостью, неделимостью, постоянством. </p>

<p class=MsoNormal>Упорядочиваемость гарантирует, что если две или более
транзакции выполняются в одно и то же время, то конечный результат выглядит
так, как если бы все транзакции выполнялись последовательно в некотором (в
зависимости от системы) порядке. </p>

<p class=MsoNormal>Неделимость означает, что когда транзакция находится в
процессе выполнения, то никакой другой процесс не видит ее промежуточные
результаты. </p>

<p class=MsoNormal>Постоянство означает, что после фиксации транзакции никакой
сбой не может отменить результатов ее выполнения. </p>

<p class=MsoNormal>Базовыми примитивами при работе с транзакциями являются:</p>

<p class=MsoNormal>- <span lang=EN-US style='mso-ansi-language:EN-US'>Start</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Transaction</span>
– начать транзакцию;</p>

<p class=MsoNormal>- <span lang=EN-US style='mso-ansi-language:EN-US'>Commit</span>
– завершить транзакцию и принять сделанные изменения;</p>

<p class=MsoNormal>- <span lang=EN-US style='mso-ansi-language:EN-US'>RollBack</span><span
lang=EN-US> </span>- завершить транзакцию и отменить сделанные изменения.</p>

<p class=MsoNormal>&nbsp;&nbsp; В качестве примера использования&nbsp;
механизма транзакций рассмотрим процесс пополнения телефонного справочника
несколькими пользователями.</p>

<p class=MsoNormal>&nbsp;&nbsp; Пусть перед началом транзакции справочник имеет
в себе всего две записи, показанные на рисунке 1.5. Пользователь 1 начинает
транзакцию и добавляет в справочник новую запись: </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>INTO</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>FIO</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>BDATE</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>PHONE</span>) <span lang=EN-US
style='mso-ansi-language:EN-US'>VALUES</span> ('Петров Юрий Сергеевич',
'1983-12-10', 421428). </p>

<p class=MsoNormal>Пользователь 2 начинает транзакцию и выполняет запрос </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span>
* <span lang=EN-US style='mso-ansi-language:EN-US'>FROM</span><span lang=EN-US>
</span><span lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>. </p>

<p class=MsoNormal>Результат запроса вернет те две записи, которые находились с
базе до начала транзакции первым пользователем. Пусть пользователь 2 выполняет
добавление записи </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>INTO</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>FIO</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>BDATE</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>PHONE</span>) <span lang=EN-US
style='mso-ansi-language:EN-US'>VALUES</span> ('Кушнарев Сергей Иванович',
'1985-04-01', 452328).<span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><span
lang=EN-US> </span></p>

<p class=MsoNormal>При выполнении запроса <span lang=EN-US style='mso-ansi-language:
EN-US'>SELECT</span><span lang=EN-US> </span>первым пользователем он также
получит в качестве результата только две записи, которые находились в базе
данных до начала транзакций первого и второго пользователя.</p>

<p class=MsoNormal>Запрос <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span><span
lang=EN-US> </span>вернет все 4 записи только после того, как первый и второй
пользователи завершат транзакцию с помощью примитива <span lang=EN-US
style='mso-ansi-language:EN-US'>COMMIT</span>.&nbsp; Если хотя бы один из
пользователей завершит транзакцию примитивом <span lang=EN-US style='mso-ansi-language:
EN-US'>RollBack</span><span lang=EN-US> </span>все изменения в базе данных,
сделанные после начала транзакции будут отменены. </p>

<p class=MsoNormal>В компоненте <span lang=EN-US style='mso-ansi-language:EN-US'>IBTransaction</span><span
lang=EN-US> </span>необходимо установить свойство <span lang=EN-US
style='mso-ansi-language:EN-US'>DefaultDatabase</span>, указав в нем имя
компонента <span lang=EN-US style='mso-ansi-language:EN-US'>IBDatabase</span>.</p>

<p class=MsoNormal>Компонент <span lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span>
предназначен для передачи запросов от клиентского приложения серверу баз
данных. На странице свойств необходимо указать компонент управления
транзакциями <span lang=EN-US style='mso-ansi-language:EN-US'>transaction</span><span
lang=EN-US> </span><span lang=EN-US style='font-family:Wingdings;mso-ansi-language:
EN-US'>&agrave;</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>IBTransaction</span><span lang=EN-US> </span>и&nbsp;
заполнить редактор предложений <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>
(например, <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span> * <span
lang=EN-US style='mso-ansi-language:EN-US'>FROM</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span>).</p>

<p class=MsoNormal>Компонент <span lang=EN-US style='mso-ansi-language:EN-US'>DataSource</span><span
lang=EN-US> </span>выполняет связь источника данных (<span lang=EN-US
style='mso-ansi-language:EN-US'>TIBQuery</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>TIBTable</span><span lang=EN-US> </span>и др.)
и интерфейсных компонентов формы для отображения данных. На странице свойств
следует указать компонент источник данных <span lang=EN-US style='mso-ansi-language:
EN-US'>DataSet</span><span lang=EN-US> </span>(в нашем случае <span lang=EN-US
style='mso-ansi-language:EN-US'>IBQuery</span>).</p>

<p class=MsoNormal>Приступим к&nbsp; созданию интерфейсной части проекта.
Отметим, что константное имя файла базы данных, указанное в свойстве <span
lang=EN-US style='mso-ansi-language:EN-US'>DataBaseName</span>, затрудняет
перенос приложения на другие компьютеры. Поэтому, в верхней части головной
формы проекта (рисунок 1.8) расположим строку ввода пути к базе данных,
компонент-диалог выбора имени базы и кнопку <span lang=EN-US style='mso-ansi-language:
EN-US'>BtOpen</span> для его активизации. Кнопка «Обновить» (<span lang=EN-US
style='mso-ansi-language:EN-US'>BtRefresh</span>) &nbsp;предназначена для
обновления информации, получаемой из&nbsp; базы данных.</p>

<p class=MsoNormal>В клиентской части окна расположим компонент <span
lang=EN-US style='mso-ansi-language:EN-US'>DBGrid</span><span lang=EN-US> </span>со
вкладки <span lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Controls</span><span
lang=EN-US> </span>для отображения результатов запроса <span lang=EN-US
style='mso-ansi-language:EN-US'>IBQuery</span>. В качестве источника данных
укажем компонент <span lang=EN-US style='mso-ansi-language:EN-US'>DataSource</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>File</span>/<span lang=EN-US
style='mso-ansi-language:EN-US'>UseUnit</span><span lang=EN-US
style='font-family:Wingdings;mso-ansi-language:EN-US'>&agrave;</span><span
lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2). </p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'><img border=0 width=419 height=164 id="_x0000_i1035"
src="musubd.files/image010.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 1.8 – интерфейсная часть
проекта</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Разработаем обработчики событий для кнопокBtOpen и <span
lang=EN-US style='mso-ansi-language:EN-US'>BtRefresh</span>.</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Открыть<span style='mso-ansi-language:EN-US'> </span>базу<span
style='mso-ansi-language:EN-US'> </span>данных<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TForm1.BtOpenClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;if OpenDialog.Execute then //</span>Вводим<span style='mso-ansi-language:
EN-US'> </span>имя<span style='mso-ansi-language:EN-US'> </span>файла<span
style='mso-ansi-language:EN-US'> </span>базы<span style='mso-ansi-language:
EN-US'> </span>данных<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;begin</span></p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; //Выводим его в строку редактирования</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>EdDataBaseName</span>.<span lang=EN-US style='mso-ansi-language:EN-US'>Text</span>:=<span
lang=EN-US style='mso-ansi-language:EN-US'>OpenDialog</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>FileName</span>;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; //Устанавливаем имя для компонента <span
lang=EN-US style='mso-ansi-language:EN-US'>IBDataBase</span><span lang=EN-US> </span></p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule2.IBDataBase.DatabaseName:=OpenDialog.FileName;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
//</span>Устанваливаем<span style='mso-ansi-language:EN-US'> </span>связь<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>базой<span style='mso-ansi-language:EN-US'> </span>данных<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
DataModule2.IBDataBase.Connected:=true;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
//</span>Активизируем<span style='mso-ansi-language:EN-US'> </span>запрос<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
DataModule2.IBQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span>end;</p>

<p class=MsoNormal>end;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>//Обновить состояние базы данных</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>procedure
TForm1.BtRefreshClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>begin</span></p>

<p class=MsoNormal>&nbsp; //Завершаем транзакцию. Запрос закрывается.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2.<span
lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Transaction</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Commit</span>;</p>

<p class=MsoNormal>&nbsp; //Вновь активизируем&nbsp; запрос</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>DataModule2.IBQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>end;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>После запуска приложения и выбора файла базы данных главная
форма проекта имеет вид, показанный на рисунке 1.9.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'><img border=0 width=419 height=164 id="_x0000_i1036"
src="musubd.files/image011.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span>Рисунок
1.9 – Главная форма во время работы проекта.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Добавьте несколько записей в таблицу <span lang=EN-US style='mso-ansi-language:
EN-US'>PHONE</span><span lang=EN-US> </span>с помощью оболочки <span
lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span> и нажмите кнопку
«Обновить». Обратите внимание, что состояние данных не изменяется до завершения
транзакции. Завершить транзакцию можно нажатием кнопки «Подтвердить транзакцию»
с изображением красной галочки в окне «Таблица» (рисунок 1.5).</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></p>

<h1><a name="_Toc163231766">2.</a><span style='mso-bookmark:_Toc163231766'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №2. Средства манипулирования данными языка SQL. РАЗРАБОТКА КЛИНТСКОГО
ПРИЛОЖЕНИЯ ДЛЯ ВВОДА И КОРРЕКЦИИ ДАННЫХ</span></h1>

<p class=MsoNormal>&nbsp;</p>

<h2>2.1.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель
работы:</h2>

<p class=MsoNormal>Изучение операторов <span lang=EN-US style='mso-ansi-language:
EN-US'>INSERT</span>, <span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE</span>,
<span lang=EN-US style='mso-ansi-language:EN-US'>DELETE</span> и простейших
форм оператора SELECT. Изучение методов разработки клиентских приложений для
ввода и коррекции данных.</p>

<p class=MsoNormal>&nbsp;</p>

<h2>2.2.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Введение</h2>

<p class=MsoNormal>К базовым средствам манипулирования данными языка SQL
относятся &quot;поисковые&quot; варианты операторов UPDATE и DELETE. Эти
варианты называются поисковыми, потому что при задании соответствующей операции
задается логическое условие, налагаемое на строки адресуемой оператором
таблицы, которые должны быть подвергнуты модификации или удалению. Кроме того,
в такую категорию языковых средств входит оператор INSERT, позволяющий
добавлять строки в существующие таблицы. </p>

<p class=MsoNormal>&nbsp;</p>

<h2>2.3.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика
выполнения работы</h2>

<p class=MsoNormal style='text-indent:0cm'>1) Создать средствами оболочки <span
lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>EXPERT</span><span lang=EN-US> </span>базу
данных, содержащую одну таблицу в соответствии с вариантом задания.</p>

<p class=MsoNormal style='text-indent:0cm'>2) Создать в таблице 8-10 записей произвольного
содержания. В 3-4 записях содержимое поля должно соответствовать условию,
указанному в варианте задания.</p>

<p class=MsoNormal style='text-indent:0cm'>3) Вызвать диалог <span lang=EN-US
style='mso-ansi-language:EN-US'>SQL</span>-редактор <span lang=EN-US
style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>EXPERT</span> (Инструменты/<span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span> редактор). Ввести 3-4
запроса для добавления записи в таблицу.</p>

<p class=MsoNormal style='text-indent:0cm'>4) Изменить содержимое полей
последней введенной записи.</p>

<p class=MsoNormal style='text-indent:0cm'>5) Изменить содержимое любого поля
всех записей, удовлетворяющих условию.</p>

<p class=MsoNormal style='text-indent:0cm'>6) Удалить все записи,
удовлетворяющие условию.</p>

<p class=MsoNormal style='text-indent:0cm'>7) Разработать клиентское приложение
средствами среды <span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span>
(<span lang=EN-US style='mso-ansi-language:EN-US'>C</span>++ <span lang=EN-US
style='mso-ansi-language:EN-US'>Builder</span>) для ввода, отображения&nbsp; и
коррекции данных таблицы.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<h2>2.4.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Варианты
заданий</h2>

<p class=MsoNormal>Вариант задания (таблица 2.1) выбирается по формуле (<span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>mod</span> 24)+1, где <span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span>–
последние две цифры&nbsp; зачетной книжки студента.&nbsp; В варианте указано:
номер структуры данных (структуры данных приведены в приложении 1), имя
таблицы, условие, которому должны соответствовать обновляемые и удаляемые
данные.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таблица 2.1 – Варианты заданий к лабораторной работе №2</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=442
 style='width:331.45pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center;text-indent:0cm'>№
  структ.</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Имя таблицы</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Условие</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Публикация</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тип=<span lang=EN-US
  style='mso-ansi-language:EN-US'>’</span>статья<span lang=EN-US
  style='mso-ansi-language:EN-US'>’</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>2</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Курс</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>№ </span>преподавателя<span lang=EN-US style='mso-ansi-language:EN-US'>=</span>1</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>3</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Операция</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Название Операции = <span
  lang=EN-US style='mso-ansi-language:EN-US'>‘</span>Аппендицит<span
  lang=EN-US style='mso-ansi-language:EN-US'>’</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>4</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Личность</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Пол=<span lang=EN-US
  style='mso-ansi-language:EN-US'>’</span>мужской<span lang=EN-US
  style='mso-ansi-language:EN-US'>’</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>5</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Помещение</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Площадь <span lang=EN-US
  style='mso-ansi-language:EN-US'>&lt; 20</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>6</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Служащий</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Код профессии = 3</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>7</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Труд. деятельность</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тип события =’увольнение’</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;page-break-inside:avoid;height:12.0pt'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>8</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Студент</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Стипендия<span lang=EN-US
  style='mso-ansi-language:EN-US'> &gt; 100</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>9</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Экзамен</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ предмета=3</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>10</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поезд</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Станция прибытия=4</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>11</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ предмета = 3</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>12</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Персона</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество детей = 2</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>13</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Результат соревнований</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество забитых мячей = 2</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>14</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Концертный зал</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество мест = 200</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>15</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Сотрудник</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Оклад <span lang=EN-US
  style='mso-ansi-language:EN-US'>&gt; 600</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>16</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Перевозка</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Место назначения = <span
  lang=EN-US style='mso-ansi-language:EN-US'>‘</span>Москва<span lang=EN-US
  style='mso-ansi-language:EN-US'>’</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>17</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Гостиница</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Разряд = 3</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>18</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Курс лечения</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Стоимость <span lang=EN-US
  style='mso-ansi-language:EN-US'>&lt; 300</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>19</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Комплектующие</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Стоимость <span lang=EN-US
  style='mso-ansi-language:EN-US'>&gt; 200</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20;mso-yfti-lastrow:yes'>
  <td width=54 valign=top style='width:40.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=UK style='mso-ansi-language:
  UK'>20</span></p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Газета</p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тираж <span lang=EN-US
  style='mso-ansi-language:EN-US'>&lt; 10000</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2>2.5.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание
отчета</h2>

<p class=MsoNormal>Отчет должен содержать цель полное описание действий
студента по созданию базы данных, ввода, коррекции и удаления полей.
Обязательно должны быть указаны фактические значения (по варианту задания),
вводимые в диалоговые окна. Описание программы должно включать список форм,
компонентов, перечень предопределяемых свойств компонентов. Отчет состоит из
титульного листа, цели работы, описания процесса выполнения работы и вывода.</p>

<p class=MsoBodyText>&nbsp;</p>

<h2>2.6.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные
вопросы</h2>

<h2><span lang=EN-US style='mso-ansi-language:EN-US;font-weight:normal'>&nbsp;</span></h2>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>1) Какие
операции манипулирования с данными Вы знаете?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>2) Опишите
синтаксис операторов <span lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span>,
<span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE</span>, <span
lang=EN-US style='mso-ansi-language:EN-US'>DELETE</span>. </p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>3) Каким образом
можно определить условия отбора записей для изменения, удаления?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>4) Что
обозначает символ % в теле строки-образца?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>5) Какие компоненты
для работы с данными необходимы для создания клиентского приложения?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>6) Почему при
выборке с помощью компонента <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span
lang=EN-US> </span>используется метод <span lang=EN-US style='mso-ansi-language:
EN-US'>Open</span> (или свойство <span lang=EN-US style='mso-ansi-language:
EN-US'>active</span>=<span lang=EN-US style='mso-ansi-language:EN-US'>true</span>),
а при добавлении, изменении, удалении данных – <span lang=EN-US
style='mso-ansi-language:EN-US'>ExecSQL</span>.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>7) Почему после
внесения изменений в таблицах посредством клиентского приложения приходится
рестартовать транзакцию?</p>

<p class=MsoNormal>&nbsp;</p>

<h2>2.7.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Рекомендации
по выполнению работы</h2>

<p class=MsoNormal>&nbsp;</p>

<h3>2.7.1.<span style='font-size:7.0pt'> </span>Базовые средства
манипулирования данными</h3>

<p class=MsoNormal>Оператор INSERT добавляет одну или более новых строк данных
к существующей таблице или виду. INSERT - одна из привилегий базы данных,
которая контролируется инструкциями GRANT и REVOKE.</p>

<p class=MsoNormal>Значения вставляются в столбцы строки по порядку их
следования, если не задан факультативный список столбцов. Если список столбцов
задан на множестве всех доступных столбцов, во все не перечисленные столбцы
автоматически втавляется или значение по умолчанию, или NULL.</p>

<p class=MsoNormal>Если факультативный список столбцов упущен, предложение
VALUES должно содержать значения для всех столбцов таблицы.</p>

<p class=MsoNormal>Чтобы вставить одну строку данных, должно присутствовать
предложение VALUES и содержать определенный список значений.</p>

<p class=MsoNormal>Чтобы вставить несколько строк данных, определите
&lt;select_expr&gt;, которое возвращает уже существующие данные из другой
таблицы. Выбранные строки должны соответствовать списку столбцов.</p>

<p class=MsoNormal>Предупреждение: Допустимо выбирать из той же таблицы, в
которую строки вставляются, но эта практика не рекомендуется, так как подобные
действия могут привести к бесконечным вставкам строк (зацикливанию).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Синтаксис<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT INTO
&lt;object&gt; [(col [, col ...])]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>{VALUES
(&lt;val&gt; [, &lt;val&gt; ...]) | &lt;select_expr&gt;};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;object&gt;
= tablename | viewname<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;val&gt;
= { &lt;constant&gt; | &lt;expr&gt;| &lt;function&gt; | NULL | USER } [COLLATE
collation]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Обратите внимание: Предложение COLLATE не может быть использовано
для BLOB значений.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;constant&gt;
= num | &quot;string&quot; | charsetname &quot;string&quot;<o:p></o:p></span></p>

<p class=MsoNormal>&lt;expr&gt; = Допустимое выражение SQL, которое возвращает</p>

<p class=MsoNormal>&nbsp; в<span style='mso-ansi-language:EN-US'> </span>одиночное<span
style='mso-ansi-language:EN-US'> </span>значение<span style='mso-ansi-language:
EN-US'> </span>столбца<span lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;function&gt;
= { CAST (&lt;val&gt; AS &lt;datatype&gt;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; |
UPPER (&lt;val&gt;)&nbsp; | GEN_ID (generator, &lt;val&gt;)&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal>&lt;select_expr&gt; = SELECT возвращающий ноль или более
строк,&nbsp; где число столбцов в каждой строке такое же, &nbsp;как число
элементов, которые должны быть вставлены.</p>

<p class=MsoNormal>INTO &lt;object&gt; Имя существующей таблицы или вида, в
которую вставляются данные. </p>

<p class=MsoNormal>col Имя существующего столбца в таблице или виде, в который
вставляются значения. </p>

<p class=MsoNormal>VALUES (&lt;val&gt; [, &lt;val&gt; ...] Список значению дляя
вставки в таблицу или вид. Значения должны быть в том же порядке, как целевые
столбцы. </p>

<p class=MsoNormal>&lt;select_expr&gt; Запрос, который возвращает значения, для
вставки в целевые столбцы. </p>

<p class=MsoNormal>Пример:</p>

<p class=MsoNormal>Следующая инструкция добавляет строку в таблицу, присваивает
значения двум столбцам:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>INSERT INTO
EMPLOYEE_PROJECT (EMP_NO, PROJ_ID) VALUES (52, &quot;DGPII&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Оператор UPDATE изменяет одну или более существующих строк в
таблице или виде. Факультативное предложение WHERE может быть использовано,
чтобы ограничить UPDATE к некоторому подмножеству строк таблицы. Модификации не
могут модифицировать секторы массива. Предупреждение: Если предложение WHERE
упущено, UPDATE изменяет все строки в таблице. Обратите внимание: Когда
модифицируются BLOB столбцы, UPDATE заменяет весь BLOB целиком новым значением.</p>

<p class=MsoNormal>Синтаксис<span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE
{table | view}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SET col =
&lt;val&gt; [, col = &lt;val&gt; ...]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;
[WHERE &lt;search_condition&gt;;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;val&gt;
= { col [&lt;array_dim&gt;] | &lt;constant&gt; | &lt;expr&gt; |
&lt;function&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; |
NULL | USER&nbsp; }&lt;array_dim&gt; = [x:y [, x:y ...]]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Обратите внимание: Внешние скобки (выделено жирным) должны
присутствовать в ссылке на массив.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;constant&gt;
= num | &quot;string&quot; | charsetname &quot;string&quot;<o:p></o:p></span></p>

<p class=MsoNormal>&lt;expr&gt; = Допустимое выражение SQL, которое возвращает
одиночное значение.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;function&gt;
= {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CAST
(&lt;val&gt; AS &lt;datatype&gt;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; |
UPPER (&lt;val&gt;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; |
GEN_ID (generator, &lt;val&gt;)&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal>table | view - Имя существующей таблицы или вида для
модификции. </p>

<p class=MsoNormal>SET col = &lt;val&gt; Определяет столбцы для изменения и
значения, которые требуется присвоить этим столбцам. </p>

<p class=MsoNormal>WHERE &lt;search_cond&gt; Модифицировать только найденное.
Определяет условия, которым строка должна удовлетворять, чтобы изменится. </p>

<p class=MsoNormal>Примеры:</p>

<p class=MsoNormal style='text-indent:0cm'>Следующая инструкция изменяет столбцы
для всех строк таблицы:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE
CITIES<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; SET
POPULATION = POPULATION * 1.03;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>Следующая инструкция использует
предложение WHERE, чтобы ограничить модификацию столбцов подмножеством строк:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE
COUNTRY<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; SET
CURRENCY = &quot;USDollar&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; </span>WHERE
COUNTRY = &quot;USA&quot;;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Оператор DELETE определяет одну или более строк, чтобы
удалить из таблицы или редактируемого (updatable) вида. DELETE - одна из
привилегий, которые контролируются инструкциями GRANT и REVOKE.</p>

<p class=MsoNormal>Для определения строк, которые следует удалить, может быть
использовано факультативное предложение WHERE.</p>

<p class=MsoNormal>Предостережение: Если не используется предложение WHERE,
удалены все строки из таблицы.</p>

<p class=MsoNormal>Синтаксис<span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>DELETE FROM
table [WHERE &lt;search_condition&gt;];<o:p></o:p></span></p>

<p class=MsoNormal>Table -&nbsp; Имя таблицы из которой удаляются строки. </p>

<p class=MsoNormal>&lt;search_condition&gt; Условия поиска, которые определяют
строки для удаления. Если это предложение не используется, DELETE воздействует
на все строки в определенной таблице или виде. </p>

<p class=MsoNormal>Примеры:</p>

<p class=MsoNormal style='text-indent:0cm'>Следующая инструкция удаляет все
строки из таблицы:</p>

<p class=MsoNormal>DELETE FROM EMPLOYEE_PROJECT;</p>

<p class=MsoNormal style='text-indent:0cm'>Следующая инструкция удаляет строку
для служащего #141:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>DELETE FROM
SALARY_HISTORY<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE
EMP_NO = 141;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<h3>2.7.2.<span style='font-size:7.0pt'> </span>Манипулирование данными таблицы
с помощью диалогового окна <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>-редактор</h3>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal>Оболочка <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span><span
lang=EN-US> </span>предоставляет возможности интерактивного манипулирования
данными с помощью окна «Таблица» вкладка «Данные» (рисунок 1.5). Однако при
программировании клиентских приложений&nbsp; и администрирования сервера базы
данных необходимо уметь составлять запросы на языке <span lang=EN-US
style='mso-ansi-language:EN-US'>SQL</span>. Для исполнения скриптов <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span lang=EN-US> </span>в
<span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span><span lang=EN-US> </span>предусмотрено
диалоговое окно <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>-редактор
(рисунок 2.1).</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=433 height=261
id="_x0000_i1037" src="musubd.files/image012.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 2.1 – <span lang=EN-US
style='mso-ansi-language:EN-US'>SQL</span><span lang=EN-US> </span>редактор <span
lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span>Прежде&nbsp;
чем пользоваться <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>-редактором
установите соединение с необходимой базой данных с помощью окна <span
lang=EN-US style='mso-ansi-language:EN-US'>Database</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Explorer</span>. После ввода
предложения нажмите на кнопку «Выполнить» (или <span lang=EN-US
style='mso-ansi-language:EN-US'>F</span>9). В нижней части окна будут выданы
сообщения о процессе исполнения операции. </p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Все
изменения, вносимые в базу данных&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>SQL</span>-редактором, выполняются в рамках одной транзакции. Для
подтверждения изменений используйте кнопку «Подтвердить транзакцию».</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Рассмотрим процесс модификации данных таблицы <span lang=EN-US
style='mso-ansi-language:EN-US'>Phone</span>, созданной в лабораторной работе
№1.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Добавим с помощью языка <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span
lang=EN-US> </span>следующие данные:</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>insert into phone (fio,bdate,phone)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>VALUES ('Кушнарев Юрий Петрович',
'1983-01-12', 451655).</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; После
подтверждения транзакции состояние данных таблицы показано на рисунке 2.2.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=265
id="_x0000_i1038" src="musubd.files/image013.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 2.2 – Состояние таблицы <span
lang=EN-US style='mso-ansi-language:EN-US'>PHONE</span><span lang=EN-US> </span>после
добавления данных</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>Изменим номер телефона Алексея
Смирнова. Для этого воспользуемся оператором <span lang=EN-US style='mso-ansi-language:
EN-US'>UPDATE</span>. Как следует из синтаксиса <span lang=EN-US
style='mso-ansi-language:EN-US'>UPDATE</span><span lang=EN-US> </span>для изменения
конкретной записи нам необходимо каким-либо образом идентифицировать ее в
наборе данных:</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>update phone set phone.phone=240101 where FIO LIKE '</span>Смирнов<span
lang=EN-US style='mso-ansi-language:EN-US'>%'<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>Условие <span lang=EN-US
style='mso-ansi-language:EN-US'>where</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>FIO</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>LIKE</span> 'Смирнов%' указывает
серверу баз данных в каких записях таблицы следует&nbsp; изменить значение поля
<span lang=EN-US style='mso-ansi-language:EN-US'>phone</span>. В нашем случае
фамилия Смирнов встречается 1 раз, поэтому в качестве образца мы задаем
начальные символы строки поля <span lang=EN-US style='mso-ansi-language:EN-US'>FIO</span>.
Символ ‘%’ в теле строки-образца обозначает «любая последовательность
символов». Очевидно, что результат запроса <span lang=EN-US style='mso-ansi-language:
EN-US'>update</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>phone</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>set</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>phone</span>.<span lang=EN-US style='mso-ansi-language:EN-US'>phone</span>=240101
<span lang=EN-US style='mso-ansi-language:EN-US'>where</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>FIO</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>LIKE</span> 'См%' для данной таблицы
идентичен предыдущему.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Для
удаления последней записи таблицы воспользуемся оператором <span lang=EN-US
style='mso-ansi-language:EN-US'>DELETE</span>:</p>

<p class=MsoNormal style='text-indent:14.2pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>delete from phone where phone.phone=451655<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:14.2pt'>Если необходимо удалить все
записи таблицы, то в этом случае условие поиска в операторе <span lang=EN-US
style='mso-ansi-language:EN-US'>DELETE</span><span lang=EN-US> </span>опускается:
<span lang=EN-US style='mso-ansi-language:EN-US'>delete</span><span lang=EN-US>
</span><span lang=EN-US style='mso-ansi-language:EN-US'>from</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>phone</span>.</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<h3>2.7.3.<span style='font-size:7.0pt'> </span>Клиентское приложение для
манипулирования данными </h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Модифицируем приложение-клиент, разработанное в лабораторной
работе №1.</p>

<p class=MsoNormal>Добавим на форму компоненты для редактирования полей базы
данных: <span lang=EN-US style='mso-ansi-language:EN-US'>EdFIO</span>, <span
lang=EN-US style='mso-ansi-language:EN-US'>EdPhone</span><span lang=EN-US> </span>типа
<span lang=EN-US style='mso-ansi-language:EN-US'>TEdit</span> и <span
lang=EN-US style='mso-ansi-language:EN-US'>DTP</span><span lang=EN-US> </span>типа
<span lang=EN-US style='mso-ansi-language:EN-US'>TDateTimePicker</span><span
lang=EN-US> </span>со вкладки <span lang=EN-US style='mso-ansi-language:EN-US'>Win</span>32
(рисунок 2.3) и кнопки «Добавить», «Изменить», «Удалить».</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=286
id="_x0000_i1039" src="musubd.files/image014.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 2.3 – Форма редактирования
данных</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; На
невизуальной форме <span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2
поместим дополнительный компонент типа <span lang=EN-US style='mso-ansi-language:
EN-US'>TIBQuery</span><span lang=EN-US> </span>для выполнения запросов
манипуляции данных. Поле <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span
lang=EN-US> </span>этого компонента пока оставим пустым, укажем лишь
свойство&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>Transaction</span>=<span
lang=EN-US style='mso-ansi-language:EN-US'>IBTransaction</span>.</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'><img border=0 width=226 height=234 id="_x0000_i1040"
src="musubd.files/image015.jpg"></span></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 2.4 – Модифицированная форма
<span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>Разработаем обработчик события по
нажатию&nbsp; кнопки «Добавить». Будем считать, что поля редактирования
заполнены должным образом, и нам необходимо перенести из них информацию в базу
данных.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>//Процедура добавления записи в
таблицу</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>TForm</span>1.<span lang=EN-US
style='mso-ansi-language:EN-US'>BtAddClick</span>(<span lang=EN-US
style='mso-ansi-language:EN-US'>Sender</span>: <span lang=EN-US
style='mso-ansi-language:EN-US'>TObject</span>);</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; with DataModule2 do<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Очистка<span style='mso-ansi-language:EN-US'> </span>редактора<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>SQL </span></span>компонента<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>IBQuery<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery</span>.<span lang=EN-US style='mso-ansi-language:
EN-US'>SQL</span>.<span lang=EN-US style='mso-ansi-language:EN-US'>Clear</span>;</p>

<p class=MsoNormal style='text-indent:0cm'>//Ввод текста запроса добавления
записи</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>workquery.SQL.Add('insert into phone
(fio,bdate,phone)');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.SQL.Add('VALUES (:newfio, :newbdate,
:newphone)');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>// Здесь :<span lang=EN-US
style='mso-ansi-language:EN-US'>newfio</span>, :<span lang=EN-US
style='mso-ansi-language:EN-US'>newbdate</span>, :<span lang=EN-US
style='mso-ansi-language:EN-US'>newphone</span> – парметры запроса, которые
будут </p>

<p class=MsoNormal style='text-indent:0cm'>// заполнены позже из компонентов
редактирования.</p>

<p class=MsoNormal style='text-indent:0cm'>// Символ ‘:’ является признаком
парметра</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>//Заполняем значение параметра из
компонентов редактирвоания</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>workquery.ParamByName('newfio').AsString:=EdFIO.Text;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ParamByName('newbdate').AsDate:=DTP.Date;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;
workquery.ParamByName('newphone').AsInteger:=StrToInt(EdPhone.Text);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>//Пытаемся выполнить запрос <span
lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span>. При его выполнении
возможны </p>

<p class=MsoNormal style='text-indent:0cm'>//ошибки. Для корректной работы
приложения помещаем операторы</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>в<span style='mso-ansi-language:EN-US'> </span>защитный<span
style='mso-ansi-language:EN-US'> </span>блок<span style='mso-ansi-language:
EN-US'> <span lang=EN-US>try…except…end<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; try<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery</span>.<span lang=EN-US style='mso-ansi-language:
EN-US'>ExecSQL</span>; //Выполняем запрос</p>

<p class=MsoNormal style='text-indent:0cm'>//Так как предложение <span
lang=EN-US style='mso-ansi-language:EN-US'>INSERT</span><span lang=EN-US> </span>не
возвращает конкретного результата </p>

<p class=MsoNormal style='text-indent:0cm'>// для его выполнения используем
метод <span lang=EN-US style='mso-ansi-language:EN-US'>ExecSQL</span></p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>workquery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Transaction</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Commit</span>;</p>

<p class=MsoNormal style='text-indent:0cm'>//Завершаем транзакцию. В противном
случае изменения будут не видны</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>IBQuery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Open</span>;</p>

<p class=MsoNormal style='text-indent:0cm'>//Открываем запрос – состояние базы
данных обновлено.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>Except</span>&nbsp; //Сбойная ситуация</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
lang=EN-US style='mso-ansi-language:EN-US'>showmessage</span>('Ошибка операции
добавления');</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; end;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp; end;</p>

<p class=MsoNormal style='text-indent:0cm'>end;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>Обработчик события по нажатию кнопки
«Обновить». </p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TForm1.BtUpdateClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; with DataModule2 do<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Вводим<span style='mso-ansi-language:EN-US'> </span>текст<span
style='mso-ansi-language:EN-US'> </span>запроса<span style='mso-ansi-language:
EN-US'> </span>обновления<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.SQL.Add('update phone set fio=:newfio,
bdate=:newbdate, phone=:newphone');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>//Идентифицируем запись по текущему
состоянию всех полей</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>workquery.SQL.Add('WHERE (fio=:fio) and
(bdate=:bdate) and (phone=:phone)');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>//Заполняем новые значения из полей
редактирвоания</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>workquery.ParamByName('newfio').AsString:=EdFIO.Text;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ParamByName('newbdate').AsDate:=DTP.Date;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;
workquery.ParamByName('newphone').AsInteger:=StrToInt(EdPhone.Text);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>//Идентифицируем запись</p>

<p class=MsoNormal style='text-indent:0cm'>//для этого используем&nbsp;
предыдущие значения полей</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>// </span>из<span style='mso-ansi-language:EN-US'> </span>компонента<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>IBQuery<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>workquery.ParamByName('fio').AsString:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('FIO').AsString;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;workquery.ParamByName('bdate').AsDate:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>IBQuery.FieldByName('bdate').AsDateTime;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>workquery.ParamByName('phone').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>IBQuery.FieldByName('phone').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Создаем<span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; </span>защищенный<span
style='mso-ansi-language:EN-US'> </span>блок<span style='mso-ansi-language:
EN-US'> </span>на<span style='mso-ansi-language:EN-US'> </span>случай<span
style='mso-ansi-language:EN-US'> </span>ошибок<span style='mso-ansi-language:
EN-US'> </span>БД<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; try</span></p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
lang=EN-US style='mso-ansi-language:EN-US'>workquery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>ExecSQL</span>; //Выполняем запрос – обновляем
запись</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
lang=EN-US style='mso-ansi-language:EN-US'>workquery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Transaction</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Commit</span>; //Завершаем транзакцию</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Open</span>; //Обновляем состояние таблицы</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>except</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>showmessage</span>('Ошибка операции
обновления’);</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span>end;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp; end;</p>

<p class=MsoNormal style='text-indent:0cm'>end;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>//Обработчик события нажатия кнопки
«Удалить»</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TForm1.BtDeleteClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>with</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>2 <span lang=EN-US style='mso-ansi-language:EN-US'>do</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>begin</span></p>

<p class=MsoNormal style='text-indent:0cm'>//Динамическое
формирование&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>-запроса
удаления записи</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>workquery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.SQL.Add('delete from phone ');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.SQL.Add('WHERE (fio=:fio) and
(bdate=:bdate) <o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and</span> (<span lang=EN-US style='mso-ansi-language:EN-US'>phone</span>=:<span
lang=EN-US style='mso-ansi-language:EN-US'>phone</span>)');</p>

<p class=MsoNormal style='text-indent:0cm'>//Определяем параметры,
идентифицирующие текущую запись</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>// </span>из<span style='mso-ansi-language:EN-US'> </span>компонента<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>IBQuery<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ParamByName('fio').AsString:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('FIO').AsString;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ParamByName('bdate').AsDate:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('bdate').AsDateTime;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ParamByName('phone').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:14.2pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>IBQuery.FieldByName('phone').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Выполняем<span style='mso-ansi-language:EN-US'> </span>запрос<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.ExecSQL;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Закрываем<span style='mso-ansi-language:EN-US'> </span>транзакцию<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; workquery.Transaction.Commit;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>//Обновляем состояние таблицы</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span>IBQuery.Open;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp; end;</p>

<p class=MsoNormal style='text-indent:0cm'>end; </p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>В заключение, сделаем так, чтобы
состояние полей редактирования изменялось соответственно текущей записи при
перемещении указателя в таблице. Для этого обработаем событие <span lang=EN-US
style='mso-ansi-language:EN-US'>on</span>CellClick компонента <span lang=EN-US
style='mso-ansi-language:EN-US'>DBGrid</span>.</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>TForm</span>1.<span lang=EN-US
style='mso-ansi-language:EN-US'>DBGridCellClick</span>(<span lang=EN-US
style='mso-ansi-language:EN-US'>Column</span>: <span lang=EN-US
style='mso-ansi-language:EN-US'>TColumn</span>);</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>try</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>with</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>2 <span lang=EN-US style='mso-ansi-language:EN-US'>do</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>begin&nbsp;</span> //Изменяем сосотяние полей редактирования</p>

<p class=MsoNormal style='text-indent:0cm'>//В соответствии с выбранной строкой
таблицы</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>EdFIO.Text:=IBQuery.FieldByName('FIO').AsString;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;
DTP.DateTime:=IBQuery.FieldByName('bdate').AsDateTime;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; EdPhone.Text:=IBQuery.FieldByName('phone').AsString;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; end;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; except<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp; showmessage('Ошибка доступа к данным');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; end;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>end</span>;</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'>Следует отметить, что разработанное
приложение хотя и работоспособно, но имеет ряд недостатков. В частности, после
выполнения любой операции с данными указатель в компоненте <span lang=EN-US
style='mso-ansi-language:EN-US'>DBGrid</span><span lang=EN-US> </span>автоматически
устанавливается на 1-ю запись (В связи с тем, что запрос <span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT</span><span lang=EN-US> </span>каждый
раз активизируется заново). Установить указатель на нужную запись в наборе
данных можно с помощью метода <span lang=EN-US style='mso-ansi-language:EN-US'>Locate</span>.
Исследовать его работу предлагается самостоятельно.</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h1><a name="_Toc163231767">3.</a><span style='mso-bookmark:_Toc163231767'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №3. ЭЛЕМЕНТАРНЫЕ ВЫБОРКИ ПОСРЕДСТВОМ ОПЕРАТОРА </span><span
style='mso-bookmark:_Toc163231767'></span><span lang=EN-US style='mso-ansi-language:
EN-US'>SELECT</span>. АГРЕГАТНЫЕ ФУНУКЦИИ <span lang=EN-US style='mso-ansi-language:
EN-US'>SQL</span>.</h1>

<p class=MsoNormal>&nbsp;</p>

<h2>3.1.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель
работы:</h2>

<p class=MsoNormal>Изучение &nbsp;работы оператора SELECT языка <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>. <span style='color:black'>Изучение
возможностей обработки данных с помощью агрегатных функций языка </span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>SQL</span><span
style='color:black'>.</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>&nbsp;</span></p>

<h2>3.2.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Введение</h2>

<p class=MsoNormal>Большинство операций с базой данных заключается в выборке из
нее необходимой пользователю информации. Для этого служит оператор <span
lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span>, позволяющий
формировать набор данных (<span lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Set</span>),
удовлетворяющий условиям поиска и группировки данных. В том числе, оператор <span
lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span><span lang=EN-US> </span>используется
для подведения итогов, получения статистической информации и т.д.</p>

<p class=MsoNormal>&nbsp;</p>

<h2>3.3.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика
выполнения работы</h2>

<p class=MsoNormal style='text-indent:0cm'>1) Изучить рекомендации по
выполнению работы и определить вариант задания.</p>

<p class=MsoNormal style='text-indent:0cm'>2) Создать запрос, выводящий все
строки таблицы, указанной в варианте задания.</p>

<p class=MsoNormal style='text-indent:0cm'>3)&nbsp;&nbsp; Создать запрос,
задающий порядок столбцов, отличный от исходного.</p>

<p class=MsoNormal style='text-indent:0cm'>4)&nbsp;&nbsp; Продемонстрировать
действие модификатора DISTINCT.</p>

<p class=MsoNormal style='text-indent:0cm'>5)&nbsp;&nbsp; Ограничить вывод
запроса, используя WHERE с простым условием.</p>

<p class=MsoNormal style='text-indent:0cm'>6)&nbsp;&nbsp; Ограничить вывод запроса,
используя WHERE и составное условие.</p>

<p class=MsoNormal style='text-indent:0cm'>7)&nbsp;&nbsp; Продемонстрировать
действие специальных функций IN,&nbsp; BETWEEN,&nbsp; LIKE,&nbsp; и IS NULL в
условии.</p>

<p class=MsoNormal style='text-indent:0cm'>8)&nbsp;&nbsp; Продемонстрировать
работу специальных функций с условием NOT.</p>

<p class=MsoNormal style='text-indent:0cm'>9)&nbsp;&nbsp; Ознакомиться с
принципами работы агрегатных функций COUNT, SUM, AVG, MAX, MIN.</p>

<p class=MsoNormal style='text-indent:0cm'>10) Продемонстрировать использование
COUNT(*)</p>

<p class=MsoNormal style='text-indent:0cm'>11) Продемонстрировать выполнение
простых вычислений в запросе.</p>

<p class=MsoNormal style='text-indent:0cm'>12) Использовать простое вычисление
как параметр агрегатной функции.</p>

<p class=MsoNormal style='text-indent:0cm'>13) Ознакомиться с использованием предложения
GROUP BY, продемонстрировать его работу.</p>

<p class=MsoNormal style='text-indent:0cm'>14) Ознакомиться с использованием
предложения HAVING, продемонстрировать его работу.</p>

<p class=MsoNormal style='text-indent:0cm'>15) Модифицировать приложение,
полученное в результате выполнения лабораторной работы №2 с целью получения
информации, удовлетворяющей условиям выборки. Получить результат агрегатной
функции, указанной в варианте задания.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<h2>3.4.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Варианты
заданий</h2>

<p class=MsoNormal>Вариант задания (таблица 3.1) выбирается по формуле (<span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>mod</span> 24)+1, где <span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span>–
последние две цифры&nbsp; зачетной книжки студента.&nbsp; В варианте указано:
номер структуры данных (структуры данных приведены в приложении 1), имя
таблицы, поле фильтра, поле группировки данных, агрегатная функция.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таблица 3.1 – Варианты заданий к лабораторной работе №3</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ структуры, имя таблицы</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поле фильтра</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поле группировки</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Агрегатная функция</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Публикация</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Заглавие</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тип</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Последняя дата для данного типа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2. Курс</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Название курса</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер преподавателя</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество курсов у препод.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>3. Операция</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Название операции</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер патента</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество операций</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>4. Личность</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>ФИО</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Пол</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Самый старший каждого пола</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>5. Помещение</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Адрес</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер фирмы</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Максимальная площадь</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>6. Служащий</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Код профессии</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Число служ. по профессиям</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>7. Труд. </p>
  <p class=MsoNormal style='text-indent:0cm'>Деятельность</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер служ.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тип события</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Кол-во событий каждого типа</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;page-break-inside:avoid;height:12.0pt'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>8. Студент</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер группы</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
  EN-US'>Max</span>. Стипендия в каждой группе</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>9. Экзамен</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Наименов. ВУЗа</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Код специальности</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Средняя оценка</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>10. Поезд</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Маршрут</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Станция отправления</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Мин. Время прибытия</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>11. Преподава-тель</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Должность</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Кол-во преподав. в должности</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>12. Персона</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Пол</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Среднее кол-во детей </p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>13. Результат соревнований</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Название команды</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер соревнования</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Максим. число забитых мячей </p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14;mso-yfti-lastrow:yes'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>14. Концертный зал</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Адрес</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество мест</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Число залов </p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Таблица 3.1 (продолжение)</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ структуры, имя таблицы</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поле фильтра</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поле группировки</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Агрегатная функция</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>15. Сотрудник</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ф.И.О.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Пол</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество сотрудников</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>16. Перевозка</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Место назначения</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Дата</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Средняя цена</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>17. Гостиница</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Адрес</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Разряд</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество гостиниц</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>18. Курс лечения</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Метод лечения</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер диагноза</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Средняя стоимость</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>19. Комплект.</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Наименован.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер машины</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Макс. Стоимость</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>20. Газета</p>
  </td>
  <td width=95 valign=top style='width:70.9pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Наименован.</p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Тираж</p>
  </td>
  <td width=113 valign=top style='width:3.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Мин. Кол-во сотрудников</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2>3.5.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание
отчета</h2>

<p class=MsoNormal>Отчет должен содержать цель полное описание действий
студента по созданию базы данных, ввода, коррекции и удаления полей. Обязательно
должны быть указаны фактические значения (по варианту задания), вводимые в
диалоговые окна. Описание программы должно включать список форм, компонентов,
перечень предопределяемых свойств компонентов. Отчет состоит из титульного
листа, цели работы, описания процесса выполнения работы и вывода.</p>

<p class=MsoBodyText>&nbsp;</p>

<h2>3.6.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные
вопросы</h2>

<h2><span lang=EN-US style='mso-ansi-language:EN-US;font-weight:normal'>&nbsp;</span></h2>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Опишите основные конструкции языка <span lang=EN-US style='mso-ansi-language:
EN-US'>SQL</span>, использованные в лабораторной работе <span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>DISTINCT</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>WHERE</span>, <span lang=EN-US
style='mso-ansi-language:EN-US'>IN</span>,&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>BETWEEN</span>,&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>LIKE</span>.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>2) Каким образом
можно добавить поле в существующую таблицу, внести значения в существующие
записи для этого поля по умолчанию?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Как ввести в запрос на выборку вычисляемое поле?</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Для чего используются агрегатные функции. Что является аргументом агрегатной
функции. Перечислите агрегатные функции языка SQL.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
С какой целью используются предложения GROUP BY и HAVING?</p>

<p class=MsoNormal>&nbsp;</p>

<h2>3.7.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Рекомендации
по выполнению работы</h2>

<p class=MsoNormal>&nbsp;</p>

<h3>3.7.1.<span style='font-size:7.0pt'> </span>Агрегатные функции <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span></h3>

<p class=MsoNormal style='text-indent:35.45pt'><span style='color:black'>Агрегатные
функции – это функции, которые работают не с одним значением, взятым из строки
таблицы, а с группой значений. Например, рассмотрим таблицу, в которой хранится
информация о продажах товаров:</span></p>

<p class=MsoNormal style='text-indent:35.45pt'><span style='color:black'>&nbsp;</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=372
 style='width:279.0pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Дата
  продажи</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>№ товара</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Группа
  товара</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Цена
  покупки</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>11.12.89</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10.00</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>11.12.89</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>20</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>11.12.89</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>15</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>12.12.89</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>100</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=104 valign=top style='width:78.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>12.12.89</span></p>
  </td>
  <td width=75 valign=top style='width:56.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2</span></p>
  </td>
  <td width=99 valign=top style='width:74.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1</span></p>
  </td>
  <td width=93 valign=top style='width:70.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>50</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='margin-left:18.0pt'><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='color:black'>Группировать
поля таблицы можно многими способами. Например, можно сгруппировать продажи по
дням, тогда сумма поля «Цена покупки» даст общую выручку по дням. Группируя по номеру
товара, и суммируя по тому же полю получим сумму продаж товара с таким-то
номером за все дни. Группируя таблицу по группам товара, получим сумму покупок
всех товаров данной группы за все дни. В нашем примере мы вычисляем сумму от
некоторой группы, сумма в данном случае – агрегатная функция. Группировать
можно не только по одному полю, но и по нескольким.</span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='color:black'>В
случае, если запрос использует агрегатные функции, то в списке полей, которые
выводит запрос, могут быть только поля – аргументы агрегатных функций. Все
остальные поля обязательно должны быть перечислены в предложении </span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>GROUP</span><span
lang=EN-US style='color:black'> </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>BY</span><span style='color:black'> (см. ниже). </span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='color:black'>Общий
алгоритм, по которому работают агрегатные функции следующий: сначала таблица
упорядочивается по тем полям, по которым осуществляется группировка; затем от каждой
сформированной группы вычисляется требуемое значение, которое и заносится в
результат.</span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='color:black'>Существуют
следующие агрегатные функции:</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>COUNT считает количество строк, которые вернул
запрос;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>SUM суммирует значения данного поля;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>AVG находит среднее значение поля;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>MAX находит максимальное значение поля;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>MIN находит минимальное значение поля.</span></p>

<p class=MsoNormal><a name="_Toc1384244"><b><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></b></a></p>

<p class=MsoNormal><b>Тестовая база данных</b></p>

<p class=MsoNormal><span style='color:black'>Рассмотрим работу агрегатных функций
на примере базы данных, состоящий из трех таблиц – «Торговый агент»,
«Покупатель», «Сделка». Таблица «Торговый агент» (</span><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>Salespeople</span><span
style='color:black'>) содержит следующие столбцы:</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>SNUM – номер агента;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>SNAME – имя агента;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>CITY – город, где работает агента;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>COMM – комиссионные торгового агента.</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left'><span style='color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Торговый агент (</span><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>Salespeople</span><span style='color:black'>)</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>SNUM</span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>SNAME</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>CITY</span></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>COMM</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1001</span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Peel</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>London</span></st1:place></st1:City></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>0.12</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1002</span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Serres</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>San Jose</span></st1:place></st1:City><span
  lang=EN-US style='color:black;mso-ansi-language:EN-US'> </span></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>0.13</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1004 </span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Motika</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>London</span></st1:place></st1:City></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>0.11</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1007 </span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Rifkin</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>Barcelona</span></st1:place></st1:City></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>0.15</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1003</span></p>
  </td>
  <td width=78 valign=top style='width:58.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Axelrod</span></p>
  </td>
  <td width=90 valign=top style='width:67.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:State><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>New York</span></st1:place></st1:State></p>
  </td>
  <td width=73 valign=top style='width:54.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>0.10</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>Таблица «Покупатель» состоит из
следующих столбцов:</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>CNUM&nbsp; – номер покупателя;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>CNAME – имя покупателя;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>CITY&nbsp; – город проживания покупателя;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>RATING – некоторый рейтинг, присвоенный
покупателю;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>SNUM – номер торгового агента, за которым
закреплен покупатель.</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Заказчики (</span><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>Customers</span><span
style='color:black'>)</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>CNUM</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>CNAME</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>CITY</span></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>RATING</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>SNUM</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2001</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Hoffman</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>London</span></st1:place></st1:City></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>100</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1001</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2002</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Giovanni</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>Rome</span></st1:place></st1:City></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>200</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1003</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2003</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Liu</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>SanJose</span></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>200</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1002 </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2004</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Grass</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:State><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>Berlin</span></st1:place></st1:State></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>300</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1002 </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2006</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Clemens</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><st1:City><st1:place><span
    lang=EN-US style='color:black;mso-ansi-language:EN-US'>London</span></st1:place></st1:City></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>100</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>1001 </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>2008</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>Cisneros</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>SanJose</span></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>300</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1007 </span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2007</span></p>
  </td>
  <td width=82 valign=top style='width:61.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Pereira</span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Rome</span></p>
  </td>
  <td width=83 valign=top style='width:62.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>100</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1004 </span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>Таблица «Заказ» (</span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>Orders</span><span
style='color:black'>) содержит следующие столбцы:</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>ONUM – номер заказа;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>AMT – сумма заказа;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>ODATE – дата&nbsp; заказа;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>CNUM – номер покупателя;</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'><span
style='color:black'>-</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>SNUM – номер торгового агента.</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Сделка (</span><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>Orders</span><span
style='color:black'>)</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>ONUM</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>AMT</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>ODATE</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>CNUM</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='color:
  black;mso-ansi-language:EN-US'>SNUM</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3001</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>18.69</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2008</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1007</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3003</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>767.19</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2001</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3002</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1900.10</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2007</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1004</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3005</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>5160.45</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2003</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1002</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3006</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1098.16</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2008</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1007</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3009</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1713.23</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/04/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2002</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1003</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3007</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>75.75</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/04/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2004</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1002</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3008</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>4723.00</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/05/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2006</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3010</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1309.95</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/06/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2004</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1002</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;mso-yfti-lastrow:yes'>
  <td width=71 valign=top style='width:53.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3011</span></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>9891.88</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/06/1990</span></p>
  </td>
  <td width=70 valign=top style='width:52.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2006</span></p>
  </td>
  <td width=69 valign=top style='width:51.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoToc1><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc1384245"><b>Примеры</b></a></p>

<p class=MsoNormal><span style='color:black'>Чтобы найти сумму всех покупок в
таблице «Сделки», мы можем ввести следующий запрос:</span></p>

<p class=MsoNormal style='text-indent:35.4pt'><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>SELECT SUM</span></b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'> ((<i>amt</i>)) <b>FROM </b><i>Orders</i>;
</span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoToc1><span style='color:black'>Результат его выполнения – число
26658.4</span></p>

<p class=MsoNormal><span style='color:black'>Запрос «<b>SELECT AVG </b>(<i>amt</i>)
<b>FROM </b><i>Orders</i>;» вернет среднее значение сумм сделок -2665.84.</span></p>

<p class=MsoNormal><a name="_Toc1384246"><b><i>Функция COUNT</i></b></a></p>

<p class=MsoNormal><span style='color:black'>Функция COUNT отличается от других
агрегатных функций тем, что она не выполняет математических действий над
значением столбца. Она считает число значений в данном столбце, или число строк
в таблице. Если необходимо подсчитать количество различных значений некоторого
поля в таблице, функцию COUNT надо использовать с DISTINCT. Например, чтобы
подсчитать количество продавцов в настоящее время описанных в таблице сделок,
мы можем использовать следующий запрос:</span></p>

<p class=MsoNormal style='text-indent:35.4pt'><b><span style='color:black'>&nbsp;</span></b><b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>SELECT COUNT </span></b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>( <b>DISTINCT</b> <i>snum
</i>) <b>FROM </b><i>Orders</i>;</span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Результат – 5.</span></p>

<p class=MsoNormal><span style='color:black'>Иногда возникает необходимость
решить обратную задачу – подсчитать количество значений поля вместе с
повторениями. Для этого существует описатель </span><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>ALL</span><span lang=EN-US
style='color:black'> </span></b><span style='color:black'>(он подразумевается
по умолчанию). Например:</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;&nbsp; </span><b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>SELECT COUNT</span></b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'> ( <b>ALL</b> <i>rating</i>
) <b>FROM</b> <i>Customers</i>;</span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Подсчитает количество повторений
поля rating с повторениями.</span></p>

<p class=MsoNormal><span style='color:black'>Чтобы подсчитать общее число строк
в таблице, используйте функцию COUNT со звездочкой вместо имени поля, как,
например, в следующем примере.</span></p>

<p class=MsoNormal style='text-indent:35.4pt'><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>SELECT COUNT </span></b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>(<i>*</i>) <b>FROM </b><i>Customers</i>;</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Результат</span><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'> – 7.</span><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Внимание! Только <b>COUNT </b>(<i>*</i>)<b>
</b>может подсчитывать значения </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>NULL</span><span style='color:black'>. Все остальные
функции игнорируют неопределенные значения.</span></p>

<h2 style='margin-left:0cm;text-indent:35.45pt'><a name="_Toc1384247"><span
style='color:black'>Простые вычисления</span></a></h2>

<p class=MsoNormal><span style='color:black'>Столбцы, значение которых может
быть получено с помощью простых арифметических действий через другие столбцы в
БД, как правило, не хранятся. </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>SQL</span><span style='color:black'> предоставляет
простой способ производить подобные вычисления. Также можно помещать в
некоторый столбец константу. Например, чтобы представить комиссионные торгового
агента в процентном отношении, а не в виде десятичного числа можно записать
такой запрос:</span></p>

<p class=MsoNormal><b><span style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SELECT </span></b><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>snum, sname, city, comm</span></i><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>*100 <b>FROM </b><i>Salespeople </i><b>FROM </b><i>Salespeople</i>;</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>&nbsp;</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Можно дополнить наш запрос знаком
процента, выводимым после поля <i>comm</i>*100:</span></p>

<p class=MsoNormal><b><span style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SELECT</span></b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'> <i>snum, sname, city</i>, <i>comm</i>*100, ' % ' <b>FROM </b><i>Salespeople</i>;</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>&nbsp;</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:black'>Знак процента в данном случае –
константное выражение. При выполнении вычислений в запросе допустимы
арифметические действия – сложение, вычитание, умножение, деление.</span></p>

<p class=MsoNormal><a name="_Toc1384248"><b><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></b></a></p>

<p class=MsoNormal><b>Вычисления в агрегатных функциях</b></p>

<p class=MsoNormal><span style='color:black'>Допустим, мы хотим вывести 10% от
стоимости самой дорогой сделки. Тогда можно записать такой запрос:</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SELECT</span><span lang=EN-US style='color:black'> </span></b><b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>MAX</span></b><span
style='color:black'> (</span><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>amt</span><span style='color:black'>*0.1) </span><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>FROM</span></b><span lang=EN-US
style='color:black'> </span><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>Orders</span></i><span style='color:black'>;</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>Таким образом можно выполнять
вычисления с использованием других полей и арифметических действий. Вложение агрегатов
не допускается.</span></p>

<h2 style='margin-left:0cm;text-indent:35.45pt'><a name="_Toc1384249"><span
style='color:black'>Использование </span></a><span style='mso-bookmark:_Toc1384249'></span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>GROUP</span><span
lang=EN-US style='color:black'> </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>BY</span></h2>

<p class=MsoNormal><span style='color:black'>Как уже было упомянуто ранее,
таблицу можно группировать самыми разными способами. В случае, если мы не
группируем таблицу вообще, в списке вывода запроса присутствуют только
агрегатные функции. Таблица в этом случае рассматривается целиком. В случае,
если мы группируем таблицу по какому-то полю, в списке вывода могут
присутствовать те поля, относительно которых таблица группируется и агрегатные
функции. При этом все поля, не охваченные агрегатными функциями, должны быть
перечислены в предложении </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>GROUP</span><span lang=EN-US style='color:black'> </span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>BY</span><span
style='color:black'>. </span></p>

<p class=MsoNormal><span style='color:black'>Предположим, что мы хотим найти
сделку с максимальной стоимостью для каждого торгового агента. Можно сделать
персональный запрос для каждого из них, выбрав MAX(amt) из таблицы сделок.
Можно записать следующий запрос:</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SELECT</span><span lang=EN-US style='color:black'> </span></b><i><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>snum</span></i><span
style='color:black'>, </span><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>MAX</span><span lang=EN-US style='color:black'> </span></b><span
style='color:black'>(</span><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>amt</span></i><span style='color:black'>) </span><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>FROM</span><span lang=EN-US
style='color:black'> </span></b><i><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>Orders</span><span lang=EN-US style='color:black'> </span></i><b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>GROUP</span><span
lang=EN-US style='color:black'> </span></b><b><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>BY</span><span lang=EN-US
style='color:black'> </span></b><i><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>snum</span></i><span style='color:black'>;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Результат
выполнения запроса:</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>snum</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>767.19</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1002</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1713.23</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1003</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>75.75</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1014</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1309.95</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td width=57 valign=top style='width:42.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1007</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1098.16 </span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>В данном случае таблица группируется
относительно номера торгового агента, поэтому поле <i>snum </i>присутствует в
списке вывода запроса и в предложении GROUP BY.</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc1384250"><b>Использование HAVING</b></a></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-ansi-language:EN-US'>HAVING</span><span
style='color:black'> подобен </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>WHERE</span><span style='color:black'> – он задает
условия отбора групп так же, как это делает </span><span lang=EN-US
style='color:black;mso-ansi-language:EN-US'>WHERE</span><span style='color:
black'> для строк. Например, если мы хотим узнать, какие торговые агенты имеют
заработок от одной сделки более чем 3000, и в какой день, можно использовать
следующий запрос:</span></p>

<p class=MsoNormal><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SELECT </span></b><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>snum, odate</span></i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>, <b>MAX </b>((<i>amt</i>)) </span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>FROM </span></b><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>Orders</span></i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'> </span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>GROUP BY </span></b><i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>snum, odate</span></i><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'> </span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>HAVING</span><span lang=EN-US style='color:black'> </span></b><b><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>MAX</span><span
lang=EN-US style='color:black'> </span></b><span style='color:black'>((</span><i><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>amt</span></i><span
style='color:black'>)) &gt; 3000.00;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Результат
работы запроса:</span></p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=60 valign=top style='width:44.85pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>Snum</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>odate</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>------</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=60 valign=top style='width:44.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/05/1990</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>4723.00</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=60 valign=top style='width:44.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1001</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/06/1990</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>9891.88</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=60 valign=top style='width:44.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1002</span></p>
  </td>
  <td width=95 valign=top style='width:71.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>10/03/1990</span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span style='color:black'>5160.45 </span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>Внимание! В предложении HAVING
нельзя проверять имена полей на какое-либо условие – для этого существует </span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US'>WHERE</span><span
style='color:black'>. То, что вы проверяете в HAVING должно иметь только одно
значение для группы.</span></p>

<p class=MsoNormal>&nbsp;</p>

<h3>3.7.2.<span style='font-size:7.0pt'> </span>Использование условий выборки и
агрегатных функций <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>
в клиентском приложении</h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Для того, чтобы проиллюстрировать работу оператора <span
lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span>, модифицируем
структуру таблицы PHONE. Добавим дополнительное поле тип телефона (<span
lang=EN-US style='mso-ansi-language:EN-US'>PHONETYPE</span>) и модифицируем
данные таблицы. Эту операцию можно выполнить посредством оболочки <span
lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Expert</span> (рисунок 3.1) или с
помощью операторов <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ALTER TABLE
PHONE<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ADD
PHONETYPE VARCHAR(15) CHARACTER SET WIN1251 <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>COLLATE
WIN1251<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>UPDATE
PHONE SET PHONETYPE = '</span>Домашний<span lang=EN-US style='mso-ansi-language:
EN-US'>'<o:p></o:p></span></p>

<p class=MsoNormal><img border=0 width=367 height=282 id="_x0000_i1041"
src="musubd.files/image016.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Рисунок 3.1 – Добавление нового поля в таблицу <span
lang=EN-US style='mso-ansi-language:EN-US'>Phone</span><span lang=EN-US> </span>посредством
оболочки <span lang=EN-US style='mso-ansi-language:EN-US'>IB</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Expert</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>В результате ввода данных получаем таблицу, представленную
на рисунке 3.2.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=239
id="_x0000_i1042" src="musubd.files/image017.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 3.2 – Модифицированная
таблица «Телефонный справочник»</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Необходимо
отметить, что полученное отношение не является нормализованным и, как
следствие, имеют место аномалии добавления, удаления и обновления.</b>&nbsp;
Действительно, если необходимо добавить рабочий телефон Сергея Паршина&nbsp;
нам придется дублировать содержимое полей Ф.И.О. и дата рождения. В базе данных
не может содержаться информация о человеке, у которого нет телефона. При
изменении паспортных данных нам человека необходимо будет поменять информацию в
нескольких строках таблицы. Для исключения аномалий выполняется операция декомпозиции
отношения, которая будет рассмотрена в следующей лабораторной работе.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Модифицируем приложение-клиент, разработанное в ходе лабораторной работы
№2.Прежде всего добавим поле редакции типа телефона <span lang=EN-US
style='mso-ansi-language:EN-US'>CBType</span>:<span lang=EN-US
style='mso-ansi-language:EN-US'>TComboBox</span>. Заполним поле <span
lang=EN-US style='mso-ansi-language:EN-US'>Items</span><span lang=EN-US> </span>возможными
вариантами: «рабочий», «домашний», «мобильный» и модифицируем тексты процедур
обработчиков событий BtAddClick, В<span lang=EN-US style='mso-ansi-language:
EN-US'>tUpdateClick</span>, <span lang=EN-US style='mso-ansi-language:EN-US'>BtDeleteClick</span><span
lang=EN-US> </span>и <span lang=EN-US style='mso-ansi-language:EN-US'>DBGridCellClick</span><span
lang=EN-US> </span>для адекватной работы программной системы.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp; Следует заметить,
что содержимое таблицы выдается в том порядке, в каком записи поступали в базу
данных, что затрудняет поиск информации (рисунок 3.3). </p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=317
id="_x0000_i1043" src="musubd.files/image018.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 3.3 – Главная форма проекта
с возможностью ввода/коррекции типа телефона</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Для
сортировки записей таблицы по содержимому полей &nbsp;добавим в проект
обработчик события <span lang=EN-US style='mso-ansi-language:EN-US'>onTitleClick</span><span
lang=EN-US> </span>компонента <span lang=EN-US style='mso-ansi-language:EN-US'>DBGrid</span>.</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TForm1.DBGridTitleClick(Column: TColumn);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>var cn : string;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; cn:=Column.FieldName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.Transaction.Commit;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.SQL.Add('SELECT * FROM PHONE ORDER BY '+cn);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>end;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>Теперь при нажатии на заголовок
столбца данные таблицы сортируются в порядке возрастания его значений.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Поиск
информации в таблице станет удобней, если в ней будут выведены не все записи, а
только те, которые удовлетворяют условию поиска (например, первым буквам
Ф.И.О.). Добавим в проект компонент ChBFiltr:TCheckBox и строку ввода условия
отбора EdFilter: TEdit. Обработоем<span style='mso-ansi-language:EN-US'> </span>событие<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>onClick </span></span>компонента<span
style='mso-ansi-language:EN-US'> <span lang=EN-US>ChBFilter.<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TForm1.ChBFiltrClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>var</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>fn</span> : <span lang=EN-US style='mso-ansi-language:EN-US'>string</span>;</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin</span><span lang=EN-US> </span>&nbsp;//определение имени поля, по
которому следует сортировать </p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>fn:=DBGrid.SelectedField.FieldName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;DataModule2.IBQuery.Transaction.Commit;
DataModule2.IBQuery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>Выбираем<span style='mso-ansi-language:EN-US'> </span>данные<span
style='mso-ansi-language:EN-US'> </span>из<span style='mso-ansi-language:EN-US'>
</span>таблицы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.SQL.Add('SELECT * FROM PHONE');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; if (chbFiltr.Checked) and (EdFilter.Text&lt;&gt;'') then //</span>Если<span
style='mso-ansi-language:EN-US'> </span>свойство<span style='mso-ansi-language:
EN-US'> <span lang=EN-US>checked </span></span>установлено<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>есть<span style='mso-ansi-language:EN-US'> </span>образец<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>поиска<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
DataModule2.IBQuery.SQL.Add('WHERE FIO LIKE &quot;'+EdFilter.Text+'%&quot; ');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>//</span>задаем<span style='mso-ansi-language:EN-US'> </span>порядок<span
style='mso-ansi-language:EN-US'> </span>сортировки<span style='mso-ansi-language:
EN-US'> </span>значениий<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.SQL.Add(' ORDER BY '+fn);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.IBQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>end;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Заметим, что этот же обработчик
целесообразно использовать для обработки события <span lang=EN-US
style='mso-ansi-language:EN-US'>onChange</span><span lang=EN-US> </span>компонента
EdFilter. Результат работы модифицированного приложения показан на рисунке 3.4.</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=395 height=227
id="_x0000_i1044" src="musubd.files/image019.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок 3.4 – Работа приложения с
фильтром записей</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Разработаем интерфейс для исследования работы оператора <span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT</span>. &nbsp;Поместим на новую форму
компоненты&nbsp;&nbsp;&nbsp;&nbsp; DBGrid1: TDBGrid,&nbsp;&nbsp;&nbsp;
BtDistinct: TButton,&nbsp;&nbsp;&nbsp; BtCount: TButton,&nbsp;&nbsp;&nbsp;
BTHaving: TButton. Добавим на форму <span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>2 два компонента для работы с
данными:&nbsp;&nbsp;&nbsp; SelectQuery: TIBQuery, DataSourceSel: TDataSource.
Установим свойство <span lang=EN-US style='mso-ansi-language:EN-US'>DataSourceSel</span>.<span
lang=EN-US style='mso-ansi-language:EN-US'>DataSet</span><span lang=EN-US> </span>&nbsp;в
значение <span lang=EN-US style='mso-ansi-language:EN-US'>SelectQuery</span>.</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-US> </span>Обработчик
события <span lang=EN-US style='mso-ansi-language:EN-US'>BtDistinct</span><span
lang=EN-US> </span>реализует запрос «Вывести всех абонентов телефонной книги
без повторения имен».</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>procedure TSelectForm.BtDistinctClick(Sender: TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.SelectQuery.Active:=false;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.SelectQuery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.SelectQuery.SQL.Add('SELECT DISTINCT FIO FROM PHONE
ORDER BY FIO');<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp; DataModule2.SelectQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>end;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'>Аналогичным<span style='mso-ansi-language:
EN-US'> </span>образом<span style='mso-ansi-language:EN-US'> </span>создаем<span
style='mso-ansi-language:EN-US'> </span>обработчики<span style='mso-ansi-language:
EN-US'> </span>событий<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>реализации<span style='mso-ansi-language:
EN-US'> </span>запросов<span style='mso-ansi-language:EN-US'> </span>типа<span
lang=EN-US style='mso-ansi-language:EN-US'> «</span>Вывести<span
style='mso-ansi-language:EN-US'> </span>количество<span style='mso-ansi-language:
EN-US'> </span>номеров<span style='mso-ansi-language:EN-US'> </span>каждого<span
style='mso-ansi-language:EN-US'> </span>абонента<span lang=EN-US
style='mso-ansi-language:EN-US'> (SELECT&nbsp; FIO, Count(*) FROM PHONE GROUP
BY FIO ORDER BY FIO), </span>вывести<span style='mso-ansi-language:EN-US'> </span>имена<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>количество<span style='mso-ansi-language:EN-US'> </span>телефонов<span
style='mso-ansi-language:EN-US'> </span>абонентов<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>имеющих<span lang=EN-US
style='mso-ansi-language:EN-US'> 2 </span>и<span style='mso-ansi-language:EN-US'>
</span>более<span style='mso-ansi-language:EN-US'> </span>номеров<span
lang=EN-US style='mso-ansi-language:EN-US'> (SELECT&nbsp; FIO, Count(*) FROM
PHONE GROUP BY FIO&nbsp; HAVING (Count(*)&gt;=2) ORDER BY FIO). </span>Результат
работы приложения показан на рисунке 3.5.</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=157
id="_x0000_i1045" src="musubd.files/image020.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;&nbsp; Рисунок 3.5 – Результат
запроса «вывести имена и количество телефонов абонентов, имеющих 2 и более
номеров».</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h1><a name="_Toc163231768">4.</a><span style='mso-bookmark:_Toc163231768'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №4. «ССЫЛОЧНАЯ ЦЕЛОСТНОСТЬ ДАННЫХ. СОЗДАНИЕ СХЕМЫ БАЗЫ ДАННЫХ»</span></h1>

<h2>4.1.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель
работы:</h2>

<p class=MsoNormal>. Ознакомиться с принципами построения схемы базы данных и
обеспечения целостности данных в базе.</p>

<h2>4.2.<span lang=EN-US style='font-size:7.0pt;mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:7.0pt'> </span>Введение</h2>

<p class=MsoNormal><span style='color:black;layout-grid-mode:line'>Свое
название реляционные базы данных получили именно по той причине, что таблицы в
БД не существуют независимо друг от друга. Таблицы взаимосвязаны друг с другом,
т.е. действие, произведенное в одной таблице, вызовет некоторые действия в
другой таблице. Существует три основных класса связей между таблицами: один к
одному (1:1), один ко многим (1:М), и многие ко многим (М:М). На практике связи
первого типа используются редко. Связи третьего типа не реализуются в РБД
напрямую, одну связь многие ко многим приводят к двум связям один ко многим. </span></p>

<h2>4.3.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика
выполнения работы</h2>

<p class=MsoNormal>1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Проанализировать схему БД
своего варианта задания (вариант то же, что и в лабораторной работе №2),
выделить и классифицировать все существующие связи, определить необходимые
ограничения целостности. </p>

<p class=MsoNormal>2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Создать все еще не
созданные таблицы, изменить существующие таким образом, чтобы они могли
участвовать в связях (описание ALTER TABLE см. в приложении Б).</p>

<p class=MsoNormal>3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; В процессе создания таблиц
установить связи между таблицами.</p>

<p class=MsoNormal>4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Составить запросы на ввод
данных в главную и подчиненную таблицу. Проверить работу ограничений на
значения первичного ключа обеих таблиц и внешнего ключа подчиненной таблицы.</p>

<p class=MsoNormal>5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Составить запросы на
обновление и удаление данных для проверки работы ограничений целостности связей
между таблицами. Проверить работу ограничений целостности в случаях установки
каскадирования и запрета удаления и обновления данных.</p>

<p class=MsoNormal>6) Разработать приложение для визуализации и коррекции
данных&nbsp; содержимого 2-х взаимосвязанных таблиц в соответствии с вариантом
задания.</p>

<p class=MsoNormal>&nbsp;</p>

<h2>4.4.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Варианты
заданий</h2>

<p class=MsoNormal>Вариант задания (таблица 4.1) выбирается по формуле (<span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>mod</span> 24)+1, где <span
lang=EN-US style='mso-ansi-language:EN-US'>N</span><span lang=EN-US> </span>–
последние две цифры&nbsp; зачетной книжки студента.&nbsp; В варианте указано:
номер структуры данных и имена взаимосвязанных таблиц для&nbsp; клиентского
приложения..</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таблица 4.1 – Варианты заданий к лабораторной работе №4</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ структуры</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Имя таблицы 1</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Имя таблицы 2</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Публикация</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Автор</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Курс</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>3</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Операция</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Хирург</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>4</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Личность</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Ребенок</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>5</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Помещение</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Фирма</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>6</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Служащий</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Профессия</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>7</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Трудовая деятельность</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Служащий</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;page-break-inside:avoid;height:12.0pt'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>8</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Студент</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>Специальность</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>9</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Экзамен</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Предмет</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>10</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Поезд</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Рейс</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>11</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Преподаватель</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Факультет</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>12</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Персона</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Персона_Дело</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>13</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Результат соревнований</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Команда</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>14</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Концертный зал</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Концерт</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>15</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Сотрудник</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Фирма</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>16</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Перевозка</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Машина</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>17</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Гостиница</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Фирма</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>18</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Курс лечения</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Диагноз</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>19</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Комплектующие</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Машина</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20;mso-yfti-lastrow:yes'>
  <td width=92 valign=top style='width:69.2pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>20</p>
  </td>
  <td width=180 valign=top style='width:134.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Партия</p>
  </td>
  <td width=161 valign=top style='width:120.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Партиец</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2>4.5.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание
отчета</h2>

<p class=MsoNormal><span style='color:black'>Отчет должен содержать следующие
разделы:</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>1) Цель
работы.</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>2)
Выполнение работы: </span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- концептуально-логическая
схема базы данных согласно варианту,</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- <span
style='layout-grid-mode:line'>список связей между объектами (сущностями) БД с
описанием каждой связи (тип связи (1:1, 1:М), главная таблица и подчиненная,
поля, участвующие в связи (внешний ключ подчиненной таблицы, первичный ключ
главной таблицы) и ограничения целостности для этих полей (допустимость </span></span><span
lang=EN-US style='color:black;mso-ansi-language:EN-US;layout-grid-mode:line'>Null</span><span
style='color:black;layout-grid-mode:line'>-значений), идентифицирующая или
неидентифицирующая связь),</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- тексты
запросов на создание таблиц с соответствующими первичными и внешними ключами и
заданными условиями целостности связей (каскадирование обновления, удаления или
запрет), сформулированные на естественном языке и&nbsp;&nbsp; структурированном
языке запросов </span><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>SQL</span><span style='color:black'>, </span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- данные
таблиц, участвующих в запросах на обновление и удаление данных, </span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- тексты
запросов на удаление и обновление данных из главной таблицы, участвующей в
связи 1:М, сформулированные на естественном языке и&nbsp;&nbsp;
структурированном языке запросов </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>SQL</span><span style='color:black'>, </span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>-
результаты выполнения запросов на удаление и обновление данных для главной и
подчиненной таблицы, участвующей в связи 1:М в случае каскадирования и запрета.</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>- описание
программы и экранной формы для визуализации и редактирования данных двух
взаимосвязанных таблиц</span></p>

<p class=MsoNormal style='text-indent:0cm'><span style='color:black'>3) Выводы.</span></p>

<p class=MsoNormal>&nbsp;</p>

<h2>4.6.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные
вопросы</h2>

<p class=MsoNormal>1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Что понимается под объектом
(сущностью) БД.</p>

<p class=MsoNormal>2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Охарактеризуйте возможные
типы связей между сущностями.</p>

<p class=MsoNormal>3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Используя
концептуально-логическую схему БД для своего варианта, приведите пример замены
связи типа М:М двумя связями 1:М за счет введения в БД дополнительной таблицы.</p>

<p class=MsoNormal>4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Какие связи между объектами
являются идентифицирующими, а какие нет?</p>

<p class=MsoNormal>5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Как задаются связи между
таблицами на языке SQL?</p>

<p class=MsoNormal>6)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Сформулируйте ограничения
целостности, которые накладываются на значения поля (совокупности полей),
являющегося первичным ключом реляционной таблицы и поля (совокупности полей),
являющегося внешним ключом.</p>

<p class=MsoNormal>7)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Какие возможности контроля
целостности связей поддерживаются СУБД? Охарактеризуйте процессы ввода,
обновления и удаления данных в главной и подчиненной таблице в каждом случае.</p>

<p class=MsoNormal>&nbsp;</p>

<h2>4.7.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Рекомендации
по выполнению работы</h2>

<h3>4.7.1.<span style='font-size:7.0pt'> </span>Понятие сущности, связи и
целостности базы данных</h3>

<p class=MsoNormal>Связь вида 1:М в реляционных СУБД используется наиболее
часто, поэтому ее мы рассмотрим наиболее подробно.</p>

<p class=MsoNormal>&nbsp;&nbsp; Пусть мы имеем две таблицы следующего вида:</p>

<p class=MsoNormal>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Клиент&nbsp;
(Номер_клиента, ФИО_клиента, Счет_клиента)</p>

<p class=MsoNormal>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Продажи
(Номер_клиента, Наименование_товара, Количество_товара)</p>

<p class=MsoNormal>Таблицы связанны отношением 1:М, т.е. один клиент может
совершить много покупок, каждая покупка совершается только одним клиентом. В
таблицах хранятся следующие данные:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Клиент</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер_клиента</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>ФИО_клиента</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Счет_клиента</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Сидоров И.И.</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1923563</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Петров А.Б.</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1736523</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>3</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Федоров Н.Г.</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>9265623</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; Продажи</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Номер_клиента</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Наименование_товара</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Количество_товара</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Шоколад «Корона»</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Шейки Куринные</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1,5</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=121 valign=top style='width:90.45pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2</p>
  </td>
  <td width=169 valign=top style='width:126.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Крупа манная</p>
  </td>
  <td width=145 valign=top style='width:108.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>3</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Очевидно, что поле «Номер_клиента» в обеих таблицах имеет
одинаковый смысл - оно обозначает номер, присвоенный клиенту. В случае если таблицы
не имеют связи друг с другом, ничего не мешает нам добавить в таблицу «Продажи»
строку, например, (8, «Хлеб белый»,1), несмотря на то, что в таблице «Клиент»
нет покупателя с номеров 8. Это нарушение целостности данных, так как такая
строка может быть занесена, но она не соответствует действительности. Чтобы
подобная ситуация стала невозможной, необходимо установить связь между
таблицами по полю «Номер_клиента». В этом случае сервер БД автоматически
проследит, чтобы поле «Номер_клиента» из вставляемой строки существовало в
таблице «Клиенты».</p>

<p class=MsoNormal>Подобной проверки достаточно, чтобы условие целостности
данных выполнялось при добавлении данных в таблицы. Но его недостаточно при
манипулировании данными. Рассмотрим ситуацию, когда мы удаляем из таблицы
«Клиент» некоторую запись, например клиента с номером 1. В случае если таблицы
не связанны, удаление клиента повлечет за собой изменение только одной таблицы.
В таблице «Продажи» останутся сведения о покупках покупателя с номером 1. Такая
ситуация - также нарушение целостности данных, так как о данном покупателе,
после его удаления, базе данных ничего не известно. В случае если таблицы
связанны, удаление покупателя может повлечь за собой удаление всех его покупок
(говорят, что удаление каскадируется).</p>

<p class=MsoNormal>Такая же ситуация с модификацией данных в родительской
таблице. Если покупатель с номером 1 изменил номер на 5, то в связанных
таблицах изменение родительской таблицы повлечет за собой автоматическое
изменение дочерних таблиц.</p>

<p class=MsoNormal>Кроме арности связи и ограничений целостности различают
также идентифицирующие и не идентифицирующие связи. С помощью идентифицирующей
связи устанавливается взаимосвязь между зависимыми сущностями (клиент и его
покупки). Не идентифицирующая связь устанавливает взаимосвязь между
независимыми сущностями (автомобиль и его цвет). Разница между идентифицирующей
и не идентифицирующей связью состоит в том, что при идентифицирующей связи
внешний ключ является частью первичного ключа дочерней сущности, а при не
идентифицирующей связи внешний ключ не входит в первичный ключ дочерней
сущности. Идентифицирующая связь изображается непрерывной линией, не
идентифицирующая - пунктирной. </p>

<p class=MsoNormal>Последнее, о чем осталось упомянуть - это о допустимости
NULL значений во внешнем ключе. Например, если сущности &quot;Работник&quot; и
&quot;Загранпаспорт&quot; связаны не идентифицирующей связью 1:М таким образом:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'>Работник </p>

<p class=MsoNormal style='text-indent:0cm'>(Номер_Работника, ФИО_работника,
Номер_загранпаспорта(FK))</p>

<p class=MsoNormal style='text-indent:0cm'>Загранпаспорт </p>

<p class=MsoNormal style='text-indent:0cm'>(Номер_загранпаспорта, Дата_выдачи,
Срок_действия)</p>

<p class=MsoNormal style='text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal>Т.е. каждый работник может иметь ноль, один или несколько
загранпаспортов.</p>

<p class=MsoNormal>Поле &quot;Номер_загранпаспорта&quot; в таблице
&quot;Работники&quot; является внешним ключом из таблицы
&quot;Загранпаспорт&quot;. Не у каждого работника есть загранпаспорт. Если его
нет, в поле &quot;Номер_загранпаспорта&quot; подставляется NULL. Это пример не
идентифицирующей связи, допускающей значение NULL.</p>

<p class=MsoNormal>Примером связи, не допускающей неопределенные значения,
является связь между родителем и ребенком. Не бывает ребенка без родителя. В
таблице &quot;Ребенок&quot; поле &quot;Номер_родителя&quot; должно быть
определено обязательно.</p>

<p class=MsoNormal>Допустимость NULL-значений связи на диаграмме указывается
ромбиком.</p>

<p class=MsoNormal>Связь таблиц в реляционной БД устанавливается при создании
таблиц с помощью описателя FOREIGEN KEY.</p>

<p class=MsoNormal>Приведем также пояснения к стандартной нотации ER-диаграмм, в
которой представлены варианты к лабораторной работе.</p>

<p class=MsoNormal><b>&nbsp;</b></p>

<p class=MsoNormal><b>Сущности</b></p>

<p class=MsoNormal>Сущность изображается прямоугольником, над которым пишется
имя сущности. Одна сущность соответствует одной таблице. Прямоугольник разделяется
линией на две части. В верхней части указываются ключевые атрибуты. После имени
атрибута могут стоять символы, уточняющие назначение атрибута. Допустимые
символы:</p>

<p class=MsoNormal>- PK - первичный ключ</p>

<p class=MsoNormal>- AK - альтернативный ключ</p>

<p class=MsoNormal>- FK - внешний ключ</p>

<p class=MsoNormal>- IE - inversion entry, говорит о том, что по данному полю
должен быть создан &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
индекс.</p>

<p class=MsoNormal><b>Связи</b></p>

<p class=MsoNormal>Связь между двумя отношениями изображается с помощью линии.
Идентифицирующая связь изображается сплошной линией, не идентифицирующая -
пунктирной. Арность связи указывается следующим образом: со стороны
&quot;многие&quot; ставится жирная точка, со стороны &quot;один&quot; точка не
ставится. Допустимость Null -значений изображается ромбиком с той стороны
связи, где позволяются Null -значения.</p>

<p class=MsoNormal><b>Категории</b></p>

<p class=MsoNormal>В случае, если у нас есть некоторая общая сущность (например
– люди), и необходимо хранить информацию о некоторых разновидностях данной
сущности (например – родители и дети, мужчины и женщины, работающие и
безработные и т.д.) имеет место понятие категории. Поясним на примере.
Допустим, нам необходимо хранить следующую информацию о родителях и детях:</p>

<p class=MsoNormal>Родитель(Номер, ФИО, Адрес, Образование)</p>

<p class=MsoNormal>Ребенок(Номер, ФИО, Адрес, Номер_детского_садика)</p>

<p class=MsoNormal>ЯвляетсяРебенком(Номер_родителя, Номер_ребенка)</p>

<p class=MsoNormal>Схема данных:</p>

<p class=MsoNormal>Родитель ------- 1:М -------&gt; Ребенок</p>

<p class=MsoNormal>Очевидно, что для ребенка поле «Образование» не имеет
смысла, как и поле «Номер_детского_садика» для родителя. Кроме того, в случае,
если подобную информацию хранить в виде двух таблиц, то возникает дублирование
информации и проблемы с целостностью данных. Например, адрес ребенка совпадает
с адресом родителей, и если данные вводятся вручную, то можно ввести адрес
ребенка отличный от адреса родителя. </p>

<p class=MsoNormal>Подобная проблема решается следующим образом: вводится
обобщающая категория «Личность», в нее выносятся общие поля из двух дочерних
таблиц. Дочерние таблицы привязываются к родительской связью один к одному.
Пример:</p>

<p class=MsoNormal>&nbsp;&nbsp; Личность (Номер, ФИО);</p>

<p class=MsoNormal>&nbsp;&nbsp; Родитель (Номер, Адрес, Образование);</p>

<p class=MsoNormal>&nbsp;&nbsp; Ребенок (Номер, Номер_детского_садика);</p>

<p class=MsoNormal>&nbsp;&nbsp; ЯвляетсяРебенком(Номер_родителя, Номер_ребенка)</p>

<p class=MsoNormal>Схема:</p>

<p class=MsoNormal>&nbsp;&nbsp; Родитель --------1:1--------&gt;
Личность&lt;--------1:1-------- Ребенок</p>

<p class=MsoNormal>Для того, чтобы добавить данные о ребенке, нужно занести
данные в две таблицы – «личность» и «ребенок». Например:</p>

<p class=MsoNormal>&nbsp;&nbsp; ISERT INTO Личность VALUES (2,‘Иванов И.И.’)</p>

<p class=MsoNormal>&nbsp;&nbsp; ISERT INTO Ребенок VALUES (2,‘д/с №23’)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Нумерация в таблицах сквозная! На схеме категориальная связь
изображается так, как показано на рисунке 4.1.</p>

<p class=MsoNormal><img border=0 width=393 height=232 id="_x0000_i1046"
src="musubd.files/image021.gif"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Рисунок 4.1 – Категориальная связь между сущностями базы
данных</p>

<p class=MsoNormal>&nbsp;</p>

<h3>4.7.2.<span style='font-size:7.0pt'> </span>Визуализация и коррекция данных
взаимосвязанных таблиц из клиентского приложения</h3>

<p class=MsoNormal>Продолжим рассмотрение примера «Телефонный справочник». При
рассмотрении примера к предыдущей лабораторной работе (п.3.7.2)&nbsp; было
отмечено, что спроектированное отношение имеет недопустимые с точки зрения
теории баз данных аномалии добавления, включения и удаления.</p>

<p class=MsoNormal>Используя процедуру Кода [1] построения инфологической
модели выделим основные сущности предметной области (рисунок 4.2).</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=110
id="_x0000_i1047" src="musubd.files/image022.gif"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Рисунок 4.2 – Диаграмма сущность-связь предметной области
«Телефонный справочник»</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Для связи между отношениями и идентификации личности удобно
использовать ключевое поле «Код личности». При этом в отношении «Личность» это
поле является первичным ключом, а в отношении «Телефон» - внешним ключом.</p>

<p class=MsoNormal>Введем новые отношения в базе данных <span lang=EN-US
style='mso-ansi-language:EN-US'>test</span>.<span lang=EN-US style='mso-ansi-language:
EN-US'>gdb</span>. </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CREATE
TABLE PERSONA (&nbsp; P_ID INTEGER NOT NULL,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
FIO VARCHAR(50) CHARACTER SET WIN1251,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
BDATE DATE)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CREATE
TABLE PNUMBER (&nbsp;&nbsp;&nbsp; P_ID&nbsp;&nbsp; INTEGER NOT NULL,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
PNUM&nbsp;&nbsp; VARCHAR(10) NOT NULL, PTYPE&nbsp; VARCHAR(20));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Сформируем&nbsp; ограничения, обеспечивающие целостность
базы данных.Создание&nbsp; нового первичного ключа в отношении <span
lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span><span lang=EN-US> </span>показано
на рисунке 4.3.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img border=0 width=411 height=171 id="_x0000_i1048"
src="musubd.files/image023.jpg"></p>

<p class=MsoNormal>Рисунок 4.3 – Создание нового первичного ключа</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>На языке <span lang=EN-US style='mso-ansi-language:EN-US'>SQL</span><span
lang=EN-US> </span>аналогичное действие описывается предложением:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>alter table
PERSONA add constraint PK_PERSONA primary key (P_ID)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>В отношении <span lang=EN-US style='mso-ansi-language:EN-US'>PNUMBER</span><span
lang=EN-US> </span>обозначим внешний ключ <span lang=EN-US style='mso-ansi-language:
EN-US'>FK</span>_<span lang=EN-US style='mso-ansi-language:EN-US'>PNUMBER</span>,
предназначенный для связи двух таблиц (рисунок 4.4).</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=420 height=122
id="_x0000_i1049" src="musubd.files/image024.jpg"></p>

<p class=MsoNormal style='text-indent:0cm'>Рисунок<span lang=EN-US
style='mso-ansi-language:EN-US'> 4.4 – </span>Создание<span style='mso-ansi-language:
EN-US'> </span>внешнего<span style='mso-ansi-language:EN-US'> </span>ключа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:0cm'><span lang=EN-US style='mso-ansi-language:
EN-US'>alter table PNUMBER add constraint FK_PNUMBER foreign key (P_ID)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>references
PERSONA(P_ID) on delete CASCADE;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Правило удаления «<span lang=EN-US style='mso-ansi-language:
EN-US'>CASCADE</span>» означает, что при удалении записи из отношения <span
lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span><span lang=EN-US> </span>все
связанные с ней записи из отношения <span lang=EN-US style='mso-ansi-language:
EN-US'>PNUMBER</span><span lang=EN-US> </span>удаляются автоматически.</p>

<p class=MsoNormal>Разработаем клиентское приложение, позволяющее
автоматизировать процесс заполнения телефонного справочника. &nbsp;За основу
возьмем приложение, разработанное в лабораторной работе №2.</p>

<p class=MsoNormal>Экранная форма, содержащая список абонентов будет иметь вид,
показанный на рисунке 4.5.</p>

<p class=MsoNormal><img border=0 width=355 height=247 id="_x0000_i1050"
src="musubd.files/image025.jpg"></p>

<p class=MsoNormal>Рисунок 4.5 – Список абонентов (экранная форма)</p>

<p class=MsoNormal>Так как данные теперь будут извлекаться из таблицы <span
lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span><span lang=EN-US> </span>модифицируем
запрос&nbsp; в компоненте <span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2.<span
lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span>:</p>

<p class=MsoNormal>SELECT * FROM PERSONA</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Соответственно изменятся предложения языка <span lang=EN-US
style='mso-ansi-language:EN-US'>SQL</span><span lang=EN-US> </span>для
выполнения операций удаления, вставки и обновления записей.</p>

<p class=MsoNormal>Фрагмент программного кода для добавление новой записи:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.SQL.Add('insert
into persona (p_id,fio,bdate)');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
workquery.SQL.Add('VALUES (:p_id, :newfio,:newbdate)');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Генерация<span
style='mso-ansi-language:EN-US'> </span>ключа<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
workquery.ParamByName('p_id').AsInteger:=Random(High(integer));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Перенос<span
style='mso-ansi-language:EN-US'> </span>информации<span style='mso-ansi-language:
EN-US'> </span>из<span style='mso-ansi-language:EN-US'> </span>полей<span
style='mso-ansi-language:EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
workquery.ParamByName('newfio').AsString:=EdFIO.Text;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
workquery.ParamByName('newbdate').AsDate:=DTP.Date;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>В отличие от предыдущих лабораторных работ в таблицу <span
lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span><span lang=EN-US> </span>введен
первичный ключ <span lang=EN-US style='mso-ansi-language:EN-US'>P</span>_<span
lang=EN-US style='mso-ansi-language:EN-US'>ID</span>, который служит для
идентификации личности и связи с таблицей <span lang=EN-US style='mso-ansi-language:
EN-US'>PNUMBER</span>. Чтобы избежать ввод ключа вручную используются 2
подхода:</p>

<p class=MsoNormal>1) создание ключа с помощью генератора случайных чисел, так
же как это сделано для генерации <span lang=EN-US style='mso-ansi-language:
EN-US'>GUID</span><span lang=EN-US> </span>в <span lang=EN-US style='mso-ansi-language:
EN-US'>COM</span>-объектах. Именно этот способ используется в приведенном выше
фрагменте программы;</p>

<p class=MsoNormal>2) использование генератора ключа средствами СУБД. Создание
триггеров и генераторов будет рассмотрено в лабораторной работе №6.</p>

<p class=MsoNormal>За счет введения уникального ключевого поля значительно
упрощаются процедуры удаления и обновления:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Удаление<span
style='mso-ansi-language:EN-US'> </span>записи<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.SQL.Add('delete
from persona WHERE (p_id=:p_id)');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.ParamByName('p_id').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('p_id').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Обновление<span
style='mso-ansi-language:EN-US'> </span>записи<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.SQL.Add('update
persona set fio=:newfio, <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
bdate=:newbdate');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.SQL.Add('WHERE
(p_id=:p_id)');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.ParamByName('p_id').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('p_id').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.ParamByName('newfio').AsString:=EdFIO.Text;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>workquery.ParamByName('newbdate').AsDate:=DTP.Date;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>На невизуальной форме <span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>2 разместим компонент для реализации запросов
телефонных номеров <span lang=EN-US style='mso-ansi-language:EN-US'>NumQuery</span>.&nbsp;
Для получения списка номеров выбранного клиента используется предложение <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT</span>
* <span lang=EN-US style='mso-ansi-language:EN-US'>FROM</span><span lang=EN-US>
</span><span lang=EN-US style='mso-ansi-language:EN-US'>PNUMBER</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>P</span>_<span
lang=EN-US style='mso-ansi-language:EN-US'>ID</span>=:<span lang=EN-US
style='mso-ansi-language:EN-US'>P</span>_<span lang=EN-US style='mso-ansi-language:
EN-US'>ID</span></p>

<p class=MsoNormal>Параметр :<span lang=EN-US style='mso-ansi-language:EN-US'>P</span>_<span
lang=EN-US style='mso-ansi-language:EN-US'>ID</span><span lang=EN-US> </span>должен
быть сформирован перед активизацией запроса. Запрос должен активироваться
каждый раз, когда пользователь перемещает указатель в таблице <span lang=EN-US
style='mso-ansi-language:EN-US'>PERSONA</span>. Для автоматизации этой операции
можно использовать событие <span lang=EN-US style='mso-ansi-language:EN-US'>AfterScroll</span><span
lang=EN-US> </span>компонента <span lang=EN-US style='mso-ansi-language:EN-US'>IBQuery</span>:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>procedure
TDataModule2.IBQueryAfterScroll(DataSet: TDataSet);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;
NumQuery.Active:=false;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;NumQuery.ParamByName('P_ID').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('P_ID').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;
NumQuery</span>.<span lang=EN-US style='mso-ansi-language:EN-US'>Active</span>:=<span
lang=EN-US style='mso-ansi-language:EN-US'>true</span>;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>end</span>;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таким образом, каждый раз при смене текущей записи в таблице
<span lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span> будет
изменяться выборка телефонов клиента.</p>

<p class=MsoNormal>Для связи с компонентом визуализации данных <span
lang=EN-US style='mso-ansi-language:EN-US'>DBGrid</span><span lang=EN-US> </span>дополним
содержимое <span lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2
еще одним компонентом <span lang=EN-US style='mso-ansi-language:EN-US'>DataSourceNum</span>:<span
lang=EN-US style='mso-ansi-language:EN-US'>TDataSource</span>.</p>

<p class=MsoNormal>Разработаем форму для вывода и редакции номеров телефонов
(рисунок 4.6).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=170
id="_x0000_i1051" src="musubd.files/image026.jpg"></p>

<p class=MsoNormal>Рисунок 4.6 – Экранная форма для вывода номеров телефонов</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Логика функционирования интерфейса данной экранной формы во
многом повторяет логику работы главной формы. Приведем пример реализации
операции добавления нового номера телефона.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>procedure</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>TNumEditForm</span>.<span
lang=EN-US style='mso-ansi-language:EN-US'>BtAddClick</span>(<span lang=EN-US
style='mso-ansi-language:EN-US'>Sender</span>: <span lang=EN-US
style='mso-ansi-language:EN-US'>TObject</span>);</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; with
DataModule2 do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;
begin<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:28.4pt;text-indent:0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>NumQuery.Active:=false; //</span>деактивизируем<span
lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; </span>запрос<span
style='mso-ansi-language:EN-US'> </span>вывода<span style='mso-ansi-language:
EN-US'> <span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//</span>номеров<span style='mso-ansi-language:EN-US'> </span>абонента<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
WorkNumQuery.SQL.Clear;<o:p></o:p></span></p>

<p class=MsoNormal>//Создаем запрос для добавления новой записи</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>WorkNumQuery.SQL.Add('INSERT INTO PNUMBER <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(p_id,pnum,ptype) VALUES (:p_id,:pnum,:ptype)');<o:p></o:p></span></p>

<p class=MsoNormal>//Идентификатор абонента получаем из таблицы <span
lang=EN-US style='mso-ansi-language:EN-US'>PERSONA</span></p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:
EN-US'>WorkNumQuery.ParamByName('p_id').AsInteger:=<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IBQuery.FieldByName('p_id').AsInteger;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Заполняем<span
style='mso-ansi-language:EN-US'> </span>информационные<span style='mso-ansi-language:
EN-US'> </span>поля<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
WorkNumQuery.ParamByName('pnum').AsString:=NumEdit.Text;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
WorkNumQuery.ParamByName('ptype').AsString:=CBPType.Text;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>//</span>Выполняем<span
style='mso-ansi-language:EN-US'> </span>запрос<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
try<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WorkNumQuery.ExecSQL;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WorkNumQuery.Transaction.Commit;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
except<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
showmessage('</span>Ошибка<span style='mso-ansi-language:EN-US'> </span>выполнения<span
style='mso-ansi-language:EN-US'> </span>операции<span lang=EN-US
style='mso-ansi-language:EN-US'>');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WorkNumQuery.Transaction.Rollback;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
end;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;
NumQuery.Active:=true;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp; </span>end;</p>

<p class=MsoNormal>end;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Как следует из текста программы, на форму <span lang=EN-US
style='mso-ansi-language:EN-US'>DataModule</span>2 добавлен компонент <span
lang=EN-US style='mso-ansi-language:EN-US'>WorkNumQuery</span><span lang=EN-US>
</span>для выполнения рабочих запросов к таблице <span lang=EN-US
style='mso-ansi-language:EN-US'>Pnumber</span>. Введение дополнительного
компонента неслучайно. При выполнении этой процедуры без изменений <span
lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2 проявляется
крайне неприятный эффект: запрос <span lang=EN-US style='mso-ansi-language:
EN-US'>IBQuery</span><span lang=EN-US> </span>закрывается при выполнении
операции <span lang=EN-US style='mso-ansi-language:EN-US'>WorkNumQuery</span>.<span
lang=EN-US style='mso-ansi-language:EN-US'>Transaction</span>.<span lang=EN-US
style='mso-ansi-language:EN-US'>Commit</span>. Действительно, оба запроса
используют один компонент управления транзакциями <span lang=EN-US
style='mso-ansi-language:EN-US'>MainTransaction</span>. Завершение транзакции
после добавления телефонного номера приводит к завершению транзакции запроса
списка абонентов. В результате оператор <span lang=EN-US style='mso-ansi-language:
EN-US'>NumQuery</span>.<span lang=EN-US style='mso-ansi-language:EN-US'>Active</span>:=<span
lang=EN-US style='mso-ansi-language:EN-US'>true</span> выполняется с ошибкой,
так как значение <span lang=EN-US style='mso-ansi-language:EN-US'>P</span>_<span
lang=EN-US style='mso-ansi-language:EN-US'>ID</span><span lang=EN-US> </span>не
определено.</p>

<p class=MsoNormal>Для разрешения конфликта можно использовать два подхода:</p>

<p class=MsoNormal>1) активизировать запрос <span lang=EN-US style='mso-ansi-language:
EN-US'>IBQuery</span><span lang=EN-US> </span>перед выполнением запроса <span
lang=EN-US style='mso-ansi-language:EN-US'>NumQuery</span>. При этом&nbsp;
необходимо принудительно установить указатель на абонента, для которого
выполнялась операция добавления телефонного номера;</p>

<p class=MsoNormal>2) разделить транзакции для запросов <span lang=EN-US
style='mso-ansi-language:EN-US'>IBQuery</span><span lang=EN-US> </span>и <span
lang=EN-US style='mso-ansi-language:EN-US'>NumQuery</span>. </p>

<p class=MsoNormal>Второй подход по многим причинам является наиболее
предпочтительным. Поэтому на форму <span lang=EN-US style='mso-ansi-language:
EN-US'>DataModule</span>2 помещается дополнительный компонент <span lang=EN-US
style='mso-ansi-language:EN-US'>NumTransaction</span>, который в свою очередь
используют компоненты <span lang=EN-US style='mso-ansi-language:EN-US'>NumQuery</span>,
и <span lang=EN-US style='mso-ansi-language:EN-US'>WorkNumQuery</span>
(Рисунок&nbsp; 4.7).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img border=0 width=314 height=333 id="_x0000_i1052"
src="musubd.files/image027.jpg"></p>

<p class=MsoNormal>Рисунок 4.7 – Модифицированная форма <span lang=EN-US
style='mso-ansi-language:EN-US'>DataModule</span>2</p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='text-align:justify'>&nbsp;</h1>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h1><a name="_Toc163231769">5.</a><span style='mso-bookmark:_Toc163231769'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №5. «СЛОЖНЫЕ ЗАПРОСЫ К БАЗЕ ДАННЫХ. ЗАПРОСЫ НА ОСНОВЕ НЕСКОЛЬКИХ ТАБЛИЦ.
КОРРЕЛИРОВАННЫЕ ВЛОЖЕННЫЕ ПОДЗАПРОСЫ»</span></h1>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></p>

<h2>5.1.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель
работы:</h2>

<p class=MsoNormal>&nbsp;- изучить способы получения информации из нескольких
таблиц</p>

<p class=MsoNormal>-&nbsp; записать запросы, демонстрирующие выборки из
нескольких таблиц с использованием оператора join и без него</p>

<p class=MsoNormal>-&nbsp; изучить способы выполнения и принцип действия
рекурсивных запросов</p>

<p class=MsoNormal>-&nbsp; научится использовать вложенные подзапросы</p>

<p class=MsoNormal>-&nbsp; ознакомиться с возможностями построения вложенных
коррелированных подзапросов с применением кванторов.</p>

<h2>5.2.<span lang=EN-US style='font-size:7.0pt;mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:7.0pt'> </span>Введение</h2>

<p class=MsoNormal>Запросы к нескольким таблицам являются наиболее часто
используемым типом запросов. Существует два основных способа объединения таблиц
– с помощью оператора JOIN языка SQL, и с помощью условия в разделе WHERE.</p>

<h2>5.3.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика
выполнения работы</h2>

<p class=MsoNormal>1. Записать запросы, соединяющие две таблицы с помощью JOIN
и без него.</p>

<p class=MsoNormal>2. Записать запросы, соединяющие более чем две таблицы с
помощью JOIN и без него.</p>

<p class=MsoNormal>3. Продемонстрировать следующие возможности SQL:</p>

<p class=MsoNormal>-&nbsp; использование псевдонимов на примере рекурсивного запроса.</p>

<p class=MsoNormal>-&nbsp; привести пример запроса с подзапросом</p>

<p class=MsoNormal>-&nbsp; использование агрегатных функций в подзапросе</p>

<p class=MsoNormal>-&nbsp; подзапросы, возвращающие единственное и
множественные значения</p>

<p class=MsoNormal>-&nbsp; подзапросы, использующие вычисление</p>

<p class=MsoNormal>-&nbsp; использование подзапросов в HAVING</p>

<p class=MsoNormal>4. Ознакомится с принципом и продемонстрировать работу
коррелированных подзапросов: </p>

<p class=MsoNormal>-&nbsp; привести пример соединения таблицы со своей копией; </p>

<p class=MsoNormal>-&nbsp; привести пример коррелированного запроса,
использующего две разные таблицы; </p>

<p class=MsoNormal>-&nbsp; привести пример запроса с оператором EXIST; </p>

<p class=MsoNormal>-&nbsp; привести пример запроса с&nbsp; оператором ALL; </p>

<p class=MsoNormal>-&nbsp; привести пример запроса с&nbsp; оператором ANY.</p>

<p class=MsoNormal>5. Модифицировать приложение лабораторной работы №4.
Добавить окно для вывода результатов запроса в видео отчета <span lang=EN-US
style='mso-ansi-language:EN-US'>QuickReport</span>. </p>

<h2>5.4.<span lang=EN-US style='font-size:7.0pt;mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:7.0pt'> </span>Варианты заданий</h2>

<p class=MsoNormal>Варианты структуры базы данных совпадают с вариантами к
лабораторной работе №4. В работе необходимо предусмотреть интерфейс в виде
отчета для вывода по крайней мере трех результатов сложных запросов в
соответствии с таблицей вариантов 5.1.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Таблица 5.1 – Варианты заданий к лабораторной работе №5</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ вар</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Запросы к базе данных</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести Ф.И.О. всех авторов,
  писавших на тему «Локальные вычислительные сети».</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести любого автора,&nbsp;
  который печатался в журнале «Микропроцессорные системы».</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. автора самой
  последней (по дате) публикации.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>2</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех студентов,
  слушающих курс «СУБД».</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести&nbsp; преподавателей,
  не имеющих своего курса.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О.
  преподавателя,&nbsp; который провел последнее (по дате) занятие.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>3</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех пациентов хирурга
  Иванова.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех хирургов, которые
  ведут хотя бы одного пациента.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. самого старшего
  пациента.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>4</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех служащих, имеющих
  высшее образование.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести Ф.И.О. сотрудников,
  которые не имеют детей.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. самого молодого
  мужчины.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>5</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести все телефоны фирмы
  «Оптима Крым»</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести названия фирмы, которая
  не имеет контрагентов</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название фирмы,
  занимающей помещение с максимальной площадью</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>6</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести Ф.И.О. служащих,
  работающих над проектом «Победа»</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести названия работ, в
  которых задействованы программисты</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести минимальную тарифную
  ставку</p>
  </td>
 </tr>
</table>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>Таблица 5.1 (продолжение)</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>№ вар</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>Запросы к базе данных</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>7</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех служащих,
  говорящих на английском языке</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести Ф.И.О. служащих,
  которые не были в отпуске в 2007 г.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. служащего с
  максимальным окладом</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:12.0pt'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>8</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:12.0pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести Ф.И.О. студентов
  факультета АВТ</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести Ф.И.О. студентов, которые
  не изучают&nbsp; программирование.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. студентов,
  получающих максимальную стипендию</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>9</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести название ВУЗов,
  осуществляющих подготовку по специальности «компьютерные сети».</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести Ф.И.О. студентов,
  которые не сдали ни одного экзамена.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название специальности
  с минимальным сроком обучения.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>10</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех пассажиров поезда
  № 28 «Севастополь-Киев», выехавших 29.01.2007</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести все поезда, которые не
  следуют через станцию «Джанкой»</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести время отправления
  первой (по времени) электрички «Севастополь-Симферополь».</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>11</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести все предметы, которые
  изучают на факультете АВТ</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех преподавателей,
  которые не преподают на факультете АВТ.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название предметов с
  максимальным количеством часов.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>12</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех осужденных,
  проходящих по делу №26.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех осужденных,
  которые не имеют псевдонима.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести Ф.И.О. осужденного на
  максимальный срок</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>13</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех спортсменов,
  игравших во Франции.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех спортсменов,
  которые не играют в Динамо (Киев).</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести список лучших
  бомбардиров (забивших максимальное количество мячей).</p>
  </td>
 </tr>
</table>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>Таблица 5.1 (продолжение)</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=432
 style='width:324.35pt;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>14</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех артистов,
  выступивших в «Доме офицеров» 31.12.2006.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех артистов, которые
  не выступали в «Альбервил-холле».</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название зала с
  максимальным количеством мест.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>15</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех сотрудников
  строительных фирм.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести всех сотрудников, у
  которых нет детей</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести сотрудников с максимальным
  окладом</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>16</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести всех водителей,
  возивших грузы более 10 тонн.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести Ф.И.О. любого водителя,
  который водит КАМАЗ.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название груза
  максимальной массы.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>17</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести Ф.И.О. клиентов
  гостиницы «Крым».</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести гостинцы, в которых нет
  номеров «Люкс».</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести все гостиницы
  максимального разряда.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>18</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести все препараты для
  лечения гриппа.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести список диагнозов, для
  которых существует нетрадиционный метод лечения.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести диагноз с минимальной
  стоимостью лечения.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>19</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести инженеров,
  обслуживающих машины типа <span lang=EN-US style='mso-ansi-language:EN-US'>Pentium</span><span
  lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>IV</span></p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести название адрес
  ВЦ,&nbsp; в которых нет машин типа <span lang=EN-US style='mso-ansi-language:
  EN-US'>Macintosh</span>.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести список инженеров с
  минимальным окладом</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes'>
  <td width=36 valign=top style='width:26.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>20</p>
  </td>
  <td width=397 valign=top style='width:297.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'>1. Вывести сумму партвзносов,
  полученных партией «Зеленых» в 2006 году.</p>
  <p class=MsoNormal style='text-indent:0cm'>2. Вывести все партии, которые
  имеют свою газету.</p>
  <p class=MsoNormal style='text-indent:0cm'>3. Вывести название газеты с
  максимальным тиражем.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2>5.5.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание
отчета</h2>

<p class=MsoNormal><span style='color:black'>Отчет должен содержать следующие
разделы:</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='color:black'>1)</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>Цель работы.</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='color:black'>2)</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>Выполнение работы (таблицы исходных данных,
тексты запросов в соответствии заданием, сформулированные на естественном языке
и структурированном языке запросов </span><span lang=EN-US style='color:black;
mso-ansi-language:EN-US'>SQL</span><span style='color:black'>, результаты
выполнения запросов)</span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'><span
style='color:black'>3)</span><span style='font-size:7.0pt;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='color:black'>Выводы.</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:0cm'><span
style='color:black'>Примечание.- Запросы должны иметь логический смысл. Без
формулировки запросов на естественном языке отчет приниматься не будет. </span></p>

<h2>5.6.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные
вопросы</h2>

<p class=MsoNormal>1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; В чем различие соединения
таблиц по условию и с использованием JOIN?</p>

<p class=MsoNormal>2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; В чем различие вложенных
запросов и запросов с соединением?</p>

<p class=MsoNormal>3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Какие формы записи
подзапроса недопустимы?</p>

<p class=MsoNormal>4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; В чем особенность
подзапроса, перед которым стоит знак арифметического сравнения?</p>

<p class=MsoNormal>5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Что такое коррелированный
подзапрос?</p>

<p class=MsoNormal>6)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Опишите алгоритм выполнения
запроса с коррелированным подзапросом.</p>

<p class=MsoNormal>7)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Назначение операторов
EXIST, ALL, ANY.</p>

<p class=MsoNormal>8) Что такое отчет? Какие средства среды <span lang=EN-US
style='mso-ansi-language:EN-US'>Delphi</span><span lang=EN-US> </span>(<span
lang=EN-US style='mso-ansi-language:EN-US'>C</span>++ <span lang=EN-US
style='mso-ansi-language:EN-US'>Builder</span>) используются для создания
отчетов?</p>

<p class=MsoNormal>&nbsp;</p>

<h2>5.7.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Рекомендации
по выполнению работы</h2>

<p class=MsoNormal>Запросы к нескольким таблицам являются наиболее часто
используемым типом запросов. Реляционные БД нормализованы, и хранимая
информация разбита по большому количеству таблиц. </p>

<p class=MsoNormal>&nbsp;</p>

<h3>5.7.1.<span style='font-size:7.0pt'> </span>Простое объединение двух таблиц</h3>

<p class=MsoNormal>Существует два основных способа объединения таблиц – с
помощью оператора JOIN языка SQL, и с помощью условия в разделе WHERE.
Например, объединить таблицу Customers и таблицу Salespeople по полю city можно
следующим образом:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Customers.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople.sname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople.city
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople,
Customers <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE <o:p></o:p></span></p>

<p class=MsoNormal>Salespeople.city = Customers.city;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Для выполнения данного запроса сервер произведет декартово
произведение двух таблиц, после чего выполнит операцию селекции нужных строк,
затем – проекцию нужных полей. Декартово произведение – это операция, которая
требует для своего выполнения максимальное количество памяти и процессорного
времени, по сравнению с другими известными операциями. Данный способ
неэффективен.</p>

<p class=MsoNormal>&nbsp;&nbsp; В случае, если мы используем оператор JOIN,
запрос будет выглядеть так:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Customers.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople.sname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople.city
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Salespeople
JOIN Customers ON Salespeople.city = Customers.city;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
</span>В данном случае сервер БД не будет производить декартово произведение,
сервер воспользуется индексами для определения совпадающих значений поля city,
выберет строки с совпадающими значениями, а затем произведет проекцию. Данная
операция происходит на порядок быстрее. В случае, если по полям учавствующим в
соединении, не создан индекс, сервер вынужден производить декартово
произведение. </p>

<p class=MsoNormal>&nbsp;&nbsp; Можно сделать следующие выводы: </p>

<p class=MsoNormal>-&nbsp; если объединение таблиц происходит по ключам,
выгоднее использовать JOIN;</p>

<p class=MsoNormal>-&nbsp; если запрос выполняется медленно, нужно создать
индекс по полю – параметру объединения (CREATE INDEX)</p>

<p class=MsoNormal>&nbsp;</p>

<h3>5.7.2.<span style='font-size:7.0pt'> </span>Объединение более чем двух
таблиц</h3>

<p class=MsoNormal>&nbsp;&nbsp; Объединение более чем двух таблиц по форме не
отличается от простого объединения. Например, чтобы объединить три таблицы по
некоторому условию, можно записать:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
onum, cname, Orders.cnum, Orders.snum <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM
Salespeople, Customers, Orders <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Customers.city
&lt;&gt; Salespeople.city AND <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Orders.cnum
= Customers.cnum AND <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Orders.snum
= Salespeople.snum;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Тот же запрос, переписанный с использованием JOIN, выглядит
более сложно:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
onum, cname, Orders.cnum, Orders.snum <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM
(Orders JOIN Customers ON Orders.cnum = Customers.cnum) JOIN Salespeople ON
Orders.snum = Salespeople.snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Customers.city
&lt;&gt; Salespeople.city AND <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<h3>5.7.3.<span style='font-size:7.0pt'> </span>Псевдонимы и рекурсивные
объединения</h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; На практике часто встречается ситуация, когда необходимо
объединять таблицу саму с собой. Запрос, выполняющий такое объединение,
называется рекурсивным. Например, если мы хотим вывести все пары студентов с
одинаковым рейтингом, можно записать следующий запрос:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>second.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.rating
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Students
first, <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Students
second <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.rating
= second.rating;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Здесь в списке вывода SELECT указываются поля cname и rating
таблицы first, и поле cname таблицы second. В разделе FROM указывается, что
first и second – просто псевдонимы для таблицы Students. Для выполнения запроса
сервер создаст две копии таблицы Students, одну с именем first, другую с именем
second, выполнит запрос так, как будто это две разные таблицы, и уничтожит
копии. Естествнно, сервер физически не создает копий таблиц, но с псевдонимами
в запросе он работает так, будто это две разные таблицы.</p>

<p class=MsoNormal>Можно заметить, что вывод запроса будет повторять каждую
пару дважды&nbsp; - сначала «Иванов - Петров», затем «Петров - Иванов». Кроме
того, вывод содержит строки «Иванов -&nbsp; Иванов», «Петров - Петров». Это
происходит потому, что сервер берет первую строку из первого псевдонима и
сравнивает ее со всеми строками из второго псевдонима. Будут выбраны
строки&nbsp; «Иванов -&nbsp; Иванов» и «Иванов - Петров». Затем он переходит к следующей
строке и снова сравнивает ее со всеми строками из второго псевдонима, и так
далее. Будут выбраны строки «Петров - Иванов» и «Петров - Петров».</p>

<p class=MsoNormal>&nbsp;&nbsp; Чтобы избежать дубликатов, надо наложить еще
одно условие, налагающие отношение порядка на сравниваемые строки. Например<span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>сравнивать<span
style='mso-ansi-language:EN-US'> </span>имена<span lang=EN-US style='mso-ansi-language:
EN-US'>.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>SELECT <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>second.cname,
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.rating
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>FROM <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Students
first, <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Students
second <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>WHERE <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.rating
= second.rating AND <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>first.cname
&lt; second.cname;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<h3><span lang=EN-US style='mso-ansi-language:EN-US'>5.7.4.</span><span
lang=EN-US style='font-size:7.0pt;mso-ansi-language:EN-US'> </span>Вложенные<span
style='mso-ansi-language:EN-US'> </span>подзапросы<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
</span>Вложенные подзапросы так же служат для получения информации из
нескольких таблиц. С их помощью можно выполнять рекурсивные запросы. Для чего
существует два способа сделать одно и то же действие? Дело в том, что на
практике встречаются ситуации, когда запрос выражается очень сложно через
соединения, и легко – через вложенный подзапрос, и наоборот. На конкретном
сервере БД запрос с использованием JOIN может выполняться очень долго, а с
использованием подзапроса – быстро.</p>

<p class=MsoNormal>&nbsp;&nbsp; Пример запроса с вложенным подзапросом:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
*<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Orders<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
WHERE snum =<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Salespeople<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE sname = 'Motika');<o:p></o:p></span></p>

<p class=MsoNormal>Так как подзапрос стоит после знака равенства, он должен
возвращать только одно значение. В случае, если подзапрос вернет более чем одно
значение, произойдет ошибка.</p>

<p class=MsoNormal>&nbsp;&nbsp; Обратите внимание, что при записи подзапроса
допустима следующая форма:</p>

<p class=MsoNormal>&lt;имя/константа&gt; &lt;оператор&gt; &lt;подзапрос&gt;, а
не &lt;подзапрос&gt; &lt;оператор&gt; &lt;имя/константа&gt; или &lt; подзапрос
&gt; &lt; оператор &gt; &lt; подзапрос &gt;.</p>

<p class=MsoNormal>Во вложенных подзапросах можно использовать агрегатные
функции:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
*<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Orders<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
WHERE amt &gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(SELECT AVG (amt)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;FROM Orders<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;WHERE odate = </span><st1:date Year="1990" Day="10" Month="4"><span
 lang=EN-US style='mso-ansi-language:EN-US'>10/04/1990</span></st1:date><span
lang=EN-US style='mso-ansi-language:EN-US'> );<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
</span>Ограничение на вложенный подзапрос то же самое – он должен возвращать
единственное значение. В случае, если подзапрос возвращает несколько записей,
вместо операций сравнения нужно использовать IN:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
*<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Orders<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
WHERE snum IN<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; FROM Salespeople<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; WHERE city = &quot;</span><st1:City><st1:place><span lang=EN-US
  style='mso-ansi-language:EN-US'>LONDON</span></st1:place></st1:City><span
lang=EN-US style='mso-ansi-language:EN-US'>&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal>Данный запрос более просто записывается с использованием
соединения:</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
onum, amt, odate, cnum, Orders.snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Orders, Salespeople<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
WHERE Orders.snum = Salespeople.snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>AND Salespeople.city = &quot;London&quot;;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Допустимо использовать выражение, основанное на
столбце,&nbsp; а не просто</p>

<p class=MsoNormal>сам столбец в предложении SELECT подзапроса:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
*<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
WHERE cnum =<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
&nbsp;( SELECT snum + 1000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
&nbsp;&nbsp; FROM Salespeople<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
&nbsp;&nbsp; WHERE sname = Serres );<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
</span>Также допустимы подзапросы в выражении HAVING:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp; <span lang=EN-US style='mso-ansi-language:EN-US'>SELECT
rating, COUNT ( DISTINCT cnum )<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
FROM Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
GROUP BY rating<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;
HAVING rating &gt;( SELECT AVG (rating)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE city = &quot; </span><st1:City><st1:place><span lang=EN-US
  style='mso-ansi-language:EN-US'>San Jose</span></st1:place></st1:City><span
lang=EN-US style='mso-ansi-language:EN-US'>');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<h3>5.7.5.<span style='font-size:7.0pt'> </span>Построение коррелированных
вложенных подзапросов</h3>

<p class=MsoNormal>Вложенные подзапросы и операция JOIN предоставляют большие
возможности по манипулированию данными из нескольких таблиц. Существует еще
один способ - использовать коррелированные подзапросы, он более сложен для
понимания, но в некоторых случаях позволяет формулировать запросы самым
коротким образом. Кроме того, есть некоторые вещи, доступные для соединения и
недоступные для вложенных подзапросов, и наоборот. Например, при использовании
подзапроса становятся возможным использовать агрегатные функции в предикате
запроса. При использовании объединений в выводе запроса могут участвовать поля
из всех таблиц объединения. </p>

<p class=MsoNormal>Коррелированным называется подзапрос, который использует
псевдоним таблицы определенный не во вложенном запросе, а во внешнем. При этом
вложенный запрос выполняется много раз - для каждой строки внешней таблицы.
Пусть требуется найти всех покупателей, совершивших покупки 10.03.1990. Можно
записать следующий коррелированный запрос: </p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers outer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE 10.03.1990 IN<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT odate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Orders inner<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE outer.cnum = inner.cnum );<o:p></o:p></span></p>

<p class=MsoNormal>Логика работы запроса такова: внутренний запрос производит
соединение таблицы покупателей и таблицы покупок (outer.cnum = inner.cnum). Для
тех строк, у которых условие WHERE выполняется, запрос возвращает дату покупки.
Таким образом, для каждого покупателя формируется множество дней, когда он делал
покупки. Полученное множество передается во внешний запрос. В случае, если
10.03.1990 входит в сформированное множество, внешний запрос возвращает всю
строку (*) строку из таблицы Customers. </p>

<p class=MsoNormal>Приведем процесс выполнения коррелированного подзапроса в
алгоритмической форме: </p>

<p class=MsoNormal>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Выбрать строку из
таблицы во внешнем запросе (строка-кандидат). </p>

<p class=MsoNormal>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Сохранить значения
полей строки-кандидата в псевдониме. </p>

<p class=MsoNormal>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Выполнить подзапрос.
Везде, где найдена ссылка на псевдоним из внешнего запроса, подставлять
значения из текущей строки-кандидата. Использование значения из
строки-кандидата называется внешней ссылкой. </p>

<p class=MsoNormal>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Оценить предикат
внешнего запроса на основе результатов подзапроса. Если предикат верен - строка
выбирается для вывода </p>

<p class=MsoNormal>5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Перейти на следующую
строку во внешнем запросе. </p>

<p class=MsoNormal>Конечно, подобный запрос можно гораздо легче записать другим
способом. Например<span lang=EN-US style='mso-ansi-language:EN-US'>: <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SELECT DISTINCT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers, Orders<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE Customers.cnum = Orders.cnum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>AND Orders.odate = 10.03.1990;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Более показательным является следующий пример. Пусть нам
необходимо вывести имена и номера всех продавцов которые имеют более одного
заказчика </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span lang=EN-US style='mso-ansi-language:EN-US'>SELECT snum, sname<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;FROM Salespeople main<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE 1 &lt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT COUNT (*)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE snum = main.snum );<o:p></o:p></span></p>

<p class=MsoNormal>В случае, если перед именем поля не указывается имя
псевдонима, то данное поле относится к текущему подзапросу. Таким образом, поле
snum во вложенном подзапросе относится к таблице Customers, а не к Salespeople.
В случае, если такого поля в соответствующей таблице нет, оно ищется в
подзапросе верхнего уровня. Так, если бы поле snum отсутствовало в таблице
Customers, оно относилось бы к Salespeople. </p>

<h3>5.7.6.<span style='font-size:7.0pt'> </span>Соотнесение таблицы со своей
копией </h3>

<p class=MsoNormal>Коррелированные запросы можно писать, основываясь только на
одной таблице. Данное свойство делает их незаменимыми при написании
аналитических запросов (т.е. запросов, производящих сложный анализ данных).
Например, пусть нам необходимо найти все покупки со значениями суммы покупки
выше среднего значения для каждого покупателя (т.е. надо найти все покупки
данного покупателя, найти среднюю сумму покупок, и выдать все покупки со
стоимостью выше средней): </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span lang=EN-US style='mso-ansi-language:EN-US'>SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Orders outer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE amt &gt; =<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT AVG (amt)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Orders inner<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE inner.cnum = outer.cnum );<o:p></o:p></span></p>

<p class=MsoNormal>Существуют так называемые специальные операторы SQL, они
имеют смысл только для подзапросов. Отличительная особенность специальных
операторов - они принимают подзапрос как аргумент, точно так же, как это делает
IN. </p>

<h3>5.7.7.<span style='font-size:7.0pt'> </span>Оператор (квантор) EXISTS </h3>

<p class=MsoNormal>EXISTS(Х) - булевский оператор. Он получит значение
&quot;истинна&quot;, если запрос Х вернет хоть одну строку. Допустим, нам
необходимо узнать список продавцов, у которых есть более одного покупателя </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span lang=EN-US style='mso-ansi-language:EN-US'>SELECT DISTINCT snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM Customers outer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE EXISTS<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers inner<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE inner.snum = outer.snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AND inner.cnum &lt; &gt; outer.cnum );<o:p></o:p></span></p>

<p class=MsoNormal>Для каждой строки-кандидата из внешнего запроса ( продавец,
проверяемый в настоящее время ), внутренний запрос находит строки, у которых
совпадают значения поля snum (номер продавца), но не совпадают значениея поля
cnum (номер покупателя). Если не указать DISTINCT, каждый продавец будет выбран
один раз для каждого своего заказчика. </p>

<p class=MsoNormal>На практике очень часто приходится использовать EXIST вместе
с NOT. Допустим, нам необходимо вывести список продавцов, за которыми числится только
один покупатель </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang=EN-US
style='mso-ansi-language:EN-US'>SELECT DISTINCT snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers outer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE NOT EXISTS<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
( SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers inner<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE inner.snum = outer.snum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND
inner.cnum &lt; &gt; outer.cnum );<o:p></o:p></span></p>

<p class=MsoNormal>Кроме EXISTS в подзапросах возможно использование еще двух
операторов - ANY и ALL. </p>

<h3>5.7.8.<span style='font-size:7.0pt'> </span>Оператор ANY</h3>

<p class=MsoNormal>Оператор ANY становится верным, если значение из верхнего
подзапроса совпадает по крайней мере с одним значением из вложенного
подзапроса. Например если значение - кандидат равно 1, а вложенный подзапрос
вернул {1, 2, 3}, оператор ANY станет верным (внешний запрос проверяет на
равенство). Например, если нам нужно найти всех продавцов, которые живут в тех
же городах, что и покупатели, можно записать следующий запрос: </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span lang=EN-US style='mso-ansi-language:EN-US'>SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Salespeople<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE city = ANY<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(SELECT city<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers );<o:p></o:p></span></p>

<p class=MsoNormal>Существует<span style='mso-ansi-language:EN-US'> </span>синоним<span
style='mso-ansi-language:EN-US'> </span>оператора<span lang=EN-US
style='mso-ansi-language:EN-US'> ANY - SOME. </span>Так как SQL похож на
аншлийский, то одни предложения верно звучат с ANY, другие - с SOME. Действие
операторов эквивалентно. </p>

<h3>5.7.9.<span style='font-size:7.0pt'> </span>Оператор ALL</h3>

<p class=MsoNormal>Вторым допустимым оператором является ALL. Действие его
противоположно оператору ANY. Оператор ALL становится верным, если все значения
из вложенного подзапроса равны значению-кандидату из внешнего запроса. Например
если значение - кандидат равно 1, а вложенный подзапрос вернул {1, 1, 1},
оператор ALL станет верным (внешний запрос проверяет на равенство). </p>

<p class=MsoNormal>Например, если нам необходимо найти всех продавцов, у
которых рейтинг выше чем у любого продавца из Рима, можно записать следующий
запрос: </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span lang=EN-US style='mso-ansi-language:EN-US'>SELECT *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE rating &gt; ALL<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(SELECT rating<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM
Customers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE city = </span><st1:City><st1:place><span lang=EN-US style='mso-ansi-language:
  EN-US'>Rome</span></st1:place></st1:City><span lang=EN-US style='mso-ansi-language:
EN-US'> ):<o:p></o:p></span></p>

<p class=MsoNormal>Операторы ANY и ALL можно выразить через EXIST в
кореллированном подзапросе, в явном виде они нужны лишь для упрощения записи запроса.
Обратное утверждение не верно - т.е. не все то, что можно выполнить с помощью
EXIST, можно сделать с помощью ANY и ALL</p>

<p class=MsoNormal>Замечание 1: Когда говорят, что значение больше (или меньше)
чем любое (ANY) из набора значений, это то же самое, что сказать, что оно
больше (или меньше) чем любое отдельно взятое из этих значений. И наоборот,
сказать что некоторое значение не равно всему (ALL) набору значений, это то же
самое, что сказать, что в наборе нет такого же значения. </p>

<p class=MsoNormal>Замечание 2: В случае, если подчиненный запрос вернул пустое
множество, оператор ALL становится верным, а ANY - ложным.</p>

<h3>5.7.10.<span style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Генерация отчетов с помощью компонентов <span lang=EN-US
style='mso-ansi-language:EN-US'>QuickReport</span></h3>

<p class=MsoNormal>Компонент <span lang=EN-US style='mso-ansi-language:EN-US'>Quick</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Report</span><span
lang=EN-US> </span>предназначен для генерации отчетов по содержимому базы
данных и выводу их на печать. В <span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span>5
(<span lang=EN-US style='mso-ansi-language:EN-US'>C</span>++ <span lang=EN-US
style='mso-ansi-language:EN-US'>Builder</span> 5.0) этот компонент
устанавливается по умолчанию. В <span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span>
7.0 и выше используется компонент <span lang=EN-US style='mso-ansi-language:
EN-US'>Rave</span><span lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>Report</span>, &nbsp;который в настоящей работе не рассматривается. Для
установки компонента <span lang=EN-US style='mso-ansi-language:EN-US'>Quick</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>Report</span><span
lang=EN-US> </span>в <span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span>
7.0 используйте меню <span lang=EN-US style='mso-ansi-language:EN-US'>Component</span>/<span
lang=EN-US style='mso-ansi-language:EN-US'>Install</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Packages</span>/<span lang=EN-US
style='mso-ansi-language:EN-US'>Add</span>/<span lang=EN-US style='mso-ansi-language:
EN-US'>Program</span><span lang=EN-US> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Files</span>\<span lang=EN-US style='mso-ansi-language:
EN-US'>Borland</span>\<span lang=EN-US style='mso-ansi-language:EN-US'>Delphi</span>7\<span
lang=EN-US style='mso-ansi-language:EN-US'>Bin</span>\<span lang=EN-US
style='mso-ansi-language:EN-US'>dclqrt</span>70.<span lang=EN-US
style='mso-ansi-language:EN-US'>bpl</span><b>. Для того, чтобы компоненты
раздела </b><b><span lang=EN-US style='mso-ansi-language:EN-US'>QuickReport</span>
могли функционировать необходимо, чтобы на компьютере был установлен хотя бы
один принтер по умолчанию.</b></p>

<p class=MsoNormal>Предположим, что нам необходимо получить бумажную копию всех
телефонов, имеющихся в записной книжке в формате: «Ф.И.О., Телефон, Тип». Для
этого создадим на форме <span lang=EN-US style='mso-ansi-language:EN-US'>AllQuery</span><span
lang=EN-US> </span>дополнительный компонент типа <span lang=EN-US
style='mso-ansi-language:EN-US'>TIBQuery</span>. В<span style='mso-ansi-language:
EN-US'> </span>свойство<span style='mso-ansi-language:EN-US'> <span lang=EN-US>SQL
</span></span>занесем<span style='mso-ansi-language:EN-US'> </span>текст<span
style='mso-ansi-language:EN-US'> </span>запроса<span lang=EN-US
style='mso-ansi-language:EN-US'>: «Select persona.fio, pnumber.pnum,
pnumber.ptype from pnumber inner join persona on (pnumber.p_id =
persona.p_id)». <o:p></o:p></span></p>

<p class=MsoNormal>Для создания отчета создаем новую форму <span lang=EN-US
style='mso-ansi-language:EN-US'>ReportForm</span><span lang=EN-US> </span>на
которой со страницы <span lang=EN-US style='mso-ansi-language:EN-US'>QReport</span><span
lang=EN-US> </span>&nbsp;переносим компонент генератора отчетов <span
lang=EN-US style='mso-ansi-language:EN-US'>QuckRep</span>1 : <span lang=EN-US
style='mso-ansi-language:EN-US'>TQuickRep</span>.</p>

<p class=MsoNormal>Укажем, что форма <span lang=EN-US style='mso-ansi-language:
EN-US'>ReportForm</span><span lang=EN-US> </span>использует модуль <span
lang=EN-US style='mso-ansi-language:EN-US'>DataModule</span>2 и выполним
настройку отчета:</p>

<p class=MsoNormal>- в свойстве <span lang=EN-US style='mso-ansi-language:EN-US'>DataSet</span><span
lang=EN-US> </span>устанавливаем ссылку на компонент&nbsp; запроса <span
lang=EN-US style='mso-ansi-language:EN-US'>AllQuery</span>;</p>

<p class=MsoNormal>- в свойстве <span lang=EN-US style='mso-ansi-language:EN-US'>Bands</span><span
lang=EN-US> </span>устанавливаем значение&nbsp; <span lang=EN-US
style='mso-ansi-language:EN-US'>true</span><span lang=EN-US> </span>напротив
тех разделов отчета, которые необходимы при его визуализации: <span lang=EN-US
style='mso-ansi-language:EN-US'>HasColumnHeader</span><span lang=EN-US> </span>–
заголовки столбцов, <span lang=EN-US style='mso-ansi-language:EN-US'>HasDetail</span><span
lang=EN-US> </span>– зона вывода записей базы данных, <span lang=EN-US
style='mso-ansi-language:EN-US'>HasSummary</span><span lang=EN-US> </span>–
итог под отчетом, <span lang=EN-US style='mso-ansi-language:EN-US'>HasTitle</span><span
lang=EN-US> </span>– заголовок отчета.</p>

<p class=MsoNormal>В раздел <span lang=EN-US style='mso-ansi-language:EN-US'>Title</span><span
lang=EN-US> </span>помещаем два компонента со страницы <span lang=EN-US
style='mso-ansi-language:EN-US'>QReport</span>: <span lang=EN-US
style='mso-ansi-language:EN-US'>QRLabel</span>1:<span lang=EN-US
style='mso-ansi-language:EN-US'>TQRLabel</span><span lang=EN-US> </span>и <span
lang=EN-US style='mso-ansi-language:EN-US'>QRSysData</span>1:<span lang=EN-US
style='mso-ansi-language:EN-US'>TQRSysData</span>. В компоненте <span
lang=EN-US style='mso-ansi-language:EN-US'>QRLabel</span>1:<span lang=EN-US
style='mso-ansi-language:EN-US'>TQRLabel</span><span lang=EN-US> </span>устанавливаем
свойство <span lang=EN-US style='mso-ansi-language:EN-US'>Caption</span>:
«Телефонная книга от», а в компоненте <span lang=EN-US style='mso-ansi-language:
EN-US'>QRSysData</span>1 выставляем свойство <span lang=EN-US style='mso-ansi-language:
EN-US'>Data</span><span lang=EN-US> </span>в значение <span lang=EN-US
style='mso-ansi-language:EN-US'>qrsDateTime</span>. Таким образом при выводе
отчета в его заголовке будет надпись следующего вида: «Телефонная книга от
16.04.2007 13:21:43».</p>

<p class=MsoNormal>В разделе<span lang=EN-US style='mso-ansi-language:EN-US'>Column</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;Header</span><span
lang=EN-US> </span>располагаем компоненты <span lang=EN-US style='mso-ansi-language:
EN-US'>TQRLabel</span><span lang=EN-US> </span>так, чтобы заголовки столбцов
позиционировались над данными.</p>

<p class=MsoNormal>В раздел <span lang=EN-US style='mso-ansi-language:EN-US'>Detail</span><span
lang=EN-US> </span>помещаем компоненты типа <span lang=EN-US style='mso-ansi-language:
EN-US'>TQRDBText</span>, которые ответственны за вывод данных запроса. Для
каждого компонента в поле <span lang=EN-US style='mso-ansi-language:EN-US'>DataField</span><span
lang=EN-US> </span>указываем имя поля, откуда компонент отчета получает данные
(например, для компонента <span lang=EN-US style='mso-ansi-language:EN-US'>QRDBText</span>1
это поле <span lang=EN-US style='mso-ansi-language:EN-US'>AllQuery</span>.<span
lang=EN-US style='mso-ansi-language:EN-US'>FIO</span>). В начале строки раздела
<span lang=EN-US style='mso-ansi-language:EN-US'>Detail</span><span lang=EN-US>
</span>располагается компонент <span lang=EN-US style='mso-ansi-language:EN-US'>QRSysData</span>2,
поле <span lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span
lang=EN-US> </span>которого установлено в значение <span lang=EN-US
style='mso-ansi-language:EN-US'>QrsDetailNo</span> (номер стоки очета).</p>

<p class=MsoNormal>В разделе <span lang=EN-US style='mso-ansi-language:EN-US'>Summary</span><span
lang=EN-US> </span>расположены компоненты <span lang=EN-US style='mso-ansi-language:
EN-US'>QRLabel</span>5:<span lang=EN-US style='mso-ansi-language:EN-US'>TQRLabel</span><span
lang=EN-US> </span>– для вывода сообщения «Итого записей» и <span lang=EN-US
style='mso-ansi-language:EN-US'>QRSysData</span>3 со значением в поле <span
lang=EN-US style='mso-ansi-language:EN-US'>Data</span><span lang=EN-US> </span><span
lang=EN-US style='mso-ansi-language:EN-US'>QrsDetailCount</span>. В результате
при генерации отчета в последней строке будет выведено количество записей
телефонной книги.</p>

<p class=MsoNormal>В целом форма отчета имеет вид, который показан на рисунке
5.1.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=173
id="_x0000_i1053" src="musubd.files/image028.jpg"></p>

<p class=MsoNormal style='text-indent:14.2pt'>Рисунок 5.1 – Форма отчета</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'>Для активизации отчета в режиме
просмотра на главной форме проекта располагаем кнопку «Отчет» (рисунок 5.2).</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'><img border=0 width=316
height=220 id="_x0000_i1054" src="musubd.files/image029.jpg"></p>

<p class=MsoNormal style='text-indent:14.2pt'>Рисунок 5.2 – Главная форма
проекта</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'>В обработчике <span lang=EN-US
style='mso-ansi-language:EN-US'>BtReportClick</span><span lang=EN-US> </span>выполняем
активизацию запроса <span lang=EN-US style='mso-ansi-language:EN-US'>AllQuery</span><span
lang=EN-US> </span>и вызываем метод ReportForm.QuickRep1.Preview:</p>

<p class=MsoNormal style='text-indent:14.2pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>procedure TForm1.BtReportClick(Sender:
TObject);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:14.2pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>begin<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:14.2pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>&nbsp; DataModule2.AllQuery.Open;&nbsp;&nbsp;
ReportForm.QuickRep1.Preview;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:14.2pt'>end;</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'>В&nbsp; режиме исполнения отчет
имеет вид, показанный на рисунке 5.3.</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'><img border=0 width=402
height=177 id="_x0000_i1055" src="musubd.files/image030.jpg"></p>

<p class=MsoNormal style='text-indent:14.2pt'>Рисунок 5.3 – Отчет в режиме
просмотра.</p>

<p class=MsoNormal style='text-indent:14.2pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:14.2pt'>С помощью панели инструментов,
расположенной в верхней строке отчета можно сохранить его в файл или вывести на
печать.</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h1><a name="_Toc163231770">6.</a><span style='mso-bookmark:_Toc163231770'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Лабораторная
работа №6. «ТРИГГЕРЫ И ХРАНИМЫЕ ПРОЦЕДУРЫ»</span></h1>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.1.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Цель работы</h2>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Изучить
механизм работы хранимых процедур, триггеров и генераторов в СУБД Interbase.
Научиться применять их при разработке проекта базы данных..</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>&nbsp;</p>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.2.<span
lang=EN-US style='font-size:7.0pt;mso-ansi-language:EN-US'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:7.0pt'> </span>Введение</h2>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Хранимые
процедуры (англ, stoied proceduies) позволяют реализовать значительную часть
логики приложения на уровне базы данных и таким образом повысить производительность
всего приложения, централизовать обработку данных и уменьшить количество кода,
необходимого для выполнения поставленных задач Практически любое достаточно
сложное приложение баз данных не обходится без использования хранимых процедур.
Помимо этих широко известных преимуществ использования хранимых процедур, общих
для большинства реляционных СУБД, хранимые процедуры InterBase могут играть
роль практически полноценных наборов данных, что позволяет использовать
возвращаемые ими результаты в обычных SQL-запросах. Триггеры - одно из
замечательнейших изобретений разработчиков баз данных. Триггеры позволяют
придать &quot;активность&quot; данным, хранящимся в базе данных, централизовать
их обработку и упростить логику клиентских приложений. <br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.3.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Методика выполнения
работы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal style='text-indent:35.4pt'>1. Изучить рекомендации по
выполнению работы и определить вариант задания.</p>

<p class=MsoNormal style='text-indent:35.4pt'>2. Удалить всю информацию из
таблиц базы данных, разработанной в лабораторной работе №5. В противном случае
провести ее модификацию будет достаточно сложно.</p>

<p class=MsoNormal style='text-indent:35.4pt'>3. Модифицировать структуру базы
данных, разработанной в лабораторной работе №4</p>

<p class=MsoNormal style='text-indent:35.4pt'>3.1. Заменить ключевых полей
задается не на уровне приложения с помощью генератора случайных чисел на
автоинкрементные значения, заносимые триггером «Перед вставкой».</p>

<p class=MsoNormal style='text-indent:35.4pt'>3.2. Разработать текст хранимых
процедур для трех запросов в соответствии с вариантом задания к лабораторной
работе №5.</p>

<p class=MsoNormal style='text-indent:35.4pt'>4. Модифицировать приложение в
соответствии с проведенной модификацией базы данных. Добиться корректной работы
приложения. Организовать запрос к данным в приложении через хранимые процедуры <span
lang=EN-US style='mso-ansi-language:EN-US'>SQL</span>.<o:p></o:p></p>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'><span
style='font-weight:normal;mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></h2>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.4.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Варианты заданий<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<h2 align=left style='text-align:left'><span style='font-weight:normal;
mso-bidi-font-weight:bold'>Варианты <span
style='mso-spacerun:yes'> </span>заданий к лабораторной работе №6 совпадают с
вариантами заданий к лабораторной работе №5.<o:p></o:p></span></h2>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.5.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Содержание отчета</h2>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.6.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Контрольные вопросы</h2>

<h2 align=left style='margin-left:0cm;text-align:left;text-indent:35.45pt'>6.7.<span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Рекомендации по
выполнению работы</h2>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><b
style='mso-bidi-font-weight:normal'>Триггер</b> в InterBase - это особый вид
хранимой процедуры, которая выполняется автоматически при вставке, удалении или
модификации записи таблицы или представления (view). Триггеры могут
&quot;срабатывать&quot; непосредственно до или сразу же после указанного
события. <span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Может
быть, это звучит достаточно сложно, однако, как это бывает во многих случаях,
сама идея, лежащая в основе триггеров, очень проста. <br>
Как вы знаете. SQL дает возможность нам вставлять, удалять и модифицировать
данные в таблицах базы данных при помощи соответствующих команд - INSERT,
DELETE и UPDATE. Согласитесь, что было бы неплохо иметь возможность перехватить
передаваемую команду и что-нибудь сделать с данными, которые добавляются,
удаляются или изменяются. Например, записать эти данные в специальную табличку,
а заодно записать, кто и когда произвел операцию над данной таблицей. Или сразу
же проверить вставляемые данные на какое- нибудь хитрое условие, которое
невозможно реализовать с помощью опции CHECK (см. выше главу &quot;Ограничения
базы данных&quot;), и в зависимости от результатов проверки принять проводимые
изменения или отвергнуть их; изменить эти данные на основании какого-либо
запроса или изменить данные в других связанных таблицах. <span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Вот
для того, чтобы выполнять какие-либо действия, связанные с изменением данных в
базе данных, и существуют триггеры. Фактически триггер представляет собой набор
команд процедурного языка InterBase, который исполняется при выполнении
операций TNSERT/DELETE/UPDATE В отличие от хранимых процедур, триггер никогда
ничего не возвращает (да и некому возвращать. ведь триггер явно не вызывается)
По той же причине он не имеет также входных параметров, но вместо них имеет
контекстные переменные NEW и OLD. Эти переменные позволяют получить доступ к
полям таблицы, к которой присоединен триггер (мы расскажем об этом чуть позже).
<br>
Триггеру предназначена роль виртуального цензора, который просматривает
&quot;письма&quot; и который волен сделать все, что угодно, - пропустить их
неизменными, подправить их, просигнализировать об ошибках или даже
&quot;доложить об этом&quot; кому следует. <span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Триггер
всегда привязан к какой-то определенной таблице или представлению и может
&quot;перехватывать&quot; данные только этой таблицы. Давайте рассмотрим
классификацию триггеров и назначение каждого вида. Как уже было сказано,
существует 3 основных SQL-операции, применимые к данным, -
INSERT/DELETE/UPDATE. Соответственно первое разделение триггеров - по
обслуживаемым операциям. Каждый конкретный триггер привязан к какой-либо
операции, т. е. триггер срабатывает, когда в &quot;его&quot; таблице происходит
данная операция. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Также
срабатывание триггера может происходить &quot;до&quot; и &quot;после&quot;
операции. Таким образом, мы получаем 6 возможных видов триггеров на таблицу -
до и после каждой из трех возможных SQL-операций. <span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><b
style='mso-bidi-font-weight:normal'><span style='font-size:10.0pt'>Генератор</span></b><span
style='font-size:10.0pt'> - это специальный объект базы данных, который
генерирует уникальные последовательные числа. Эти числа могут быть использованы
в качестве идентификаторов (например код клиента, номер счета и т.п.). Для
создания генератора необходимо использовать оператор DDL <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><tt><b><span
style='font-size:10.0pt'>CREATE GENERATOR generatorname;</span></b></tt><span
style='font-size:10.0pt'> <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><span
style='font-size:10.0pt'>При выполнении такой команды происходит 2 действия: <br>
1. На специальной странице БД отводится 4 байта для хранения значени генератора
<br>
2. В системной таблице RDB$GENERATORS заводится запись, куда помещаетс имя
генератора иего номер (фактически смещение на странице генераторов). <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><span
style='font-size:10.0pt'>После создания генератора его значения можно получать
при помощи функции <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><tt><b><span
lang=EN-US style='font-size:10.0pt;mso-ansi-language:EN-US'>GEN_ID(generatorname,
inc_value)</span></b></tt><span lang=EN-US style='font-size:10.0pt;mso-ansi-language:
EN-US'> <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><span
style='font-size:10.0pt'>где inc_value - число, на которое необходимо
прирастить значение генератора. <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><span
style='font-size:10.0pt'>Генераторы возвращают значения (и сохраняют свои
значения на диске) вне контекста транзакции пользователя. Это означает, что
если генератора было увеличено с 10 до 11 (инкремент 1), то даже при откате
транзакции (ROLLBACK) значение генератора не вернется к предыдущему. Вместе с
этим гарантируется что каждому пользователю будет возвращено уникальное
значение генератора. <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-indent:35.45pt'><span
style='font-size:10.0pt'>При выборке значения генератора запросом вида select
gen_id(genname, x) from ... следует учитывать буферизацию выборки на клиенте.
Т.е. в многопользовательской среде при выполнении двух таких запросов значения
генератора будут увеличиваться &quot;пачками&quot;, а не на величину x для
каждой выбираемой записи. <o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=68></a><b style='mso-bidi-font-weight:normal'>Пример триггера<o:p></o:p></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Давайте
рассмотрим простой пример триггера, который срабатывает ДО ВСТАВКИ в таблицу и
заполняет поле первичного ключа. Мы воспользуемся в качестве основы для
триггера таблицей из примера в главе &quot;Таблицы. Первичные ключи и
генераторы&quot; этой части: <br>
<br>
CREATE TABLE Table_example (&nbsp; <br>
ID INTEGER NOT NULL,&nbsp; <br>
NAME VARCHAR(80),&nbsp; <br>
PRICE_1 DOUBLE PRECISION,&nbsp; <br>
CONSTRAINT pkTable PRIMARY KEY (ID)); <br>
<br>
Здесь поле ID является первичным ключом и значения этого поля должны быть
уникальными в пределах таблицы. Чтобы обеспечить выполнение этого требования,
создадим генератор и триггер, который будет получать значение генератора и
подставлять его в таблицу. Таким образом, в поле ID всегда будет уникальные
значения, так как значение генератора будет увеличиваться каждый раз при
обращении к триггеру. Итак, создаем генератор:&nbsp; <br>
<br>
CREATE GENERATOR GEN_TABLE_EXAMPLE_ID; <br>
<br>
И устанавливаем его начальное значение в единицу: <br>
<br>
SET GENERATOR GEN_TABLE_EXAMPLE_ID TO 1; <br>
<br>
Теперь необходимо создать триггер. Надо сказать, что триггер, как и хранимая
процедура, может содержать в своем теле несколько операторов, разделенных
точкой с запятой. Поэтому если вы не используете один из инструментов,
рекомендованных в приложении &quot;Инструменты администратора и разработчика
InterBase&quot;, а работаете с isql, то вам необходимо воспользоваться командой
смены разделителя команд SET TERM, как это было описано в главе &quot;Хранимые
процедуры&quot;. Мы же будем приводить тексты триггеров без обрамления
командами смены разделителя. <br>
Итак<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>рассмотрим<span
style='mso-ansi-language:EN-US'> </span>текст<span style='mso-ansi-language:
EN-US'> </span>нашего<span style='mso-ansi-language:EN-US'> </span>триггера<span
lang=EN-US style='mso-ansi-language:EN-US'>: <br>
<br>
CREATE TRIGGER Table_example_bi FOR Table_example&nbsp; <br>
ACTIVE BEFORE INSERT POSITION 0 <br>
AS <br>
BEGIN <br>
IF (NEW.ID IS NULL) THEN <br>
NEW. </span>ID GEN_ID(GEN_TABLE_EXAMPLE_ID, 1); <br>
END <br>
<br>
Как видите, триггер очень напоминает хранимую процедуру (фактически, как )же
было сказано, это и есть особая разновидность ХП), но есть и несколько отличий
Давайте подробно разберем &quot;строение&quot; триггера. <br>
Описание команды создания триггера начинается с ключевых слов CREATE TRIGGER,
после которых следует имя триггера - Table_example_bi. Потом следует ключевое
слово FOR, после которого указано имя таблицы, для которой создается триггер, -
Table_example. <br>
На второй строке команды приводится описание сущности триггера - ключевое слово
ACTIVE указывает, что триггер является &quot;активным&quot;. Триггер также
может быть переведен в состояние INACTIVE. Это означает, что он будет храниться
в базе данных, но он не будет срабатывать. Сочетание ключевых слов BEFORE
INSERT определяет, что триггер срабатывает ДО ВСТАВКИ; а ключевое слово
POSITION и число 0 указывают очередность (позицию) создаваемого триггера среди
триггеров того же типа для данной таблицы. Позиция триггера нужна потому, что в
InterBase возможно создать более 32000 триггеров каждого вида (например, BEFORE
INSERT или AFTER UPDATE), и серверу нужно указать, в каком порядке эти триггеры
будут выполняться. Триггеры с меньшей позицией выполняются первыми. Если
имеется несколько триггеров с одинаковой позицией, то они будут выполняться в
алфавитном порядке. <br>
Все рассмотренное выше до ключевого слова AS образует заголовок триггера. После
AS следует тело триггера. Собственно в теле и осуществляется вставка значения в
поле первичного ключа. Но сначала с помощью уже знакомого вам оператора IF..
.THEN проверяется, не было ли заполнено это поле на клиенте. Выражение проверки
возвращающей булеву TRUE (истина) или FALSE (ложь), выгядит так: <br>
NEW. ID IS NULL <br>
&quot;Интересно, что такое NEW?&quot; - спросите вы. Это одна из особенностей,
присущая только триггерам, - <i>контекстная переменная. </i>Давайте взглянем,
как она действует <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=69></a><b style='mso-bidi-font-weight:normal'>Контекстные переменные<o:p></o:p></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Как
уже говорилось выше, триггер похож на цензора, бесцеремонно досматривающего
все. что относится к интересующему его предмету Интерес нашего
триггера-&quot;цензора&quot; описан сочетанием ключевых слов BEFORE INSERT -
это значит, что все операции вставки (INSERT) вызовут срабатывание триггера.
Причем он сработает ДО (BEFORE) того, как вставка физически осуществлена. То
есть в момент срабатывания триггера данные, присланные кем-либо на вставку, еще
не занесены в таблицу. Они находятся в некотором промежуточном буфере. И у
триггера есть возможность обращаться к этому буферу, чтобы проверить и/или
изменить значения данных-кандидатов на вставку. Эта возможность реализована с
помощью контекстной переменной NEW. Можно рассматривать эту переменную как
структуру (что-то подобное struct в Си или record в Pascal), элементы которой
представляют собой значения, присланные для осуществления операции (INSERT в
нашем примере). То есть внутри триггера мы можем обратиться ко всем полям еще
не вставленной записи, используя для этого обращение: New.ID, New.NAME и New
PRICE_1. <br>
Мы можем узнать значение каждого поля вставляемой записи, сравнить его или
изменить. Это собственно и делается в этом кусочке кода: <br>
<br>
IF (NEW.ID IS NULL) THEN <br>
NEW.ID = GEN_ID(GEN_TABLE_EXAMPLE_ID, 1) ; <br>
<br>
Сначала в операторе IF...THEN проверяем идентификатор ID на наличие какого-либо
значения, ведь он может быть сгенерирован на клиенте. Если значением NEW.ID
является NULL, то вызываем функцию GEN_ID, которая увеличивает значение
генератора GEN_TABLE_EXAMPLE_ID на единицу и затем возвращает полученное число,
которое присваивается полю NEW.ID Таким образом, мы &quot;налету&quot; изменили
значения во вставляемой записи! <br>
Кроме контекстной переменной NEW, существует ее зеркальный аналог - переменная
OLD. В отличие от NEW, OLD содержит старые значения записи, которые удаляются
или изменяются. Например, мы можем использовать переменную <span lang=EN-US
style='mso-ansi-language:EN-US'>OLD </span>для<span style='mso-ansi-language:
EN-US'> </span>получения<span style='mso-ansi-language:EN-US'> </span>значений<span
style='mso-ansi-language:EN-US'> </span>записей<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>которые<span style='mso-ansi-language:
EN-US'> </span>удаляются<span style='mso-ansi-language:EN-US'> </span>из<span
style='mso-ansi-language:EN-US'> </span>таблицы<span lang=EN-US
style='mso-ansi-language:EN-US'>: <br>
<br>
CREATE TRIGGER Table_example_adO FOR Table_example <br>
ACTIVE AFTER DELETE POSITION 0&nbsp; <br>
AS <br>
BEGIN&nbsp; <br>
IF (OLD.id&gt;1000) THEN <br>
BEGIN <br>
/*..do something..*/ <br>
</span>OLD.ID=10;&nbsp; <br>
END&nbsp; <br>
END <br>
<br>
Здесь мы создаем триггер, который срабатывает ПОСЛЕ УДАЛЕНИЯ (AFTER DELETE) Как
видите, мы можем получить доступ к уже удаленным данным Конечно, присвоение
OLD.1D=10; не имеет никакого смысла - присвоенное значение пропадет на выходе
из триггера. Однако этот пример показывает, что мы можем перехватить удаляемые
значения и записать, например, в некую таблицу, где хранится история всех
изменений. <br>
Использование контекстных переменных часто вызывает множество вопросов Дело в
том. что в различных видах триггеров NEW и OLD используются по- разному, а в
некоторых их вообще невозможно использовать. Если мы рассмотрим триггер в нашем
примере, то он вызывается ДО ВСТАВКИ. О каких значениях OLD может идти речь?
Ведь вставляется совершенно новая запись! И действительно, контекстная переменная
OLD не может быть использована в триггерах BEFORE/AFTER INSERT. А переменная
NEW не может быть использована в BEFORE/AFTER DELETE. Обе этих переменные
одновременно могут быть использованы в триггерах BEFORE/AFTER UPDATE, причем
изменять что-либо можно, только используя переменную NEW (действительно, что
можно изменять в удаляющихся значениях, доступных через OLD?), и только в
триггерах BEFORE INSERT/UPDATE. <br>
Довольно сложные правила использования, не так ли? Давайте попробуем
формализовать их в виде простых правил, которые сведены в таблицу 1.3. В ней мы
опишем, как можно применять контекстные переменные в различных триггерах Эту
таблицу удобно использовать в качестве подсказки при разработке триггеров. <br>
В этой таблице для каждой контекстной переменной заведено по два столбца -
&quot;Читать&quot; и Изменять&quot;, отражающих возможные действия с этими
переменными В столбце 6 строчек - по числу типов триггеров. Например, если на
пересечении типа триггера и возможного действия с контекстной переменной NEW
стоит Y, это значит, что в данном типе триггер можно читать или одновременно
читать и менять данные Если стоит N/A. то в этом триггере нельзя осуществить
это действие с данной контекстной переменной. <br>
<b><i>Табл 1.3.</i></b><i> Использование контекстных переменных NEW и OLD </i>в
триггерах <o:p></o:p></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='mso-cellspacing:0cm;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0'>
  <td rowspan=3 valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Тип
  триггера <o:p></o:p></p>
  </td>
  <td colspan=4 valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Контекстныепеременные
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td colspan=2 valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>NEW
  <o:p></o:p></p>
  </td>
  <td colspan=2 valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>OLD
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Читать
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Изменять
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Читать
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Изменять
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>BEFORE
  INSERT <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>AFTER
  INSERT <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>BEFORE
  UPDATE <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>AFTER
  UPDATE <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>BEFORE
  DELETE <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>AFTER
  DELETE <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Y <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>N/A
  <o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Наиболее
широкие возможности предоставляет использование NEW и OLD в операции обновления.
Ведь таким образом мы можем сравнить текущее (OLD) и новое (NEW) значения и
предпринять какие-то действия. Например, такой триггер будет очень полезен для
вычисления текущих остатков товара на складе при приходе/расходе товара <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=70></a>Управление состоянием триггера<o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>По
умолчанию триггер создается активным, т. е. он будет срабатывать при
осуществлении соответствующей операции. Состоянием триггера управляет ключевое
слово ACTIVE в заголовке Если же триггер сделать неактивным, то он не будет
исполняться при возникновении операции. Это бывает полезным при осуществлении
каких-либо внеплановых операций надданными, например массовой заливке данных
или ручном исправлении данных. Чтобы отключить триггер, необходимо выполнить
команду DDL:&nbsp; <br>
<br>
ALTER TRIGGER &lt;tngger_name&gt; INACTIVE; <br>
<br>
Обратите внимание, что это команда относится к Data Definition'Language, и ее
нельзя вызвать из хранимых процедур или других триггеров. Вообще говоря,
существует способ управлять состоянием триггеров с помощью модификации
системных таблиц. Конечно, модификация системных таблиц является
недокументированным способом работы с триггерами и рекомендовать ее мы не
будем, но для иллюстрации возможностей работы с системными таблицами InterBase
приведем пример. Для того чтобы установить состояние триггера в INACTIVE,
достаточно выполнить следующую команду: <br>
<br>
UPDATE rdb$triggers trg <br>
SET erg id&pound;&gt;$t.rigger_inactive = l <br>
WHERE trg.rdb$trigger_name='TABLE_EXAMPLE_AD0' <br>
<br>
Эта команда аналогична по действию вышеприведенной команде DDL, но ее можно
вызывать в других триггерах и процедурах. <br>
Тут следует лишить вас некоторых надежд, которые могли зародиться, когда вы
увидели, что метаданные триггеров можно с легкостью изменять с помощью обычного
SQL-запроса. Часто такую возможность принимают за хороший способ управлять
цепочками триггеров, т е. в одном триггере или хранимой процедуре включать или
выключать нужные триггеры и таким образом управлять обработкой данных, включая
или выключая нужные триггеры Однако изменять состояние триггеров
&quot;налету&quot; не удастся. <br>
Дело в том, что триггеры работают в рамках той же транзакции, что и вызвавшее
их изменение. Поэтому если один триггер изменит состояние другого в зависимости
от каких-либо условий, то механизм &quot;активных таблиц&quot;, который
занимается запуском триггеров (хоть мы и говорим, что триггер запускается
неявно, но &quot;кто-то внутри сервера&quot; должен их все-таки запускать!), не
увидит эти изменения, так как они еще не подтверждены! Таким образом, в рамках
одной транзакции нельзя управлять состоянием триггеров. <br>
Если сделать подтверждение транзакции, в которой выполнился первый триггер,
который выключил (или включил) второй триггер, а затем запустить снова
транзакцию, то мы увидим изменения в состоянии второго триггера. Но какой смысл
это делать, ведь суть идеи состояла в том, чтобы включать триггеры на лету, не
теряя значения в буфере контекстных переменных NEW или OLD. <br>
В общем, это был пример того, что не следует делать в триггерах. Другим
примером того, чего не следует делать в триггерах, является изменение данных в
той же таблице, к которой привязан триггер, не через контекстные переменные, а
с помощью обычных SQL-команд INSERT/UPDATE/DELETE. Например некий триггер на
вставку вызывает хранимую процедуру, внутри которой происходит вставка записи в
ту же таблицу. Вставка опять вызовет срабатывание нашего триггера, и возникнет
зацикливание. Следует очень внимательно относиться к использованию триггеров,
так как зацикливание в ряде случаев может привести к аварийному завершению
сервера InterBase. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=71></a><b style='mso-bidi-font-weight:normal'>Хранимая процедура (ХП)</b>
- это часть метаданных базы данных, представляющая собой откомпилированную во
внутреннее представление InterBase подпрограмму, написанную на специальном
языке, компилятор которого встроен в ядро сервера InteiBase. Хранимую процедуру
можно вызывать из клиентских приложений, из триггеров и других хранимых
процедур. Хранимая процедура выполняется внутри серверного процесса и может
манипулировать данными в базе данных, а также возвращать вызвавшему ее клиенту
(т е триггеру, ХП, приложению) результаты своего выполнения. Основой мощных
возможностей, заложенных в ХП, является процедурный язык программирования,
имеющий в своем составе как модифицированные предложения обычного SQL, такие,
как INSERT, UPDATE и SELECT, так и средства организации ветвлений и циклов (IF,
WHILE), а также средства обработки ошибок и исключительных ситуаций Язык
хранимых процедур позволяет реализовать сложные алгоритмы работы с данными, а
благодаря ориентированности на работу с реляционными данными ХП получаются
значительно компактнее аналогичных процедур на традиционных языках. <br>
Надо отметить, что и для триггеров используется этот же язык программирования,
за исключением ряда особенностей и ограничений. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=55></a><b style='mso-bidi-font-weight:normal'>Пример простой хранимой
процедуры<o:p></o:p></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Настало
время создать первую хранимую процедуру и на ее примере изучить процесс
создания хранимых процедур. Но для начала следует сказать несколько слов о том,
как работать с хранимыми процедурами Дело в том, что своей славой малопонятного
и неудобного инструмента ХП обязаны чрезвычайно бедным стандартным средствам
разработки и отладки хранимых процедур. В документации по InterBase
рекомендуется создавать процедуры с помощью файлов SQL-скриптов, содержащих
текст ХП, которые подаются на вход интерпретатору isql, и таким образом
производить создание и модификацию ХП Если в этом SQL-скрипте на этапе
компиляции текста процедуры в BLR (о BLR см главу &quot;Структура базы данных
InterBase&quot; (ч. 4)) возникнет ошибка, то isql выведет сообщение о том, на
какой строке файла SQL-скрипта возникла эта ошибка. Исправляйте ошибку и
повторяйте все сначала. Про отладку в современном понимании этого слова, т. е.
о трассировке выполнения, с возможностью посмотреть промежуточные значения
переменных, речь вообще не идет. Очевидно, что такой подход не способствует
росту привлекательности хранимых процедур в глазах разработчика <br>
Однако помимо стандартного минималистского подхода к разработке ХП &lt;_ществют
также инструменты сторонних разработчиков, которые делают работу с хранимыми
процедурами весьма удобной Большинство универсальных продуктов для работы с
InterBase, перечисленных в приложении &quot;Инструменты администратора и
разработчика InterBase&quot;, предоставляют удобный инструментарий для работы с
ХП. Мы рекомендуем обязательно воспользоваться одним из этих инструментов для
работы с хранимыми процедурами и изложение материала будем вести в
предположении, что у вас имеется удобный GUI-инструмент, избавляющий от
написания традиционных SQL-скриптов <br>
Синтаксис хранимых процедур описывается следующим образом: <br>
<br>
CREATE PROCEDURE name <br>
[ ( param datatype [, param datatype ...] <span lang=EN-US style='mso-ansi-language:
EN-US'>) ]&nbsp; <br>
&nbsp;[RETURNS ( param datatype [, param datatype ...])]&nbsp; <br>
AS <br>
&lt;procedure_body&gt;; <br>
&lt; procedure_body&gt; = [&lt;vanable_declaration_list&gt;]&nbsp; <br>
&lt; block&gt; <br>
&lt; vanable_declaration_list&gt; =&nbsp; <br>
DECLARE VARIABLE var datatype;&nbsp; <br>
[DECLARE VARIABLE var datatype; ...] <br>
&nbsp;</span>&lt;block&gt; = <br>
&nbsp;BEGIN <br>
&lt; compound_statement&gt;&nbsp; <br>
[&lt; compound_statement&gt; ...]&nbsp; <br>
END&nbsp; <br>
&lt; compound_statement&gt; = (&lt;block&gt; statement;} <br>
<br>
Выглядит довольно объемно и может быть даже громоздко, но на самом деле все
очень просто Для того чтобы постепенно освоить синтаксис, давайте будем
рассматривать постепенно усложняющиеся примеры. <br>
Итак, вот пример очень простой хранимой процедуры, которая принимает на входе
два числа, складывает их и возвращает полученный результат: <br>
<br>
CREATE PROCEDURE SP_Add(first_arg DOUBLE PRECISION,&nbsp; <br>
second_arg DOUBLE PRECISION)&nbsp; <br>
RETURNS (Result DOUBLE PRECISION)&nbsp; <br>
AS <br>
BEGIN <br>
Result=first_arg+second_arg; <br>
SUSPEND;&nbsp; <br>
END <br>
<br>
Как видите, все просто: после команды CREATE PROCEDURE указывается имя вновь
создаваемой процедуры (которое должно быть уникальным в пределах базы данных) -
в данном случае SP_Add, затем в скобках через запятую перечисляются входные
параметры ХП - first_arg и second_arg - с указанием их типов. <br>
Список входных параметров является необязательной частью оператора CREATE
PROCEDURE - бывают случаи, когда все данные для своей работы процедура получает
посредством запросов к таблицам внутри тела процедуры. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>В
хранимых процедурах используются любые скалярные типы данных InteiBase He
предусмотрено применение массивов и типов, определяемых пользователем, -
доменов <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Далее
идет ключевое слово RETURNS, после которого в скобках перечисляются
возвращаемые параметры с указанием их типов — в данном случае только один -
Result. <br>
Если процедура не должна возвращать параметры, то слово RETURNS и список
возвращаемых параметров отсутствуют. <br>
После RETURNSQ указано ключевое слово AS. До ключевого слова AS идет <i>заголовок,
</i>а после него - <i>течо </i>процедуры. <br>
Тело хранимой процедуры представляет собой перечень описаний ее внутренних
(локальных) переменных (если они есть, подробнее рассмотрим ниже), разделяемый
точкой с запятой (;), и блок операторов, заключенный в операторные скобки BEGIN
END. В данном случае тело ХП очень простое - мы просю складываем два входных
аргумента и присваиваем их результат выходному, а затем вызываем команду
SUSPEND. Чуть позже мы разъясним суть действия этой команды, а пока лишь
отметим, что она нужна для передачи возвращаемых параметров туда, откуда была
вызвана хранимая процедура. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=56></a>Разделители в хранимых процедурах<o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Обратите
внимание, что оператор внутри процедуры заканчивается точкой с запятой (;). Как
известно, точка с запятой является стандартным разделителем команд в SQL - она
является сигналом интерпретатору SQL, что текст команды введен полностью и надо
начинать его обрабатывать. Не получится ли так, что, обнаружив точку с запятой
в середине ХП, интерпретатор SQL сочтет, что команда введена полностью и
попытается выполнить часть хранимой процедуры? Это предположение не лишено
смысла. Действительно, если создать файл, в который записать вышеприведенный
пример, добавить команду соединения с базы данных и попытаться выполнить этот
SQL-скрипт с помощью интерпретатора isql, то будет возвращена ошибка, связанная
с неожиданным, по мнению интерпретатора, окончанием команды создания хранимой
процедуры. Если создавать хранимые процедуры с помощью файлов SQL-скриптов, без
использования специализированных инструментов разработчика InterBase, то
необходимо перед каждой командой создания ХП (то же относи 1ся и к триггерам)
менять разделитель команд скрипта на другой символ, отличный от точки с
запятой, а после текста ХП восстанавливать его обратно. Команда isql, изменяющая
разделитель предложений SQL, выглядит так: <br>
<br>
SET TERM &lt;new_term&gt;&lt;old_term&gt; <br>
<br>
Для типичного случая создания хранимой процедуры это выглядит так: <br>
<br>
SET TERM ^; <br>
CREATE PROCEDURE some_procedure <br>
... . . <br>
END <br>
^ <br>
SET TERM ;^ <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=57></a>Вызов хранимой процедуры<o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Но
вернемся к нашей хранимой процедуре. Теперь, когда она создана, ее надо как-то
вызвать, передать ей параметры и получить возвращаемые результаты. Это сделать
очень просто - достаточно написать SQL-запрос следующего вида: <br>
<br>
SELECT * <br>
FROM Sp_add(181.35, 23.09) <br>
<br>
Этот запрос вернет нам одну строку, содержащую всего одно поле Result, в
котором будет находиться сумма чисел 181.35 и 23.09 т. е. 204.44. <br>
Таким образом, нашу процедуру можно использовать в обычных SQL- запросах,
выполняющихся как в клиентских программах, так и в других ХП или триггерах.
Такое использование нашей процедуры стало возможным из-за применения команды
SUSPEND в конце хранимой процедуры. <br>
Дело в том, что в InterBase (и во всех его клонах) существуют два типа хранимых
процедур: процедуры-выборки (selectable procedures) и исполняемые процедуры
(executable procedures). Отличие в работе этих двух видов ХП заключается в том,
что процедуры-выборки обычно возвращают множество наборов выходных параметров,
сгруппированных построчно, которые имеют вид набора данных, а исполняемые
процедуры мог)т либо вообще не возвращать параметры, либо возвращать только
один набор выходных параметров, перечисленных в Returns, где одну строку
параметров. Процедуры-выборки вызываются в запросах SELECT, а исполняемые
процедуры - с помощью команды EXECUTE PROCEDURE. <br>
Оба вида хранимых процедур имеют одинаковый синтаксис создания и формально
ничем не отличаются, поэтому любая исполнимая процедура может быть вызвана в
SELECT-запросе и любая процедура-выборка - с помощью EXECUTE PROCEDURE. Вопрос
в том, как поведут себя ХП при разных типах вызова. Другими словами, разница
заключается в проектировании процедуры для определенного типа вызова. То есть
процедура-выборка специально создается для вызова из запроса SELECT, а исполняемая
процедура - для вызова с использованием EXECUTE PROCEDURE. Давайте рассмотрим,
в чем же заключаются отличия при проектировании этих двух видов ХП. <br>
Для того чтобы понять, как работает процедура-выборка, придется немного
углубиться в теорию. Давайте представим себе обычный SQL-запрос вида SELECT ID,
NAME FROM Table_example. В результате его выполнения мы получаем на выходе
таблицу, состоящую из двух столбцов (ID и NAME) и некоторого количества строк
(равного количеству строк в таблице Table_example). Возвращаемая в результате
этого запроса таблица называется также набором данных SQL Задумаемся же, как
формируется набор данных во время выполнения этого запроса Сервер, получив
запрос, определяет, к каким таблицам он относится, затем выясняет, какое подмножество
записей из этих таблиц необходимо включить в результат запроса. Далее сервер
считывает каждую запись, удовлетворяющую результатам запроса, выбирает из нее
нужные поля (в нашем случае это ID и NAME) и отсылает их клиенту. Затем процесс
повторяется снова - и так для каждой отобранной записи. <br>
Все это отступление нужно для того, чтобы уважаемый читатель понял, что все
наборы данных SQL формируются построчно, в том числе и в хранимых процедурах! И
основное отличие процедур-выборок от исполняемых процедур в том, что первые
спроектированы для возвращения множества строк, а вторые - только для одной.
Поэтому они и применяются по-разному: процедура-выборка вызывается при помощи
команды SELECT, которая &quot;требует&quot; от процедуры отдать все записи, которая
она может вернуть. Исполняемая процедура вызывается с помощью EXECUTE
PROCEDURE, которая &quot;вынимает&quot; из ХП только одну строку, а остальные
(даже если они есть!) игнорирует. <br>
Давайте рассмотрим пример процедуры-выборки, чтобы было понятнее. Для &gt;
прощения создадим хранимую процедуру, которая работает точно так же, как запрос
SELECT ID, NAME FROM Table_Example, т е она просто делает выборку полей ID и
NAME из всей таблицы. Вот<span style='mso-ansi-language:EN-US'> </span>этот<span
style='mso-ansi-language:EN-US'> </span>пример<span lang=EN-US
style='mso-ansi-language:EN-US'>: <br>
<br>
CREATE PROCEDURE Simple_Select_SP <br>
RETURNS ( <br>
procID INTEGER,&nbsp; <br>
procNAME VARCHAR(80))&nbsp; <br>
AS <br>
BEGIN&nbsp; <br>
FOR <br>
SELECT ID, NAME FROM table_example&nbsp; <br>
INTO :procID, :procNAME&nbsp; <br>
DO&nbsp; <br>
BEGIN <br>
SUSPEND;&nbsp; <br>
END&nbsp; <br>
END <br>
<br>
</span>Давайте<span style='mso-ansi-language:EN-US'> </span>разберем<span
style='mso-ansi-language:EN-US'> </span>действия<span style='mso-ansi-language:
EN-US'> </span>этой<span style='mso-ansi-language:EN-US'> </span>процедуры<span
lang=EN-US style='mso-ansi-language:EN-US'>, </span>названной<span lang=EN-US
style='mso-ansi-language:EN-US'> Simple_Select_SP. </span>Как видите, она не
имеет входных параметров и имеет два выходных параметра - ID и NAME. Самое
интересное, конечно, заключено в теле процедуры. Здесь использована конструкция
FOR SELECT: <br>
<br>
FOR <br>
SELECT ID, NAME FROM table_example&nbsp; <br>
INTO :procID, :procNAME&nbsp; <br>
DO&nbsp; <br>
BEGIN <br>
<br>
/*что-то делаем с переменными procID и procName*/&nbsp; <br>
<br>
END <br>
<br>
Этот кусочек кода означает следующее: для каждой строки, выбранной из таблицы
Table_example, поместить выбранные значения в переменные procID и procName, а
затем произвести какие-то действия с этими переменными. <br>
Вы можете сделать удивленное лицо и спросить: &quot;Переменные? Какие еще
переменные<sup>9</sup>&quot; Это нечто вроде сюрприза этой главы - то, что в
хранимых процедурах мы можем использовать переменные. В языке ХП можно
объявлять как собственные локальные переменные внутри процедуры, так и
использовать входные и выходные параметры в качестве переменных. <br>
Для того чтобы объявить локальную переменную в хранимой процедуре, необходимо
поместить ее описание после ключевого слова AS и до первого слова BEGIN
Описание локальной переменной выглядит так:&nbsp; <br>
<br>
DECLARE VARIABLE &lt;vanable_name&gt; &lt;variable_type&gt;; <br>
<br>
Например, чтобы объявить целочисленную локальную переменную Mylnt, нужно
вставить между AS и BEGIN следующее описание <br>
<br>
DECLARE VARIABLE Mylnt INTEGER; <br>
<br>
Переменные в нашем примере начинаются с двоеточия. Это сделано потому, что
обращение к ним идет внутри SQL-команды FOR SELECT, поэтому для различения
полей в таблицах, которые используются в SELECT, и переменных необходимо
предварять последние двоеточием. Ведь переменные могут иметь точно такое же
название, как и поля в таблицах! <br>
Но двоеточие перед именем переменной необходимо использовать только внутри
SQL-запросов. Вне текстов обращение к переменной делается без двоеточия,
например:&nbsp; <br>
<br>
procName='Some name'; <br>
<br>
Но вернемся к телу нашей процедуры. Предложение FOR SELECT возвращает данные не
в виде таблицы - набора данных, а по одной строчке. Каждое возвращаемое поле
должно быть помещено в свою переменную: ID =&gt; procID, NAME =&gt; procName. В
части DO эти переменные посылаются клиенту, вызвавшем) процед&gt;р&gt;, с
помощью команды SUSPEND <br>
Таким образом, команда FOR SELECT... DO организует цикл по записям, выбираемым
в части SELECT этой команды. В теле цикла, образуемого частью DO, выполняется
передача очередной сформированной записи клиенту с помощью команды SUSPEND. <br>
Итак, процедура-выборка предназначена для возвращения одной или более строк,
для чего внутри тела ХП организуется цикл, заполняющий результирующие
параметры-переменные. И в конце тела этого цикла обязательно стоит команда
SUSPEND, которая вернет очередную строку данных клиенту. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=58></a>Циклы и операторы ветвления<o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Помимо
команды FOR SELECT... DO, организующей цикл по записям какой-либо выборки,
существует другой вид цикла - WHILE...DO, который позволяет организовать цикл
на основе проверки любых условий. Вот пример ХП, использующей цикл WHILE.. DO.
Эта процедура возвращает квадраты целых чисел от 0 до 99: <br>
<br>
CREATE PROCEDJRE QUAD&nbsp; <br>
RETURNS (QUADRAT INTEGER)&nbsp; <br>
AS <br>
DECLARE VARIABLE I INTEGER;&nbsp; <br>
BEGIN&nbsp; <br>
I = 1; <br>
WHILE (i&lt;100) DO&nbsp; <br>
BEGIN <br>
QUADRAT= I*I; <br>
I=I+1;&nbsp; <br>
SUSPEND;&nbsp; <br>
END&nbsp; <br>
END <br>
<br>
В результате выполнения запроса SELECT • FROM QUAD мы получим таблицу,
содержащую один столбец QUADRAT, в котором будут квадраты целых чисел от 1 до
99 <br>
Помимо перебора результатов <a
href="http://click.begun.ru/kick.jsp?url=4vrJyO4IN6yl8owajJlbTYcOrjAz-IHj4AdGlO_VgmHX28xbFgygkBNEAG755SzGlcgHuAJdpFrTHs6cUio33QsSbxam4psxGuH8CiztieKlH1YUZd349dlC1GDHLNNji9wsdOf9yhLGkKbUaCQVcPUTdjeVG_tYXVij2OvQvzYADBuMwdt3R1PeFqD9b4s75rESSSfGcHhRSlBa-4YxKdxR_-8vxndJhq1S0N_z-Sbp7BJdm4XDBonh5MI2CUhR2R5hLNeYY-tb89nK4BiqJ8BoGDXJGTkPWpPqCh6j-yHZ1JflullvlNsCwryLjtFnMk2liCW0deCZ2KStBdtN1BYF6Sx88_ChKXK1IkT4buGpr1O4T5SX2B9Tsnf2thO0kALIuo3G_iCa8msua1IrRK_MUVfBERwWNSYOXPgq8gEg5nVMBhU8Bj-dNlEijrQmwBFLgDy7cd-SwktthTuDevahx3hI7_bGev3atqK-nR_mj9XfCYvbAqDE9GRTZEOB4qe13GGUOAg3eL1EXbZCtJlHaiLua7pEDsWim9THqMT6q7-enmTynENqCW8jq9-M"
target="_blank"><span style='text-decoration:none;text-underline:none'>SQL</span></a>-выборки
и классического цикла, в языке хранимых процедур используется оператор
IF...THEN..ELSE, позволяющий организовать ветвление в зависимости от выполнения
каких-либо словий Его синтаксис похож на большинство операторов ветвления в
языках программирования высокого уровня, вроде Паскаля и Си. <br>
Давайте рассмотрим более сложный пример хранимой процедуры, которая делает
следующее. <o:p></o:p></p>

<p class=MsoNormal align=left style='margin-left:0cm;text-align:left;
text-indent:35.45pt;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><![if !supportLists]><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Вычисляет среднюю цену в таблице Table_example (см.
глава &quot;Таблицы Первичные ключи и генераторы&quot;) <o:p></o:p></p>

<p class=MsoNormal align=left style='margin-left:0cm;text-align:left;
text-indent:35.45pt;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><![if !supportLists]><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Далее для каждой записи в таблице делает след&gt;ющ)ю
проверку, если существующая цена (PRICE) больше средней цены, то устанавливает
цену, равную величине средней цены, плюс задаваемый фиксированный процент <o:p></o:p></p>

<p class=MsoNormal align=left style='margin-left:0cm;text-align:left;
text-indent:35.45pt;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><![if !supportLists]><span
style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Если существующая цена меньше или равна средней цене,
то устанавливает цену, равную прежней цене, плюс половина разницы между прежней
и средней ценой. <o:p></o:p></p>

<p class=MsoNormal align=left style='margin-left:0cm;text-align:left;
text-indent:35.45pt;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><![if !supportLists]><span
style='mso-list:Ignore'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Возвращает все измененные строки в таблице. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Для
начала определим имя ХП, а также входные и выходные параметры Все это
прописывается в заголовке хранимой процедуры <br>
<br>
CREATE PROCEDURE IncreasePrices ( <br>
Percent2lncrease DOUBLE PRECISION) <br>
RETURNS (ID INTEGER, NAME VARCHAR(SO), new_price DOUBLE <br>
PRECISION) AS <br>
<br>
Процедура будет называться IncreasePrices, у нее один входной параметр
Peiceni21nciease, имеющий тип DOUBLE PRECISION, и 3 выходных параметра - ID,
NAME и new_pnce. Обратите внимание, что первые два выходных параметра имеют
такие же имена, как и поля в таблице Table_example, с которой мы собираемся
работать Это допускается правилами языка хранимых процедур. <br>
Теперь мы должны объявить локальную переменную, которая будет использоваться
для хранения среднего значения Эго объявление будет выглядеть следующим
образом: <br>
<br>
DECLARE VARIABLE avg_price DOUBLE PRECISION; <br>
<br>
Теперь перейдем к телу хранимой процедуры Откроем тело ХП ключевым словом
BEGIN. <br>
Сначала нам необходимо выполнить первый шаг нашего алгоритма - вычислить
среднюю цену. Для этого мы воспользуемся запросом следующего вида: <br>
<br>
SELECT AVG(Price_l)&nbsp; <br>
FROM Table_Example&nbsp; <br>
INTO :avg_price,- <br>
<br>
Этот запрос использует агрегатную функцию AVG, которая возвращает среднее
значение поля PRICE_1 среди отобранных строк запроса - в нашем случае среднее
значение PRICE_1 по всей таблице Table_example. Возвращаемое запросом значение
помещается в переменную avg_price. Обратите внимание, что переменная avg_pnce
предваряется двоеточием -для того, чтобы отличить ее от полей, используемых в
запросе. <br>
Особенностью данного запроса является то, что он всегда возвращает строго
одну-единственную запись. Такие запросы называются singleton-запросами И только
такие выборки можно использовать в хранимых процедурах. Если запрос возвращает
более одной строки, то его необходимо оформить в виде конструкции FOR
SELECT...DO, которая организует цикл для обработки каждой возвращаемой строки <br>
Итак, мы получили среднее значение цены. Теперь необходимо пройтись по всей
таблице, сравнить значение цены в каждой записи со средней ценой и предпринять
соответствующие действия <br>
С начала opганизуем перебор каждой записи из таблицы Table_example <br>
<br>
FOR <br>
SELECT ID, NAME, PRICE_1&nbsp; <br>
FROM Table_Example&nbsp; <br>
INTO :ID, :NAME, :new_price&nbsp; <br>
DO <br>
BEGIN <br>
/*_здесь оОрсшатыьаем каждую запись*/&nbsp; <br>
END <br>
<br>
При выполнении этой конструкции из таблицы Table_example построчно будут
выниматься данные и значения полей в каждой строке будут присвоены переменным
ID, NAME и new_pnce. Вы, конечно, помните, что эти переменные объявлены как
выходные параметры, но беспокоиться, что выбранные данные будут возвращены как
результаты, не стоит: тот факт, что выходным параметрам что-либо присвоено, не
означает, что вызывающий ХП клиент немедленно получит эти значения! Передача
параметров осуществляется только при исполнении команды SUSPEND, а до этого мы
можем использовать выходные параметры в качестве обычных переменных - в нашем
примере мы именно так и делаем с параметром new_price. <br>
Итак, внутри тела цикла BEGIN.. .END мы можем обработать значения каждой
строки. Как вы помните, нам необходимо выяснить, как существующая цена
соотносится со средней, и предпринять соответствующие действия. Эту процедуру
сравнения мы реализуем с помощью оператора IF: <br>
<br>
IF (new_price &gt; avg_price) THEN /*если существующая цена больше средней
цены*/ <br>
BEGIN <br>
/*то установим новую цену, равную величине средней цены, плюс фиксированный
процент */ <br>
new_price = (avg_price + avg_price*(Percent2Increase/100));&nbsp; <br>
UPDATE Table_example&nbsp; <br>
SET PRICE_1 = :new_price&nbsp; <br>
WHERE ID = :ID;&nbsp; <br>
END&nbsp; <br>
ELSE&nbsp; <br>
BEGIN <br>
/* Если существующая цена меньше или равна средней цене, то установим цену,
равную прежней цене, плюс половина разницы между прежней и средней ценой */ <br>
new_price = (new_pnce + ( (avg_pnce new_price)/2) ) ;&nbsp; <br>
UPDATE Table_example&nbsp; <br>
SET PRICE_1 = :new_price&nbsp; <br>
WHERE ID = .ID;&nbsp; <br>
END <br>
<br>
Как видите, получилось достаточно большая конструкция IF, в которой трудно было
бы разобраться, если бы не комментарии, заключенные в символы /**/. <br>
Для того чтобы изменить цену в соответствии с вычисленной разницей, мы
воспользуемся оператором UPDATE, который позволяет модифицировать существующие
записи - одну или несколько. Для того чтобы однозначно указать, в какой записи
нужно изменять цену, мы используем в условии WHERE поле первичного ключа,
сравнивая его со значением переменной, в которой хранится значение ID для
текущей записи: ID=:ID. Обратите внимание, что переменная ID предваряется
двоеточием. <br>
После выполнения конструкции IF...THEN...ELSE в переменных ID, NAME и new_price
находятся данные, которые мы должны возвратить клиент, вызвавшему процедуру.
Для этого после IF необходимо вставить команду SUSPEND, которая перешлет данные
туда, откуда вызвали ХП На время пересылки действие процедуры будет
приостановлено, а когда от ХП потребуется новая запись, то она будет вновь
продолжена, - и так будет продолжаться до тех пор, пока FOR SELECT...DO не
переберет все записи своего запроса. <br>
Надо отметить, что помимо команды SUSPEND, которая только приостанавливает
действие хранимой процедуры, существует команда EXIT, которая прекращает
хранимую процедуру после передачи строки. Однако <a
href="http://click.begun.ru/kick.jsp?url=4vrJyEwHlR4XQD6oPivp_zW8HIKBSjNRUrX0Jl1nMNPNJvxdWD_TiCqjhSBtxOSO3YBP8EoV7BIoVnMFKiq2so2UllKwbHAMu5Wn7Ul_m2XHWmV43F2VR2vwZtJ1nmHROW6exlVPeKB0IhRm2panwkehxIUnqUnq7-oRalliDYRvbL2v0OPQuOqeZig_tWAQk82MuafeMkuHm5BEeMCPlmPuQFCQecj2ORLtb2BMRplWU63iJDp8uTZeW32JtvfuZqHek2gn3FTkTGZ1X6cVmH_Xp4p2poaw5SxVtaEcRJ5mayhaBebQK2S9fQM0MW7YjfIaN5oLyl-yqDnTggsQFtTHK-6-MTJj67B34IY6rCNrbZF6jVZVGh6rQKO3JN4-Li3dRgMeIH46x_Mkw4wEoh2Z3Vii78GsUs8AbxfmHFRw7-x9UQNZ8S4C2zwS48nN"
target="_blank"><span style='text-decoration:none;text-underline:none'>командой</span></a>
EXIT пользуются достаточно редко, поскольку она нужна в основном для того,
чтобы прервать цикл при достижении какого-либо условия <br>
При этом в случае, когда процедура вызывалась оператором SELECT и завершена по
EXIT, последняя извлеченная строка не будет возвращена. То есть, если вам нужно
прервать процедуру и все-таки &gt;получить эту строку, надо воспользоваться
последовательностью <br>
<br>
SUSPEND;&nbsp; <br>
EXIT; <br>
<br>
Основное назначение EXIT - получение singleton-наборов данных, возвращаемых
параметров путем вызова через EXECUTE PROCEDURE. В этом случае устанавливаются
значения выходных параметров, но из них не формируется набор данных SQL, и
выполнение процедуры завершается. <br>
Давайте запишем текст нашей хранимой процедуры полностью, чтобы иметь
возможность охватить ее логику одним взглядом: <br>
<br>
CREATE PROCEDURE IncreasePrices ( <br>
Percent2Increase DOUBLE PRECISION) <br>
RETURNS (ID INTEGER, NAME VARCHAR(80), <br>
new_price DOUBLE PRECISION) AS <br>
DECLARE VARIABLE avg_price DOUBLE PRECISION; <br>
BEGIN <br>
SELECT AVG(Price_l) <br>
FROM Table_Example <br>
INTO :avg_price; <br>
FOR <br>
SELECT ID, NAME, PRICE_1&nbsp; <br>
FROM Table_Example&nbsp; <br>
INTO :ID, :NAME, :new_price&nbsp; <br>
DO <br>
BEGIN <br>
/*здесь обрабатываем каждую запись*/ <br>
IF (new_pnce &gt; avg_price) THEN /*если существующая цена больше средней цены*/
<br>
BEGIN <br>
/*установим новую цену, равную величине средней цены, плюс фиксированный
процент */ <br>
new_price = (avg_price + avg_price*(Percent2lncrease/100));&nbsp; <br>
UPDATE Table_example&nbsp; <br>
SET PRICE_1 = :new_price&nbsp; <br>
WHERE ID = :ID;&nbsp; <br>
END&nbsp; <br>
ELSE&nbsp; <br>
BEGIN <br>
/* Если существующая цена меньше или равна средней цене, то устанавливает цену,
равную прежней цене, плюс половина разницы между прежней и средней ценой */ <br>
new_price = (new_price + ((avg_price - new_price)/2));&nbsp; <br>
UPDATE Table_example&nbsp; <br>
SET PRICE_1 = :new_price&nbsp; <br>
WHERE ID = :ID;&nbsp; <br>
END <br>
SUSPEND;&nbsp; <br>
END&nbsp; <br>
END <br>
<br>
Данный пример хранимой процедуры иллюстрирует применение основных конструкций
языка хранимых процедур и триггеров. Далее мы рассмотрим способы применения
хранимых процедур для решения некоторых часто возникающих задач. <o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><a
name=59></a>Рекурсивные хранимые процедуры<o:p></o:p></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Хранимые
процедуры InterBase могут быть рекурсивными. Это означает, что из хранимой
процедуры можно вызвать саму себя. Допускается до 1000 уровней вложенности
хранимых процедур, однако надо помнить о том, что свободные ресурсы на сервере
могут закончиться раньше, чем будет достигнута максимальная вложенность ХП. <br>
Одно из распространенных применений хранимых процедур - это обработка
древовидных структур, хранящихся в <a
href="http://click.begun.ru/kick.jsp?url=4vrJyNDFdBceSTehNyLg9jy1FYuIQzpYW7z9L1RuOdqUEXhn9OBFkZDMs2O9OcuB0o9A_0Ua4x0ni5wNSIXC-Ru18vULQ-SqaxkPSpwsFdfUD_OZDlI_oEzqBEMqnxCxviHTGTqMmaWb7pjXUi_DgmAHC9PIuw25oD_VDVwLeial8ocywbjHvcdKzKM3NmxzgpX3eUuTFyy0vifFt8PJFlQLJOXyGxz-KuQXaNd6Fx8ZE9MWzPg9Z0sOPBW4aW5cLB_Lkdv_bz10XM94GGF4HlHnehlA0ievc-1ekx2hyxdnUvmO875xdl_1yX4kb-ipTI-Ejmf114BCRdqG0hf67Lpro2mMBnanz4jOM948VA5Emw5cBuqr1DBQSmc-_COD79PCDXVy0U0ituM2XwzgAA"
target="_blank"><span style='text-decoration:none;text-underline:none'>базе</span></a>
данных. Деревья часто используются в задачах состава изделия, складских,
кадровых и в других распространенных приложениях. <br>
Давайте рассмотрим пример хранимой процедуры, которая выбирает все товары
определенного типа, начиная с определенного уровня вложенности. <br>
Пусть у нас есть следующая постановка задачи: имеем справочник товаров с
иерархической структурой такого вида: <br>
<br>
-Товары <br>
- Бытовая техника&nbsp; <br>
-&nbsp;&nbsp; Холодильники <br>
&nbsp;&nbsp;&nbsp; - Трехкамерные&nbsp; <br>
&nbsp;&nbsp;&nbsp; - Двухкамерные&nbsp; <br>
&nbsp;&nbsp;&nbsp; - Однокамерные <br>
-&nbsp;&nbsp; Стиральные машины <br>
&nbsp;&nbsp;&nbsp; - Вертикальные <br>
&nbsp;&nbsp;&nbsp; - Фронтальные <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Классические <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Узкие <br>
-&nbsp;&nbsp; Компьютерная техника <br>
.... <br>
<br>
Эта структура справочника категорий товаров может иметь ветки различной
глубины. а также нарастать со временем. Наша задача - обеспечить выборку всех
конечных элементов из справочника с &quot;разворачивание полного имени&quot;,
начиная с любого узла. Например, если мы выбираем узел &quot;Стиральные
машины&quot;, то нам надо получить следующие категории: <br>
<br>
Стиральные машины - Вертикальные <br>
Стиральные машины - Фронтальные Классические <br>
Стиральные машины - Фронтальные Узкие <br>
<br>
Определим структуру таблиц для хранения информации справочника товаров.
Используем упрощенную схему для организации дерева в одной таблице: <br>
<br>
CREATE TABLE GoodsTree&nbsp; <br>
(ID_GOOD INTEGER NOT NULL, <br>
ID_PARENT_GOOD INTEGER, <br>
GOOD_NAME VARCHAR(80), <br>
constraint pkGooci primary key (ID_GOOD) ); <br>
<br>
Создаем одну таблицу GoodsTree, в которой всего 3 поля: ID_GOOD - умн кальный
идентификатор категории, ID_PARENT_GOOD - идентификатор кшс гории-родителя для
данной категории и GOOD_NAME - наименование катсш- рии. Чтобы обеспечить
целостность данных в этой таблице, наложим на эту таблиц} ограничение внешнего
ключа:&nbsp; <br>
<br>
ALTER TABLE GoodsTree&nbsp; <br>
ADD CONSTRAINT FK_goodstree&nbsp; <br>
FOREIGN KEY (ID_PARENT_GOOD)&nbsp; <br>
REFERENCES GOODSTPEE (ID__GOOD) <br>
<br>
Таблица ссылается сама на себя и данный внешний ключ следит за тем. чтобы в
таблице не было ссылок на несуществующих родителей, а также препятствует
попыткам удалить категории товаров, у которых есть потомки. <br>
Давайте занесем в нашу таблицу следующие данные: <o:p></o:p></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='mso-cellspacing:0cm;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>ID_GOOD&nbsp;
  <br>
  <br>
  &nbsp;&nbsp; 1&nbsp; <br>
  &nbsp;&nbsp; 2&nbsp; <br>
  &nbsp;&nbsp; 3&nbsp; <br>
  &nbsp;&nbsp; 4&nbsp; <br>
  &nbsp;&nbsp; 5&nbsp; <br>
  &nbsp;&nbsp; 6&nbsp; <br>
  &nbsp;&nbsp; 7&nbsp; <br>
  &nbsp;&nbsp; 8&nbsp; <br>
  &nbsp;&nbsp; 9&nbsp; <br>
  &nbsp;&nbsp; 10&nbsp; <br>
  &nbsp;&nbsp; 11&nbsp; <br>
  &nbsp;&nbsp; 12 <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>&nbsp;ID_PARENT_GOOD&nbsp;
  <br>
  <br>
  &nbsp;&nbsp; 0&nbsp; <br>
  &nbsp;&nbsp; 1&nbsp; <br>
  &nbsp;&nbsp; 1&nbsp; <br>
  &nbsp;&nbsp; 2&nbsp; <br>
  &nbsp;&nbsp; 2&nbsp; <br>
  &nbsp;&nbsp; 4&nbsp; <br>
  &nbsp;&nbsp; 4&nbsp; <br>
  &nbsp;&nbsp; 4&nbsp; <br>
  &nbsp;&nbsp; 5&nbsp; <br>
  &nbsp;&nbsp; 5&nbsp; <br>
  &nbsp;&nbsp; 10&nbsp; <br>
  &nbsp;&nbsp; 10 <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>&nbsp;GOOD_NAME&nbsp;
  <br>
  <br>
  &nbsp;&nbsp;GOODS <br>
  &nbsp;&nbsp;Бытовая техника&nbsp; <br>
  &nbsp;&nbsp;Компьютеры и комплектующие <br>
  &nbsp;&nbsp;Холодильники&nbsp; <br>
  &nbsp;&nbsp;Стиральные машины <br>
  &nbsp;&nbsp;Трехкамерные&nbsp; <br>
  &nbsp;&nbsp;Двухкамерные&nbsp; <br>
  &nbsp;&nbsp;Однокамерные&nbsp; <br>
  &nbsp;&nbsp;Вертикальные&nbsp; <br>
  &nbsp;&nbsp;Фронтальные&nbsp; <br>
  &nbsp;&nbsp;Узкие&nbsp; <br>
  &nbsp;&nbsp;Классические <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'><o:p>&nbsp;</o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Теперь,
когда у нас есть место для хранения данных, мы можем приступить к созданию
хранимой процедуры, выполняющей вывод всех &quot;окончательных&quot; категорий
товаров в &quot;развернутом&quot; виде - например, для категории
&quot;Трехкамерные&quot; полное имя категории будет выглядеть как &quot;Бытовая
техника Холодильники Трехкамерные&quot;. <br>
В хранимых процедурах, обрабатывающих древообразные структуры, сложилась своя
терминология. Каждый элемент дерева называются узлом; а отношения между
ссылающимися друг на друга узлами называется отношениями родитель-потомок.
Узлы, находящиеся на самом конце дерева и не имеющие потомков, называются
&quot;листьями&quot;. <br>
У кашей хранимой процедуры входным параметром будет идентификатор категории,
начиная с которого мы должны будем начать развертку. Хранимая процедура будет
иметь следующий вид: <br>
<br>
CREATE PROCEDURE GETFULLNAME (ID_GOOD2SHOW INTEGER)&nbsp; <br>
RETURNS (FULL_GOODS_NAME VARCHAR(1000),&nbsp; <br>
ID_CHILD_GOOD INTEGER)&nbsp; <br>
AS <br>
DECLARE VARIABLE CURR_CHILD_NAME VARCHAR(80); <br>
BEGIN <br>
/*0рганизуем внешний цикл FOR SELECT по непосредственным потомкам товара с
ID_GOOD=ID_GOOD2SHOW */&nbsp; <br>
FOR SELECT gtl.id_good, gtl.good_name&nbsp; <br>
FROM GoodsTree gtl <br>
WHERE gtl.id_parent_good=:ID_good2show&nbsp; <br>
INTO:ID_CHILD_GOOD, :full_goods_name&nbsp; <br>
DO <br>
BEGIN <br>
/&quot;Проверка с помощью функции EXISTS, которая возвращает TRUE, если запрос
в скобках вернет хотя бы одну строку. Если у найденного узла с ID_PARENT_GOOD =
ID_CHILD_GOOD нет потомков, то он является &quot;листом&quot; дерева и попадает
в результаты */&nbsp; <br>
IF (NOT EXISTS( <br>
SELECT * FROM GoodsTree <br>
WHERE GoodsTree.id_parent_good=:id_child_good))&nbsp; <br>
THEN&nbsp; <br>
BEGIN&nbsp; <br>
/* Передаем &quot;лист&quot; дерева в результаты */ <br>
SUSPEND;&nbsp; <br>
END <br>
ELSE&nbsp; <br>
/* Для узлов, у которых есть потомки*/ <br>
BEGIN&nbsp; <br>
/*сохраняем имя узла-родителя во временной переменной */ <br>
CURR_CHILD_NAME=full_goods_name;&nbsp; <br>
/* рекурсивно запускаем эту процедуру */&nbsp; <br>
FOR <br>
SELECT ID_CHILD_GOOD, full_goods_name&nbsp; <br>
FROM GETFULLNAME (:ID_CHILD_GOOD)&nbsp; <br>
INTO:ID_CHILD_GOOD, :full_goods_name&nbsp; <br>
DO BEGIN <br>
/*добавляем лмя узла-родителя к найденном., имени потомка с помощью операции
конкатенации строк || */ <br>
full_goods_name=CURR_CHILD_NAME| ' ' | f ull_goods_name,- <br>
SUSPEND; /* возвращаем полное имя товара*/&nbsp; <br>
END&nbsp; <br>
END&nbsp; <br>
END&nbsp; <br>
END <br>
<br>
Если мы выполним данную процедуру с входным параметром ID_GOOD2SHOW= 1, то
получим следующее: <o:p></o:p></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='mso-cellspacing:0cm;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>FULL_GOODS__NAME
  <br>
  <br>
  Бытовая техника Холодильники Трехкамерные&nbsp; <br>
  Бытовая техника Холодильники Двухкамерные&nbsp; <br>
  Бытовая техника Холодильники Однокамерные&nbsp; <br>
  Бытовая техника Стиральные машины Вертикальные&nbsp; <br>
  Бытовая техника Стиральные машины Фронтальные Узкие <br>
  Бытовая техника Стиральные машины Фронтальные Классические <br>
  Компьютеры и комплектующие <o:p></o:p></p>
  </td>
  <td valign=top style='padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>ID_CHILD_GOOD
  <br>
  <br>
  &nbsp;&nbsp;6 <br>
  &nbsp;&nbsp;7 <br>
  &nbsp;&nbsp;8 <br>
  &nbsp;&nbsp;9 <br>
  &nbsp;&nbsp;11 <br>
  &nbsp;&nbsp;12 <br>
  &nbsp;&nbsp;3 <o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-indent:35.45pt'>Как
видите, с помощью рекурсивной хранимой процедуры мы прошлись по всему дереву
категорий и вывели полное наименование категорий-&quot;листьев&quot;, которые
находятся на самых кончиках ветвей. <o:p></o:p></p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><a name=60></a>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h1><a name="_Toc65225696"></a><a name="_Toc163231771"></a><a
name="_Toc126429378"></a><a name="_Toc126429233"></a><a name="_Toc98581998"></a><a
name="_Toc96184876"></a><a name="_Toc96190885"></a><a name="_Toc96190826"></a><span
style='mso-bookmark:_Toc65225696'>7.</span><span style='mso-bookmark:_Toc65225696'><span
style='font-size:7.0pt'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Библиографи</span>ЧЕСКИЙ
СПИСОК</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>1. http://www.realcoding.net/article/view/293 </p>

<p class=MsoNormal>2. Богачев К.Ю. Основы параллельного программирования / К.Ю.
Богачев – М.:Бином, 2001. – 336 с.</p>

<p class=MsoNormal>3. Сухарев М.В. Основы <span lang=EN-US style='mso-ansi-language:
EN-US'>Delphi</span>. Профессиональный подход / М.В. Сухарев. – М.:Наука и
техника, 2004. – 623 с.</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h1 style='text-align:justify'><a name="_Toc505936318"></a><a
name="_Toc163231772"></a><span style='mso-bookmark:_Toc505936318'>ПРИЛОЖЕНИЕ </span>Варианты
заданий</h1>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 1.
Информация о публикациях по ряду выбранных тем.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=403 height=183 id="_x0000_i1056" src="musubd.files/image031.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 2.
Внутренняя система&nbsp; обучения&nbsp; в&nbsp; большой&nbsp; промышленной
компании.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=394 height=193 id="_x0000_i1057" src="musubd.files/image032.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 3.
Информация о пациентах клиники.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=394 height=208 id="_x0000_i1058" src="musubd.files/image033.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 4.
Анкетные данные служащих конторы.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=322 height=197 id="_x0000_i1059" src="musubd.files/image034.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 5.
Информация о торговых фирмах.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=389 height=162 id="_x0000_i1060" src="musubd.files/image035.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 6.
Каталог работ.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=391 height=190 id="_x0000_i1061" src="musubd.files/image036.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 7.
Информация о служащих.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=392 height=256 id="_x0000_i1062" src="musubd.files/image037.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 8.
Деканат</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=382 height=177 id="_x0000_i1063" src="musubd.files/image038.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 9.
&nbsp;Учебные заведения, абитуриенты и экзамены</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=393 height=151 id="_x0000_i1064" src="musubd.files/image039.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 10.
Расписание поездов.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=376 height=219 id="_x0000_i1065" src="musubd.files/image040.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 11.
Результататы экзаменов по каждой кафедре:</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=377 height=141 id="_x0000_i1066" src="musubd.files/image041.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 12.
Картотека осужденных лиц:</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=420 height=193
id="_x0000_i1067" src="musubd.files/image042.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 13.
Футбольные клубы</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=422 height=214
id="_x0000_i1068" src="musubd.files/image043.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 14.
Информация о концертах</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=423 height=204
id="_x0000_i1069" src="musubd.files/image044.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 15.
Картотека фирм</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=421 height=179
id="_x0000_i1070" src="musubd.files/image045.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 16.
Информация о грузовых перевозках, осуществляемых различными&nbsp; фирмами.</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='text-indent:0cm'><img border=0 width=419 height=241
id="_x0000_i1071" src="musubd.files/image046.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 17.
Бронирование мест в гостинице для командированных </p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt'><img
border=0 width=420 height=250 id="_x0000_i1072" src="musubd.files/image047.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 18.
Лечение различных заболеваний:</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt'><img
border=0 width=421 height=192 id="_x0000_i1073" src="musubd.files/image048.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 19.
Вычислительные центры города</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt'><img
border=0 width=422 height=317 id="_x0000_i1074" src="musubd.files/image049.jpg"></p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>Вариант 20.
Политические партии</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'><img border=0
width=394 height=182 id="_x0000_i1075" src="musubd.files/image050.jpg"></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:0cm'>&nbsp;</p>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:RU;mso-fareast-language:RU;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Заказ
№&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
от&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Тираж&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
экз.</p>

<p class=MsoNormal align=center style='text-align:center'>Изд-во СевНТУ</p>

<div id=masthead>

<p class=MsoNormal align=center style='text-align:center;text-indent:0cm'><span
style='font-size:12.0pt'><img border=0 width=900 height=115 id="_x0000_i1076"
src=title.gif><o:p></o:p></span></p>

<h1 id=siteName>&nbsp;</h1>

<h1><span class=style4><a href="index.htm">О себе </a>| <a href="os_site.htm">Операционные
системы </a>| <a href="pevm.htm">Персональные ЭВМ </a>| <a href="spo.htm">Системное
программное обеспечение</a>| <a href="pp.htm">Параллельное программирование</a>|
<a href="subd.htm">СУБД</a></span> <!-- end masthead --></h1>

</div>

</div>

</body>

</html>
